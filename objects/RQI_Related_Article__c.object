<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionOverrides>
        <actionName>Accept</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Accept</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Accept</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>CancelEdit</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>CancelEdit</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>CancelEdit</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Clone</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Clone</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Clone</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Delete</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Delete</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Delete</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Edit</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Edit</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Edit</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>List</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>List</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>List</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>New</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>New</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>New</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>SaveEdit</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>SaveEdit</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>SaveEdit</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Tab</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Tab</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Tab</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>View</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>View</actionName>
        <formFactor>Large</formFactor>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>View</actionName>
        <formFactor>Small</formFactor>
        <type>Default</type>
    </actionOverrides>
    <allowInChatterGroups>false</allowInChatterGroups>
    <compactLayoutAssignment>SYSTEM</compactLayoutAssignment>
    <deploymentStatus>Deployed</deploymentStatus>
    <enableActivities>false</enableActivities>
    <enableBulkApi>true</enableBulkApi>
    <enableFeeds>false</enableFeeds>
    <enableHistory>false</enableHistory>
    <enableLicensing>false</enableLicensing>
    <enableReports>false</enableReports>
    <enableSearch>true</enableSearch>
    <enableSharing>true</enableSharing>
    <enableStreamingApi>true</enableStreamingApi>
    <externalSharingModel>ControlledByParent</externalSharingModel>
    <fields>
        <fullName>Article_ID__c</fullName>
        <externalId>false</externalId>
        <label>Article ID</label>
        <length>255</length>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Article_Link__c</fullName>
        <externalId>false</externalId>
        <formula>HYPERLINK(&quot;/&quot; + Article_ID__c , Article_Title__c )</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Article Link</label>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Article_Title__c</fullName>
        <externalId>false</externalId>
        <label>Article Title</label>
        <length>255</length>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Article_Type__c</fullName>
        <externalId>false</externalId>
        <label>Article Type</label>
        <length>255</length>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>RQI_Audit__c</fullName>
        <externalId>false</externalId>
        <label>RQI Audit</label>
        <referenceTo>RQI_Audit__c</referenceTo>
        <relationshipLabel>RQI Related Articles</relationshipLabel>
        <relationshipName>RQI_Related_Articles</relationshipName>
        <relationshipOrder>0</relationshipOrder>
        <reparentableMasterDetail>false</reparentableMasterDetail>
        <trackTrending>false</trackTrending>
        <type>MasterDetail</type>
        <writeRequiresMasterRead>false</writeRequiresMasterRead>
    </fields>
    <label>RQI Related Article</label>
    <nameField>
        <displayFormat>RRA-{0000}</displayFormat>
        <label>RQI Related Articles Name</label>
        <type>AutoNumber</type>
    </nameField>
    <pluralLabel>RQI Related Articles</pluralLabel>
    <searchLayouts/>
    <sharingModel>ControlledByParent</sharingModel>
    <visibility>Public</visibility>
    <webLinks>
        <fullName>Create_AQIs</fullName>
        <availability>online</availability>
        <displayType>massActionButton</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Create AQIs</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <requireRowSelection>true</requireRowSelection>
        <url>{!REQUIRESCRIPT(&apos;/soap/ajax/20.0/connection.js&apos;)}
				
var records = {!GETRECORDIDS($ObjectType.RQI_Related_Article__c)};

var caseId = &apos;{! RQI_Audit__c.Id}&apos;;

var audits = [];
			
if (records[0] == null) {
	alert(&apos;Please select at least one row&apos;);
} else {
   for (var n=0; n&lt;records.length; n++) {

      var theRecords = sforce.connection.query(&apos;SELECT Id,Article_ID__c,Article_Title__c FROM  RQI_Related_Article__c where id = \&apos;&apos;+records[n]+&apos;\&apos;&apos;);

      var theRQIRecords = sforce.connection.query(&apos;SELECT Author__c FROM  RQI_Audit__c where id = \&apos;{! RQI_Audit__c.Id}\&apos;&apos;);
      
     var thecurrentRecord = theRecords.getArray(&apos;records&apos;);					
     var theRQICurrentRecord = theRQIRecords.getArray(&apos;records&apos;);	
						
      var theArticleId = thecurrentRecord[0].get(&apos;Article_ID__c&apos;);
      var theArticleTitle = thecurrentRecord[0].get(&apos;Article_Title__c&apos;);
      var theAuthorId = theRQICurrentRecord[0].get(&apos;Author__c&apos;);

      var theAlreadyExistingRecords = sforce.connection.query(&apos;SELECT Id FROM     AQI_Audit__c where Article_ID__c = \&apos;&apos;+theArticleId+&apos;\&apos;&apos;);
    
     var theAlreadyExistingRecordsvalues = theAlreadyExistingRecords.getArray(&apos;records&apos;);
   
    if(theAlreadyExistingRecordsvalues.length &gt; 0){
      alert(&apos;AQI for &apos; + theArticleTitle  + &apos; already exist&apos;);
      continue;
    }

      var AQIAudit = new sforce.SObject(&apos;AQI_Audit__c&apos;);
      AQIAudit.set(&apos;OwnerId&apos;, &apos;{!$User.Id}&apos;);
      AQIAudit.set(&apos;Author__c&apos;,theAuthorId);
      AQIAudit.set(&apos;Status__c&apos;, &apos;New&apos;);
      AQIAudit.set(&apos;Article_Title__c&apos;,  theArticleTitle);
      AQIAudit.set(&apos;Article_ID__c&apos;, theArticleId);

      var result = sforce.connection.create([AQIAudit]);
      if (result != null) {
        
       if (result[0].getBoolean(&apos;success&apos;)) {
       		window.open(result[0].id);
          
       }else{
            alert(&apos;fail&apos; + result[0].errors.message);
       }
     }
   }
}</url>
    </webLinks>
</CustomObject>
