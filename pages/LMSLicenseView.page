<apex:page controller="LMSLicenseViewController" tabStyle="Activation_File_Management__tab" sidebar="false">
    <apex:sectionHeader title="License Management" subtitle="View License"/>
    <apex:form >
        <apex:outputText rendered="{!(licenseRequest.Active__c == false)}">
            <p align="center" style="font-size:20px;color:red"> 
                This license has been deactivated or has expired. You cannot download the license file. 
            </p>
        </apex:outputText>
        <apex:outputText rendered="{!(licenseRequest.Active__c == true)}">
            <p align="right">
                <a href="{!urlPrefix}/apex/LMSLicenseDownload?id={!licenseRequest.Id}"><apex:image url="{!URLFOR($Resource.LMSIcons, 'images/DownloadLicense.png')}" height="20" title="Download License"/></a>            
                <a href="{!urlPrefix}/apex/LMSLicenseDownload?id={!licenseRequest.Id}">Download License</a> 
            </p>
        </apex:outputText>
        <apex:pageBlock >
            <apex:pageBlockSection columns="1">
                <apex:outputPanel >
                    <TABLE WIDTH="100%">
                        <TR>
                            <th class="labelCol vfLabelColTextWrap first">Product</th>
                            <td class="data2Col">
                                {!licenseRequest.Product_Type__c}
                            </td>
                        </TR>
                    </TABLE>
                    <TABLE WIDTH="100%">
                        <TR>
                            <th class="labelCol vfLabelColTextWrap first">Generation Date</th>
                            <td class="data2Col">
                                <apex:outputText value="{0,date,MM/dd/yyyy}"> 
                                    <apex:param value="{!licenseRequest.Generation_Date__c}" /> 
                                </apex:outputText>
                            </td>
                        </TR>
                    </TABLE>
                    <TABLE WIDTH="100%">
                        <TR>
                            <th class="labelCol vfLabelColTextWrap first">Expiration Date</th>
                            <td class="data2Col">
                               <apex:outputText value="{0,date,MM/dd/yyyy}"> 
                                    <apex:param value="{!licenseRequest.Expiration_Date__c}" /> 
                                </apex:outputText>
                            </td>
                        </TR>
                    </TABLE>
                    <TABLE WIDTH="100%">
                        <TR>
                            <th class="labelCol vfLabelColTextWrap first">Generated By</th>
                            <td class="data2Col">
                                {!licenseRequest.Requested_By__r.Name}
                            </td>
                        </TR>
                    </TABLE>
                    <TABLE WIDTH="100%">
                        <TR>
                            <th class="labelCol vfLabelColTextWrap first">Company Name</th>
                            <td class="data2Col">
                                {!licenseRequest.End_User__r.Name}
                            </td>
                        </TR>
                    </TABLE>
                    <TABLE WIDTH="100%">
                        <TR>
                            <th class="labelCol vfLabelColTextWrap first">Site Name</th>
                            <td class="data2Col">
                                {!licenseRequest.Install_Site__r.Name}
                            </td>
                        </TR>
                    </TABLE>
                </apex:outputPanel>
            </apex:pageBlockSection>
        </apex:pageBlock>
        
            
        
        <apex:pageBlock title="Details">
            <apex:pageBlockSection columns="1" collapsible="false" showHeader="false">
                 <apex:outputPanel >
                     <TABLE WIDTH="100%">
                        <TR>
                            <th class="labelCol vfLabelColTextWrap first">Server Info</th>
                            <td class="data2Col">
                                <TABLE>
                                    <TR>
                                        <TH WIDTH="150px;">
                                            <apex:outputtext rendered="{!sipLicense == false}">
                                                Host Id
                                            </apex:outputtext>
                                            <apex:outputtext rendered="{!sipLicense == true && sipType=='Bulk Caller'}">
                                                MAC Address
                                            </apex:outputtext>
                                            <apex:outputtext rendered="{!sipLicense == true && sipType<>'Bulk Caller'}">
                                                Machine Id
                                            </apex:outputtext>
                                        </TH>
                                        <TH WIDTH="150px;">Machine Name</TH>
                                    </TR>
                                    <TR>
                                        <TD>
                                            <apex:repeat value="{!hostIds}" var="hi">
                                                {!hi} <br />
                                            </apex:repeat>
                                        </TD>
                                        <TD>
                                            <apex:repeat value="{!machineNames}" var="mn">
                                                {!mn} <br />
                                            </apex:repeat>
                                        </TD>
                                    </TR>
                                </TABLE>
                            </td>
                        </TR>
                    </TABLE>
                    <apex:outputtext rendered="{!sipLicense == false}">
                        <TABLE WIDTH="100%">
                            <TR>
                                <th class="labelCol vfLabelColTextWrap first">Machine Type</th>
                                <td class="data2Col">
                                    {!licenseRequest.SystemType1__c}
                                </td>
                            </TR>
                        </TABLE>
                        <TABLE WIDTH="100%">
                            <TR>
                                <th class="labelCol vfLabelColTextWrap first">Mail Connector</th>
                                <td class="data2Col">
                                    {!licenseRequest.MailConnector1__c}
                                </td>
                            </TR>
                        </TABLE>
                        <TABLE WIDTH="100%">
                            <TR>
                                <th class="labelCol vfLabelColTextWrap first">Expiration Date</th>
                                <td class="data2Col">
                                    <apex:outputText value="{0,date,MM/dd/yyyy}"> 
                                        <apex:param value="{!licenseRequest.Expiration_Date__c}" /> 
                                    </apex:outputText>
                                </td>
                            </TR>
                        </TABLE>
                    </apex:outputtext>
                    <TABLE WIDTH="100%">
                        <TR>
                            <th class="labelCol vfLabelColTextWrap first">Description</th>
                            <td class="data2Col">
                                {!description}
                            </td>
                        </TR>
                    </TABLE>
                    <apex:outputtext rendered="{!sipLicense == false}">
                        <TABLE WIDTH="100%">
                            <TR>
                                <th class="labelCol vfLabelColTextWrap first">Bundle</th>
                                <td class="data2Col">
                                    {!bundle}
                                </td>
                            </TR>
                        </TABLE>
                     </apex:outputtext>
                </apex:outputPanel>
            </apex:pageBlockSection>
            <apex:pageBlockSection columns="1" collapsible="true" title="Features">
                <apex:pageBlockTable value="{!features}" var="f">
                    <apex:column value="{!f}" headerValue="Feature"/>   
                </apex:pageBlockTable>
            </apex:pageBlockSection>
            <apex:pageBlockSection columns="1" collapsible="true" title="Licenses">
                <apex:pageBlockTable value="{!licenses}" var="l">
                    <apex:column value="{!l}" headerValue="License"/>   
                </apex:pageBlockTable>
            </apex:pageBlockSection>
            <apex:pageBlockSection columns="1" collapsible="true" title="Ordered Items Used">
                <apex:pageBlockTable value="{!products}" var="p">
                    <apex:column value="{!p}" headerValue="Ordered Item"/>  
                </apex:pageBlockTable>
            </apex:pageBlockSection>
        </apex:pageBlock>
    </apex:form>
</apex:page>