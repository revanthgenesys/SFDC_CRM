<apex:page id="pg" title="Quote : {!quote.Name}" controller="CreateQuoteSubscriptionController" tabStyle="BigMachines__Quote__c" sidebar="false" action="{!cloneQuoteOnLoad}"  docType="html-5.0">
    <apex:stylesheet value="{!$Resource.QuotingToolStyles}"/>
    <apex:form id="form">       
        <apex:actionFunction name="saveBeforeReload" action="{!saveBeforeReload}"/>
        <apex:actionFunction name="convertToRealQuote" action="{!convertToRealQuote}" reRender="form" status="status"/>
        <apex:actionFunction name="synchAndGoToDQAF" action="{!synchAndGoToDQ}" reRender="pnlDQJS" onComplete="goToDQ(); return false;" status="status"/>
        <apex:actionFunction name="synchAndGoAndReviseDQAF" action="{!synchAndGoToDQ}" reRender="pnlDQJS" onComplete="goToDQAndRevise(); return false;" status="status"/>
        <apex:actionFunction name="getDQStatusAF" action="{!getDQStatus}" reRender="pnlDQJS" onComplete="confirmDQRevise(); return false;" status="status"/>
        <apex:actionFunction name="refreshSubscriptionSectionJS" action="{!refresh}" reRender="pgblkSecSubscriptionInfo" status="status"/>
              
        <apex:inputText style="position:absolute;top:-1000px;"/>
        <table cellpadding="0" cellspacing="0" width="100%;">
            <td width="20%">
                <apex:sectionHeader title="{!IF(blnIsSimulated,'Estimation','Quote Edit')}" subtitle="{!quote.Name}"/>      
            </td>
            <td width="80%">            
            </td>
        </table>
        
        <!--<c:QuoteTabPanel quote.Id="{!quote.id}" selectedTab="Quote Details" showHeader="false" typeOfQuote="On Premise"/>-->
        
        <apex:outputPanel >
            <apex:commandButton value="Save" action="{!doCalculations}" />&nbsp;
        </apex:outputPanel>
    
        <apex:outputPanel >
            <apex:commandButton value="Return to Opportunity" onclick="location.href='/{!quote.BigMachines__Opportunity__c}'; return false;"/>&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!NOT(blnIsSimulated) && (NOT(IsQuoteUnLocked) || quote.BigMachines__Status__c == 'Quote Rejected') 
            && quote.BigMachines__Status__c != 'Order Accepted' && quote.BigMachines__Status__c != 'Order Submitted'}">
            <apex:commandButton value="Revise" action="{!reviseMajorBtnHandler}" status="status" reRender="quoteInfo"/>&nbsp;
        </apex:outputPanel>
     
        <apex:outputPanel rendered="{!NOT(blnIsSimulated) && quote.BigMachines__Status__c != 'Order Accepted'}">
            <apex:commandButton value="Clone" action="{!cloneBtnHandler}" status="status" reRender="quoteInfo"/>&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!IsQuoteUnLocked && NOT(blnIsSimulated)}">
            <apex:commandButton value="Submit Quote" action="{!finalizeQuote}"/>&nbsp;
        </apex:outputPanel>

        <apex:outputPanel rendered="{!quote.BigMachines__Status__c = 'Quote Approved' || (quote.BigMachines__Status__c = 'Order Rejected' && blnIsReviseOrder)}">
            <apex:commandButton value="Submit Order" action="{!submitOrderBtnHandler}" />&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!quote.BigMachines__Status__c = 'Order Rejected' && NOT(blnIsReviseOrder)}">
            <apex:commandButton value="Revise Order" action="{!reviseOrderBtnHandler}"/>&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!IsQuoteUnLocked}">
            <apex:commandButton value="Product Configuration" onclick="window.open('/apex/ConfigurationSubscription?id={!quote.Id}','Product Configuration', 'fullscreen=yes,resizable=yes,scrollbars=yes,width=1000,height=500');"/>&nbsp;
        </apex:outputPanel>

        <!-- PureBridge -->
        <apex:outputPanel rendered="{!lever1}" id="psbtn">
            <apex:commandButton value="Prof. Service DSR " onclick="window.open('/apex/PSDealSupportQuery?supportarea=Professional+Services&isPSSMART=yes&type=Budgetary+Estimate+%28BE%29');return false;"/>&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!NOT(CONTAINS($Label.On_Premise_Tool_Profiles,$Profile.Name)) || $Profile.Name = 'GEN - Finance' || $Profile.Name = 'Regional Sales Ops' || IF(CONTAINS($Label.Quote_Export_to_Excel,$User.Alias), True, False)}">
            <apex:outputLink title="Export To Excel" value="/apex/ExportToExcelOnPremise?id={!quote.id}" target="_blank">
                <apex:image url="{!$Resource.ExcelIcon}" width="25px" height="22px"/>    
            </apex:outputLink>
        </apex:outputPanel>
        <apex:outputPanel >
            <apex:outputLink title="Export To PDF" value="/apex/ExportToPDFOnPremise?id={!quote.id}" target="_blank">
                <apex:image url="{!$Resource.pdf_icon}" width="25px" height="22px"/>    
            </apex:outputLink>
        </apex:outputPanel>
        <apex:outputPanel rendered="{!blnIsDSPilotUser}">
            <apex:outputLink title="Export To Excel" value="/apex/CreateQuoteExcel?id={!quote.id}" target="_blank">                
                Download file for Deal Score
            </apex:outputLink>             
        </apex:outputPanel>
        <br/><br/>
        <apex:pageMessages id="msgs" escape="false"/>
        <apex:outputPanel rendered="{!blnHasViolations && list_Violations != null}">
            <div style="background-color:#c00;padding-left:5px;">
            <apex:pageBlock title="Deal Qualification Validation" >
                <apex:pageBlockButtons id="buttons" location="top">
                    <apex:commandButton value="Go To Deal Qualification" onclick="getDQStatusAF(); return false;" />
                    Click on this button to go to/revise your Deal Qualification criteria on your Opportunity.
                </apex:pageBlockButtons>
                <b>
                <apex:outputLabel value="This is to highlight the differences between the Quote and the Approved Criteria." />
                </b>
                <br/>
                <apex:pageBlockTable value="{!list_Violations}" var="eachViolation">
                    <apex:column headerValue="Difference Type">
                        {!eachViolation.approvalName}
                    </apex:column>
                    <apex:column headerValue="Value On Quote">
                        {!eachViolation.fieldValueOnQuote}
                    </apex:column>
                    <apex:column headerValue="Approved limits in Deal Qualification">
                        {!eachViolation.fieldValueApproved}
                    </apex:column>
                    <apex:column headerValue="Description" >
                        {!eachViolation.Description}
                    </apex:column>          
                </apex:pageBlockTable>
            </apex:pageBlock>
            </div>
        </apex:outputPanel>
        <apex:pageMessage severity="ERROR" strength="1" rendered="{!blnShowExportScreeningMsg}">
            Please complete Export Screening Check-list for the End User Account.&nbsp;
            <input type="button" class="btn" value="Export Screening Checklist" 
                onclick="alert('Please re-submit the order once the check-list is saved.');window.open('/apex/Compliance_new_edit_redirect?retURL=/{!quote.End_User_ID__c}');"/> 
        </apex:pageMessage>
        <apex:pageMessage severity="ERROR" strength="1" rendered="{!blnShowExportScreeningExpireMsg}">
            Please extend the expiration date of Export Screening Check-list for the End User Account.&nbsp;
            <input type="button" class="btn" value="Export Screening Checklist" 
                onclick="alert('Please re-submit the order once the check-list is saved.');window.open('../{!escid}');"/> 
        </apex:pageMessage>
        <div id="profileTabSetContainer" class="profileTabSetContainer zen" style="display: block;">
            <div class="zen-box zen-tabs zen-simpleTabs profileTabs" id="TabPanel">
                <div class="zen-inner">
                    <div id="profileTabSetHeader" class="zen-header profileTabSetHeader">
                        <ul id="profileTabSet" class="profileTabSet zen-tabControl" role="tablist">
                            <li class="{!IF(strSelectedTab=='Quote Details','zen-current','')}">
                                <apex:commandLink value="{!IF(blnIsSimulated,'Estimation Details','Quote Details')}" action="{!showQuoteDetails}" title="Quote Details" styleClass="profileTab"/>
                            </li>
     
                            <apex:outputPanel layout="none" rendered="{!NOT(blnIsSimulated)}">                            
                                <li class="{!IF(strSelectedTab=='Special Offers','zen-current','')}">
                                    <apex:commandLink value="Special Offers" action="{!showSpecialOffers}" title="Special Offers" styleClass="profileTab"/>
                                </li>                            
                            </apex:outputPanel>
                            <li>
                                <apex:commandLink value="Quote Output" action="{!showProposalOptions}" title="Quote Output" styleClass="profileTab"/>
                            </li>
                            
                            <apex:outputPanel layout="none">
                                <li class="{!IF(strSelectedTab=='Order Submission','zen-current','')}">
                                    <apex:commandLink value="Order Submission" action="{!showOrderSubmission}" title="Order Submission" styleClass="profileTab"/>
                                </li>
                                <li>
                                    <apex:commandLink value="History and Attachments" action="{!showHistoryAndAttachments}" title="History and Attachments" styleClass="profileTab"/>
                                </li>                                
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!quote.Legal_Contract__c != null}">                                
                                <li>
                                    <apex:commandLink value="Legal Contract" title="Legal Contract" onclick="window.open('/{!quote.Legal_Contract__c}');"/>
                                </li>
                            </apex:outputPanel>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <apex:pageBlock title="{!quote.Offering_Type__c} Tool" id="pgblk" rendered="{!strSelectedTab=='Quote Details'}">            
            <!-- Header Section -->
            <apex:pageBlockSection id="quoteInfo" title="Opportunity & Quote General Information">
                <apex:outputField value="{!quote.Name}" rendered="{!NOT(blnIsSimulated)}" />
                <apex:outputText label="Quote Status" style="font-weight:bold" value="{!quote.BigMachines__Status__c}"/>
                <apex:outputField value="{!quote.BigMachines__Opportunity__c}" rendered="{!NOT(quote.Quote_Cloned_Revised__c != null && IsQuoteUnLocked)}"/>
                <apex:inputField id="oppty" value="{!quote.BigMachines__Opportunity__c}" rendered="{!quote.Quote_Cloned_Revised__c != null && IsQuoteUnLocked}" required="true">
                    <apex:actionSupport event="onchange" action="{!changeOpportunity}" reRender="quoteInfo,msgs" status="changeStatus"/>
                    <apex:actionStatus id="changeStatus">
                        <apex:facet name="start">
                            <apex:image value="/img/loading.gif"/>
                        </apex:facet> 
                    </apex:actionStatus>
                </apex:inputField>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="Deal Qualification Status" />                   
                    <apex:outputLink value="#" target="_blank" onclick="openDQ(); return false;"> <b>{!dqStatus}</b> </apex:outputLink>
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!quote.Sold_To_Region__c}" rendered="{!NOT(blnIsSimulated)}" />                   
                <apex:outputField value="{!quote.CreatedDate}"/>
                <apex:outputField value="{!quote.End_User_ID__c}"  rendered="{!NOT(IsQuoteUnLocked)}"/>
                <apex:inputField id="EndUser" value="{!quote.End_User_ID__c}" rendered="{!IsQuoteUnLocked}" required="true">
                    <apex:actionSupport event="onchange" action="{!changeSoldTo}" reRender="EndUser,msgs" status="changeStatus"/>
                    <apex:actionStatus id="changeStatus1">
                        <apex:facet name="start">
                            <apex:image value="/img/loading.gif"/>
                        </apex:facet> 
                    </apex:actionStatus>
                </apex:inputField>
                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked}">
                    <apex:outputLabel value="Expiry Date"/>
                    <apex:inputField value="{!quote.Expiration_Date__c}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem rendered="{!NOT(IsQuoteUnLocked)}">
                    <apex:outputLabel value="Expiry Date"/>
                    <apex:outputField value="{!quote.Expiration_Date__c}" />
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!quote.Sold_To_Name__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                <apex:inputField id="soldTo" value="{!quote.Sold_To_Name__c}" rendered="{!IsQuoteUnLocked}" required="true">
                    <apex:actionSupport event="onchange" action="{!changeSoldTo}" reRender="soldTo,msgs" status="changeStatus"/>
                    <apex:actionStatus id="changeStatus">
                        <apex:facet name="start">
                            <apex:image value="/img/loading.gif"/>
                        </apex:facet> 
                    </apex:actionStatus>
                </apex:inputField>   
                <apex:outputField value="{!quote.BigMachines__Opportunity__r.Type}" />
                <apex:outputField label="Platform Type" value="{!quote.Quote_Business_Type__c}" />
                <apex:outputField value="{!quote.Offering_Type__c}" />
                <apex:pageBlockSectionItem rendered="{!NOT(blnIsSimulated)}" >
                    <apex:outputLabel value="Quote Submitted Date"/>
                    <apex:outputField value="{!quote.Approval_Submission_Date__c}"/>
                </apex:pageBlockSectionItem>
                <apex:outputField label="Partner: SMART Qualified" value="{!quote.Sold_To_Name__r.SMART_Qualified__c}" rendered="{!quote.BigMachines__Opportunity__r.Direct_Indirect_Sale__c == 'Indirect'}"/>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="Quote Approved Date"/>
                    <apex:outputField value="{!quote.Approval_Date__c}"/>
                </apex:pageBlockSectionItem>
                <apex:outputField label="Partner: Subscription Qualified" value="{!quote.Sold_To_Name__r.Subscription_Qualified__c}" rendered="{!quote.BigMachines__Opportunity__r.Direct_Indirect_Sale__c == 'Indirect'}"/>
                <apex:outputField value="{!quote.Revision_No__c}"/>
                
                 <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked}">
                    <apex:outputPanel >
                        <apex:outputLabel value="{!IF(quote.Offering_Type__c == 'PureEngage Subscription', 'Pricing Model', 'Base Package Pricing Model')}"/>                        
                    </apex:outputPanel>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                        <apex:outputPanel styleClass="requiredBlock" rendered="{!quote.Amendment_For__c == null}"/>
                        <apex:selectList id="calculationType" value="{!quote.Pricing_Model__c}" size="1" rendered="{!quote.Amendment_For__c == null}">
                            <apex:selectOption itemValue="User" itemLabel="User"/>
                            <apex:selectOption itemValue="Concurrent" itemLabel="Concurrent" rendered="{!NOT(isSmallMediumCenter)}"/>
                            <apex:actionSupport event="onchange" action="{!changePricingModel}"/>
                        </apex:selectList>
                        <apex:outputField value="{!quote.Pricing_Model__c}" rendered="{!quote.Amendment_For__c != null}"/>
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
                
                <apex:outputField value="{!quote.Pricing_Model__c}" rendered="{!!IsQuoteUnLocked}"/>
                
                <apex:outputField value="{!quote.CurrencyISOCode}"/>
                <apex:pageBlockSectionItem rendered="{!AND(IsQuoteUnLocked, quote.Amendment_For__c == null)}">
                    <apex:outputlabel value="MSLSA Link Type" for="msalinktype"/>
                    <apex:actionRegion >
                        <apex:inputField required="true" id="msalinktype" value="{!quote.MSA_Link_Type__c}"  >
                            <apex:actionSupport event="onchange" reRender="quoteInfo" action="{!setMSALink}"/>
                        </apex:inputField>
                    </apex:actionRegion>
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!quote.MSA_Link_Type__c}" rendered="{!OR(NOT(IsQuoteUnLocked), quote.Amendment_For__c != null)}"/>                
                <apex:outputField value="{!quote.Order_Type__c}"/>
                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked && quote.MSA_Link_Type__c=='Custom'}" id="msalink">
                    <apex:outputLabel value="MSLSA Link" for="msaLinkInput"/>
                    <apex:inputField id="msaLinkInput" value="{!quote.MSA_Link__c}" required="true"/>
                </apex:pageBlockSectionItem>   
                <apex:outputField label="MSLSA Link" value="{!quote.MSA_Link__c}" rendered="{!OR(NOT(IsQuoteUnLocked),IsQuoteUnLocked  && NOT(quote.MSA_Link_Type__c=='Custom'))}" id="msalinkOutput"/>
                <apex:inputTextArea value="{!quote.BigMachines__Description__c}" cols="70" rows="5" rendered="{!IsQuoteUnLocked}"/>
                <apex:outputField value="{!quote.BigMachines__Description__c}" style="" rendered="{!NOT(IsQuoteUnLocked)}"/>
                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked && quote.BigMachines__Opportunity__r.Direct_Indirect_Sale__c == 'Direct' && quote.Amendment_For__c == null}">
                    <apex:outputlabel value="Subscription Addendum Type" for="subscAddendumType"/>
                    <apex:actionRegion >
                        <apex:inputField required="true" id="subscAddendumType" value="{!quote.Subscription_Addendum_Type__c}"  >
                            <apex:actionSupport event="onchange" reRender="quoteInfo" action="{!setAddendumLink}"/>
                        </apex:inputField>
                    </apex:actionRegion>
                </apex:pageBlockSectionItem> 
                <apex:outputField value="{!quote.Subscription_Addendum_Type__c}" rendered="{!OR(NOT(IsQuoteUnLocked), quote.Amendment_For__c != null) && quote.BigMachines__Opportunity__r.Direct_Indirect_Sale__c == 'Direct'}"/>                
                <apex:inputField value="{!quote.Treat_SO_as_PO__c}" rendered="{!IsQuoteUnLocked}"/>
                <apex:outputField value="{!quote.Treat_SO_as_PO__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>                
                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked && quote.Subscription_Addendum_Type__c=='Custom' && quote.BigMachines__Opportunity__r.Direct_Indirect_Sale__c == 'Direct'}" id="addendumlink">
                    <apex:outputLabel value="Subscription Addendum Link" for="addenDumLinkInput"/>
                    <apex:inputField id="addenDumLinkInput" value="{!quote.Subscription_Addendum_Link__c}" required="true"/>
                </apex:pageBlockSectionItem>   
                <apex:outputField label="Subscription Addendum Link" value="{!quote.Subscription_Addendum_Link__c}" rendered="{!AND(OR(NOT(IsQuoteUnLocked),IsQuoteUnLocked  && NOT(quote.Subscription_Addendum_Type__c=='Custom')), quote.BigMachines__Opportunity__r.Direct_Indirect_Sale__c == 'Direct')}" id="addendumlinkOutput"/>
                <apex:outputField label="Subscription" value="{!quote.Amendment_For__c}" rendered="{!quote.Amendment_For__c != null}" />
                <apex:outputField value="{!quote.Top_Play__c}" />
                <apex:outputField value="{!quote.Offering_Feature__c }" rendered="{!isSmallMediumCenter}"/>
                <apex:outputField value="{!quote.Offer__c}" />
            </apex:pageBlockSection>
            <apex:pageBlockSection id="pgblkSecSubscriptionInfo" title="Subscription Terms">
                <!-- 1 Year Subscr -->
                <apex:outputField value="{!quote.No_Of_Months__c}" label="Term Length (Months)" rendered="{!(NOT(IsQuoteUnLocked) || isAmendQuote)}"/>
                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked && !isAmendQuote}">
                    <apex:outputLabel value="Term Length (Months)" />
                    <apex:selectList value="{!quote.No_Of_Months__c}" size="1" onchange="refreshSubscriptionSectionJS();">
                        <apex:selectOption itemLabel="24" itemValue="24.00" />
                        <apex:selectOption itemLabel="12" itemValue="12.00" />
                    </apex:selectList>
                </apex:pageBlockSectionItem>
            
                <apex:pageBlockSectionItem helpText="Defaults to 'Annually'">
                    <apex:outputLabel value="Billing Period" />
                    <apex:outputText value="{!quote.Billing_Period__c}" />
                </apex:pageBlockSectionItem>  
                
                <apex:pageBlockSectionItem rendered="{!quote.Amendment_For__c != null}" >
                    <apex:outputLabel value="Subscription Amend Date" />
                    <apex:outputField value="{!quote.CreatedDate}"/>                    
                </apex:pageBlockSectionItem>                
   
                <apex:outputField value="{!quote.Subscription_End_Date__c}" rendered="{!quote.Amendment_For__c != null}" />
                       
                  <!--- MS removed Bursting 9/6/19                                                                                                                            
                <apex:pageBlockSectionItem helpText="{!$ObjectType.BigMachines__Quote__c.fields.Overage_Allowance__c.inlineHelpText}"  rendered="{!IsQuoteUnLocked && !quote.Show_Why_Genesys__c && NOT(isAmendQuote) && NOT(isSmallMediumCenter)}">
                    <apex:outputLabel value="Burst Allowance %" />
                    <apex:selectList value="{!quote.Overage_Allowance__c}" size="1" onchange="refreshSubscriptionSectionJS();">
                        <apex:selectOption itemLabel="N/A" itemValue="" />
                        <apex:selectOption itemLabel="25%" itemValue="25%" />
                        <apex:selectOption itemLabel="Other" itemValue="Other" />
                    </apex:selectList>
                </apex:pageBlockSectionItem>
  
                <apex:outputField value="{!quote.Overage_Allowance__c}" rendered="{!(NOT(IsQuoteUnLocked) || isAmendQuote) && !quote.Show_Why_Genesys__c && NOT(isSmallMediumCenter)}"/>
                <apex:outputField value="{!quote.Overage_Allowance_Other__c}" rendered="{!quote.Overage_Allowance__c == 'Other' && !quote.Show_Why_Genesys__c && NOT(isSmallMediumCenter)}"/>                
                  
                <apex:outputField value="{!quote.Overage_Price_Premium__c}" rendered="{!!quote.Show_Why_Genesys__c && NOT(isSmallMediumCenter)}"/>
                -->
                <!-- MS conditional bursting  -->
                <apex:outputField value="{!quote.Overage_Allowance__c}" rendered="{!ShowBurstFields}"/>
                <apex:outputField value="{!quote.Overage_Allowance_Other__c}" rendered="{!ShowBurstFields}"/>                                  
                <apex:outputField value="{!quote.Overage_Price_Premium__c}" rendered="{!ShowBurstFields}"/>
                <!-- end conditional bursting -->

                <apex:inputField value="{!quote.Order_Payment_Terms__c}" required="true" rendered="{!IsQuoteUnLocked && NOT(isAmendQuote)}"/>
                <apex:outputField value="{!quote.Order_Payment_Terms__c}" rendered="{!NOT(IsQuoteUnLocked) || isAmendQuote}"/>                
                <apex:pageBlockSectionItem helpText="{!$ObjectType.BigMachines__Quote__c.fields.Price_Escalation__c.inlineHelpText}" rendered="{!IsQuoteUnLocked && NOT(isAmendQuote) && !oneyear}">
                    <apex:outputLabel value="Annual Price Increase %" />
                    <apex:selectList value="{!quote.Price_Escalation__c}" size="1" onchange="refreshSubscriptionSectionJS();" >
                        <apex:selectOption itemLabel="3%" itemValue="3%" /> 
                        <apex:selectOption itemLabel="4%" itemValue="4%" /> 
                        <apex:selectOption itemLabel="5%" itemValue="5%" /> 
                        <apex:selectOption itemLabel="Other" itemValue="Other" />                        
                    </apex:selectList>
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!quote.Price_Escalation__c}" rendered="{!NOT(IsQuoteUnLocked) && NOT(isAmendQuote) && !oneyear}"/>
                <apex:outputText value="{!quote.Annual_Price_Escalation_Other__c}" label="Annual Price Increase Other %" rendered="{!quote.Price_Escalation__c == 'Other' && !oneyear}"/>                
                <apex:inputField value="{!quote.Overage_Allowance_Price_Uptick__c}" rendered="{!IsQuoteUnLocked && blnIsDealFactoryUser}"/>
                <apex:outputField value="{!quote.Overage_Allowance_Price_Uptick__c}" rendered="{!NOT(IsQuoteUnLocked) && blnIsDealFactoryUser}"/>                                
                <apex:inputField value="{!quote.Payment_Terms_Price_Uptick__c}" rendered="{!IsQuoteUnLocked && blnIsDealFactoryUser}"/>
                <apex:outputField value="{!quote.Payment_Terms_Price_Uptick__c}" rendered="{!NOT(IsQuoteUnLocked) && blnIsDealFactoryUser}"/>                
                <apex:inputField label="Deployment Period (days)" value="{!quote.Ramp_Period__c}" rendered="{!IsQuoteUnLocked && NOT(isAmendQuote) && NOT(lever1)}"/>
                <apex:outputField label="Deployment Period (days)" value="{!quote.Ramp_Period__c}" rendered="{!(NOT(IsQuoteUnLocked) && NOT(isAmendQuote)) || lever1}"/>
                                    
                                                                                        
                <!--- MS remomed bursting 9/6/19          
                    <apex:inputField value="{!quote.RightToBurst__c}" rendered="{!IsQuoteUnLocked && NOT(isSmallMediumCenter) && NOT(isAmendQuote)}">
                        <apex:actionSupport event="onclick" action="{!resetRightToBust}" rerender="pgblkSecSubscriptionInfo" status="status" />
                    </apex:inputField>
                -->
                <!-- MS conditional bursting -->
                <apex:outputField value="{!quote.RightToBurst__c}" rendered="{!ShowBurstFields}"/>               
                <apex:outputField value="{!quote.RightToRemix__c}" rendered="{!ShowBurstFields}"/>   

                <apex:inputField value="{!quote.Optional_extended_term_length_Months__c}" rendered="{!IsQuoteUnLocked && NOT(isAmendQuote)}"/>
                <apex:outputField value="{!quote.Optional_extended_term_length_Months__c}" rendered="{!NOT(IsQuoteUnLocked) || isAmendQuote}"/>  
            
              <!--- MS remomed bursting 9/6/19 
                <apex:pageBlockSectionItem helpText="{!$ObjectType.BigMachines__Quote__c.fields.Usage_Data_Submission_Method__c.inlineHelpText}" rendered="{!NOT(isSmallMediumCenter)}" >                                        
                   <apex:outputLabel value="Usage Data Submission Method" />
                    <apex:outputPanel >                      
                     <apex:outputPanel rendered="{!(quote.Amendment_For__c == null && quote.RightToBurst__c && IsQuoteUnLocked)}">
                        <div class="requiredInput">
                            <div class="requiredBlock"></div>   
                            <apex:selectList value="{!quote.Usage_Data_Submission_Method__c}" size="1" required="true" >
                                <apex:selectOption itemLabel="No Bursting" itemValue="No Bursting" />                                                                        
                                <apex:selectOption itemLabel="Automated" itemValue="Automated" />
                                <apex:selectOption itemLabel="Manual" itemValue="Manual" />                                                                                                                                                                 
                           </apex:selectList>
                         </div>
                     </apex:outputPanel>

                   <apex:outputField value="{!quote.Usage_Data_Submission_Method__c}" rendered="{!(quote.Amendment_For__c != null || !quote.RightToBurst__c || !IsQuoteUnLocked)}" /> 
                </apex:outputPanel>
                </apex:pageBlockSectionItem>
            -->
             <apex:outputField value="{!quote.Usage_Data_Submission_Method__c}" rendered="{!ShowBurstFields}"/> 

            <!-- PureBridge -->   
            <apex:outputField value="{!quote.Lever__c}" rendered="{!(quote.Lever__c != null || isPureBridgeOpp)}"/>
            <apex:outputText value=""></apex:outputText> <!-- to insert a row -->
            <apex:outputField value="{!quote.BigMachines__Opportunity__r.Avaya_Contract_Expiration__c}" rendered="{!(quote.Lever__c != null || isPureBridgeOpp)}"/> 
    
            <apex:outputText value="{!quote.Deal_Score__c}"  style="width:50px;font-size: 24px;color:white;font-weight:bold;background:{!case(quote.Deal_Score__c ,5,'green',4,'green',3, 'orange',2,'red','red')};" />                 
                 
                 <apex:outputField value="{!quote.Compensation_Multiplier__c}" rendered="{!quote.Amendment_For__c == null}"/> 
                <apex:pageBlockSectionItem rendered="{!quote.Amendment_For__c == null}"> 
                    <apex:outputtext value="Cutoffs" />    
                    <apex:outputtext value="{!quote.Deal_Score_Cutoffs__c}" escape="false"/>
                </apex:pageBlockSectionItem>
            </apex:pageBlockSection>

            <apex:pageBlockSection title="{!IF(blnIsSimulated,'Estimation Products','Quote Products')}" collapsible="false" id="btns"/>
            <!--<apex:commandButton onclick="window.location.href='/apex/ConfigurationSubscription?id={!quote.Id}&tab=search';return false;" value="Search Products" rendered="{!IsQuoteUnLocked}"/>-->
            <apex:commandButton value="Search Products" rendered="{!IsQuoteUnLocked}" onclick="window.open('/apex/ConfigurationSubscription?id={!quote.Id}&tab=search','Product Configuration', 'fullscreen=yes,resizable=yes,scrollbars=yes');"/>
              &nbsp;&nbsp;
            <apex:commandButton value="Add Seasonal License Term" rendered="{!ShowAddBurstButton}" action="{!addBurstTerm}" />
            &nbsp;&nbsp;
            <apex:commandButton value="Product Configuration" rendered="{!IsQuoteUnLocked}" onclick="window.open('/apex/ConfigurationSubscription?id={!quote.Id}','Product Configuration', 'fullscreen=yes,resizable=yes,scrollbars=yes');"/>
            &nbsp;&nbsp;
            <apex:commandButton value="Calculate Deal Score" rendered="{!IsQuoteUnLocked}" action="{!CalculateScore}"/>
 
            <table width="100%">
                <tr>
                    <td style="text-align:left;" width="50%">
                        <apex:panelGrid columns="2" rendered="{!list_QuoteProducts.size > 0}">           
                            <apex:panelGroup >
                                <b>Group By :</b>
                            </apex:panelGroup>
                            <apex:panelGroup >
                                <apex:selectList value="{!quote.Grid_Group_By__c}" size="1">
                                    <apex:selectOption itemValue="Use Cases" itemLabel="Use Cases"/>
                                    <apex:selectOption itemValue="Categories" itemLabel="Categories"/>                                    
                                    <apex:selectOption itemValue="Bundles/Products" itemLabel="Bundles/Products"/>
                                    <apex:selectOption itemValue="Proposal Groups" itemLabel="Proposal Groups"/>
                                    <apex:selectOption itemValue="3rd Party/Genesys" itemLabel="3rd Party/Genesys"/>
                                    <apex:actionSupport event="onchange" action="{!createCurrentPageList}" status="status" reRender="QuoteProductsSection"/>
                                </apex:selectList>
                            </apex:panelGroup>
                        </apex:panelGrid>
                    </td>
                    <td style="text-align:left;" width="25%">
                        <apex:commandButton value="Save" action="{!doCalculations}" rendered="{!IsQuoteUnLocked}" />
                    </td>
                    <td style="text-align:right;" width="25%">
                        <apex:commandLink value="Select Columns" action="{!selectColumnsHandler}" status="status" reRender="selectColumns" 
                            style="font-size:105%" rendered="{!CONTAINS($Label.On_Premise_Tool_Profiles,$Profile.Name) 
                            || $Profile.Name = 'System Administrator' || $Profile.Name = 'General User Access Group SU'
                             || $Profile.Name = 'GEN - Finance'}"/>
                    </td>
                </tr>
            </table>
            
            <br/>
            <apex:inputHidden value="{!strToDelete}" id="strToDelete"/>         
    <apex:outputPanel id="QuoteProductsSection">
            <!--<apex:outputPanel layout="none" id="extraInnerPanel">-->
                <!-- Pagination Information -->
                <apex:outputPanel rendered="{!intTotalNoOfRecords > intPageSize}">
                    <center>
                        <b>Total Records : {!intTotalNoOfRecords}&nbsp;&nbsp;</b>
                        <apex:commandLink action="{!first}" status="status" reRender="QuoteProductsSection" rendered="{!HasPrevious}" style="text-decoration:none">
                            First
                        </apex:commandLink>
                        <apex:outputText value="First" rendered="{!NOT(HasPrevious)}" style="color:gray"/>
                        &nbsp;
                        <apex:commandLink action="{!previous}" status="status" reRender="QuoteProductsSection" rendered="{!HasPrevious}" style="text-decoration:none">
                            <apex:image url="/img/search_prevarrow.gif" title="Previous" styleClass="prevArrow"/>
                            &nbsp;
                            Previous
                        </apex:commandLink>
                        <apex:outputPanel rendered="{!NOT(HasPrevious)}" style="color:gray">
                            <apex:image url="/img/search_prevarrow_disabled.gif"/>
                            &nbsp;
                            Previous
                        </apex:outputPanel>
                        &nbsp;
                        ({!PageNumStr})
                        &nbsp;
                        <apex:commandLink action="{!next}" status="status" reRender="QuoteProductsSection" rendered="{!HasNext}" style="text-decoration:none">
                            Next
                            &nbsp;
                            <apex:image url="/img/search_nextarrow.gif" title="Next" styleClass="nextArrow"/>
                        </apex:commandLink>
                        <apex:outputPanel rendered="{!NOT(HasNext)}" style="color:gray">
                            Next
                            &nbsp;
                            <apex:image url="/img/search_nextarrow_disabled.gif"/>
                        </apex:outputPanel>
                        &nbsp;
                        <apex:commandLink action="{!last}" status="status" reRender="QuoteProductsSection" title="Last" rendered="{!HasNext}" style="text-decoration:none">
                            Last
                        </apex:commandLink>
                        <apex:outputText value="Last" rendered="{!NOT(HasNext)}" style="color:gray"/>
                    </center>
                    <br/>
                </apex:outputPanel>
                
                <table class="list " border="0" cellpadding="0" cellspacing="0" id="quoteProdGrid">
                    <thead>
                        <tr class="headerRow">
                            <th class="headerRow" style="width: 15px;"></th>
                            <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                                <th class="headerRow" style="width: 10px;">
                                    <apex:inputCheckBox id="check" value="{!blnIsHeaderChecked}">
                                        <apex:actionSupport event="onchange" action="{!checkUncheckAll}"/>
                                    </apex:inputCheckBox>
                                </th>
                                <th class="headerRow" style="width: 50px;">Action</th>
                            </apex:outputPanel>
                            <th class="headerRow" style="width: 50px;">Play/<br/>Offer</th>
                            <th class="headerRow" style="width: 45px;">Group</th>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.Building_Block__c}">
                                <th class="headerRow" style="width: 150px;">
                                    <!--{!IF(blnIsNewPricing,'Building Block','Sub Category')}-->
                                    Building Block
                                </th>
                            </apex:outputPanel>
                            <th class="headerRow" style="width: 200px;">Product</th>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                <th class="headerRow" style="width: 100px;">Unit of<br/>measure</th>
                            </apex:outputPanel>
                            <th class="headerRow" style="width: 50px;">Qty</th>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.List_Price__c}">
                                <th class="headerRow" style="width: 100px;">List Price</th>
                            </apex:outputPanel>
                            <apex:outputPanel layout="none" rendered="{!AND(objColumnPreference.Partner_Price__c,  quote.Multi_Year_Quote__c)}">
                                <th class="headerRow" style="width: 100px;">Partner<br/>Price</th>
                            </apex:outputPanel>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.Ext_List_Price__c}">
                                <th class="headerRow" style="width: 100px;">Ext List<br/>Price</th>
                            </apex:outputPanel>                            
                            <th class="headerRow" style="width: 100px;">Discount</th>       
                            <th class="headerRow" style="width: 50px;">% / Amt</th>
                            <th class="headerRow" style="width: 50px;">Total<br/>Disc %</th>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.Net_Unit_Price__c}">
                                <th class="headerRow" style="width: 100px;">Net Unit Price</th>
                            </apex:outputPanel>
                            <th class="headerRow" style="width: 100px;">Ext Net Price</th>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                <th class="headerRow" style="width: 50px;">3rd<br/>Party<br/>GC %</th>
                            </apex:outputPanel>
                            <apex:outputPanel layout="none" rendered="{!blnHasHWLines}">
                                <th class="headerRow" style="width: 50px;">3rd<br/>Party<br/>GC %</th>
                            </apex:outputPanel>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                <th class="headerRow" style="width: 50px;">PM<br/>Approver</th>
                            </apex:outputPanel>
                            <apex:outputPanel layout="none" rendered="{!quote.Order_Type__c == 'Amend' || quote.Order_Type__c == 'Subscription'}">>
                                <th class="headerRow" style="width: 100px;">Change<br/>History</th>
                            </apex:outputPanel>
                        </tr>
                    </thead>
                    <tbody>
                        <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                            <!-- Mass Update Row -->
                            <tr style="background-color:#D4D4CF;">
                                <td colspan="2"></td>
                                <td>
                                    <apex:commandlink action="{!deleteQuoteProducts}" title="Remove Selected Quote Product" onclick="var retVal = confirm('Are you sure you want to delete selected product(s)?'); if(retVal == false) return retVal;" reRender="QuoteProductsSection,TotalsBlock,msgs,chkOverrideTrainingUnit" status="status">
                                        <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>   
                                    </apex:commandlink>
                                </td>
                                <td></td>
                                <td colspan="{!2 + IF(objColumnPreference.Building_Block__c,1,0) + IF(objColumnPreference.Unit_of_measure__c,1,0)}">&nbsp;</td>
                                <td class="dataCell" colspan="{!1 + IF(objColumnPreference.List_Price__c,1,0) + IF(objColumnPreference.Ext_List_Price__c,1,0)}">
                                    <apex:inputField value="{!objMassUpdateInput.Quantity__c}" required="false" style="width:45px;"/>
                                </td>                              
                                <td class="dataCell">
                                    <apex:inputField value="{!objMassUpdateInput.Disc__c}" style="width:55px;"/>
                                </td>
                                <td class="dataCell">
                                    <apex:selectList value="{!objMassUpdateInput.or_Amount__c}" size="1">
                                        <apex:selectOption itemValue="" itemLabel=""/>
                                        <apex:selectOption itemValue="%" itemLabel="%"/>
                                        <apex:selectOption itemValue="Amt" itemLabel="Amt"/>
                                    </apex:selectList>
                                </td>
                                <td colspan="{!4 + IF(blnHasBundles,1,0) + IF(blnHasEMEAVolDisc,1,0) + IF(objColumnPreference.Product_Specific_Discount__c,1,0) + 
                                                IF(objColumnPreference.Net_Unit_Price__c,1,0) + IF(objColumnPreference.Third_Party__c,1,0) + 
                                                IF(blnHasHWLines,1,0) + IF(objColumnPreference.PM_Approver__c,1,0) + IF(objColumnPreference.Accepted_Volume_Discount__c,1,0)}">
                                    <apex:commandButton value="Mass Update Selected" action="{!massUpdateBtnHandler}"/>
                                </td>
                            </tr>
                        </apex:outputPanel>
                        
                        <apex:variable value="{!((intPageNum-1) * intPageSize) + 1}" var="rowNumLevel1"/>
                        <apex:repeat value="{!list_GroupHeaders}" var="strGroupHeader">
                        <apex:variable value="{!0}" var="rowNumLevel2"/>
                        <apex:repeat value="{!map_GroupHeaderToQuoteProdWrapper[strGroupHeader]}" var="objQPWrapper">
                            <apex:outputPanel layout="none" rendered="{!rowNumLevel2 == 0}">
                                <tr style="background-color:rgba(255, 249, 179, 0.75)">
                                    <td colspan="100">
                                        <!-- Group By Information --> 
                                        <apex:outputText escape="false" value="{!IF(strGroupHeader == 'BLANK','',strGroupHeader)}" />
                                    </td>
                                </tr>
                            </apex:outputPanel>
                            <apex:variable value="{!1}" var="rowNumLevel2"/>
                            <!-- Quote Product Rows -->
                            <tr class="dataRow">
                                <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">{!rowNumLevel1}.</td>
                                <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                                    <apex:outputPanel >
                                        <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">                                            
                                           <apex:inputCheckBox id="check" value="{!objQPWrapper.selected}" rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'Base Package' && objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess'}"/>                                            
                                        </td>
                                        <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}"> 
                                            <apex:commandlink action="{!deleteQuoteProduct}" title="Remove Quote Product" onclick="deleteQP('{!$Component.strToDelete}');" reRender="QuoteProductsSection,TotalsBlock,msgs,chkOverrideTrainingUnit" status="status" rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'Base Package' && objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && objQPWrapper.record.Subscription_Product__c == ''}">
                                                <apex:param name="quoteProductIdToBeDeleted" assignTo="{!quoteProductIdToBeDeleted}" value="{!objQPWrapper.record.id}" />
                                                <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>                                                                                   
                                            </apex:commandlink>
                                            <!--<apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}" title="Remove Quote Product" onclick="deleteQP('{!$Component.strToDelete}','{!objQPWrapper.record.id}');"/>-->
                                        </td>
                                    </apex:outputPanel>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none">
                                    <td>
                                        <apex:outputPanel rendered="{!objQPWrapper.record.Offer__c != ''}">
                                            <input type="checkbox" checked="true" disabled="true" title="{!objQPWrapper.record.Offer__c}"/>
                                        </apex:outputPanel>
                                    </td>
                                </apex:outputPanel>
                                <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                    <apex:selectList value="{!objQPWrapper.record.Group_Number__c}" size="1" 
                                            rendered="{!ISBLANK(objQPWrapper.record.Bundle__c) && IsQuoteUnLocked}">
                                        <apex:selectOption itemValue="" itemLabel=""/>
                                        <apex:selectOptions value="{!list_ProposalGroupNumberOptions}"/>
                                    </apex:selectList>
                                    <apex:outputField value="{!objQPWrapper.record.Group_Number__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Building_Block__c}">
                                    <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                        <!--{!IF(blnIsNewPricing,objQPWrapper.record.BigMachines__Product__r.Building_Block__c,objQPWrapper.record.BigMachines__Product__r.Section__c)}-->
                                        {!objQPWrapper.record.BigMachines__Product__r.Building_Block__c}
                                    </td>
                                </apex:outputPanel>
                                <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c};">
                                    <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'Base Package' && objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && objQPWrapper.record.Bundle__r.Group_Type__c != 'A la Carte'}">
                                        <apex:outputField value="{!objQPWrapper.record.Product_Description__c}"/><br/>
                                         (<apex:outputField value="{!objQPWrapper.record.BigMachines__Product__r.APN_Number__c}" rendered="{!if(objQPWrapper.record.BigMachines__Product__r.Type__c<>'Bundle',true,false)}" />
                                        <apex:outputLink onclick="window.open('../apex/ShowBundleproducts?productid={!objQPWrapper.record.BigMachines__Product__r.id}&quoteid={!quote.id}&id={!objQPWrapper.record.id}','Window1','menubar=no,width=430,height=360,toolbar=no');return false;" rendered="{!if(objQPWrapper.record.BigMachines__Product__r.Type__c=='Bundle',true,false)}">{!objQPWrapper.record.BigMachines__Product__r.APN_Number__c}</apex:outputLink>
                                        )
                                    </apex:outputPanel>
                                    <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c == 'Base Package' || objQPWrapper.record.Bundle__r.Group_Type__c == 'PureSuccess' || objQPWrapper.record.Bundle__r.Group_Type__c == 'A la Carte'}">
                                        <apex:outputLink onclick="window.open('../apex/ShowBundleproducts?productid={!objQPWrapper.record.BigMachines__Product__r.id}&quoteid={!quote.id}&id={!objQPWrapper.record.id}','Window1','menubar=no,width=430,height=360,toolbar=no');return false;" rendered="{!objQPWrapper.record.BigMachines__Product__r.Type__c=='Bundle'}">
                                            <apex:outputField value="{!objQPWrapper.record.BigMachines__Product__r.Description__c}" />
                                        </apex:outputLink>
                                        <apex:outputField value="{!objQPWrapper.record.BigMachines__Product__r.Description__c}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Type__c != 'Bundle'}"/>
                                    </apex:outputPanel>
                                    <apex:outputPanel layout="none" rendered="{!NOT(ISBLANK(objQPWrapper.record.BigMachines__Product__r.Flavors_Available__c))}">
                                        <br/>
                                        <apex:outputPanel layout="block" styleClass="requiredInput" rendered="{!IsQuoteUnLocked}">
                                            <apex:outputPanel styleClass="requiredBlock"/>
                                            <apex:selectList value="{!objQPWrapper.record.Flavor__c}" size="1" style="color:blue">
                                                <apex:selectOption itemValue="" itemLabel=""/>
                                                <apex:selectOptions value="{!map_FlavorsToSelectOptions[objQPWrapper.record.BigMachines__Product__r.Flavors_Available__c]}"/>
                                            </apex:selectList>
                                        </apex:outputPanel>
                                        <apex:outputText value="{!objQPWrapper.record.Flavor__c}" rendered="{!NOT(IsQuoteUnLocked)}" style="color:blue"/>
                                    </apex:outputPanel>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                    <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                        <apex:outputField value="{!objQPWrapper.record.Unit_of_Measure__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">                                    
                                    <apex:inputField value="{!objQPWrapper.record.Quantity__c}" required="false" style="width:45px;" rendered="{!IsQuoteUnLocked && ISBLANK(objQPWrapper.record.Build_Type__c) && objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && NOT(objQPWrapper.record.PureBridge_Free_GU__c)}"/>
                                    <apex:outputField value="{!objQPWrapper.record.Quantity__c}" rendered="{!NOT(IsQuoteUnLocked && ISBLANK(objQPWrapper.record.Build_Type__c)) || objQPWrapper.record.Bundle__r.Group_Type__c == 'PureSuccess' || objQPWrapper.record.PureBridge_Free_GU__c}"/>
                                </td>
                            <!-- 11/15/19
                                <apex:outputPanel layout="none" rendered="{!AND(objColumnPreference.List_Price__c, OR(quote.Multi_Year_Quote__c = false, objQPWrapper.record.Hardware_or_Third_Party__c, objQPWrapper.record.Bundle__r.Group_Type__c == 'Campaigns'))}">
                                    <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                        <apex:outputText value="{0, number,###,###,##0.00}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2'}">
                                            <apex:param value="{!objQPWrapper.record.List_Price__c}"/>
                                        </apex:outputText>
                                        <apex:outputText value="{0, number,###,###,##0.0000}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">
                                            <apex:param value="{!objQPWrapper.record.List_Price__c}"/>
                                        </apex:outputText>
                                        <apex:outputText value="{0, number,###,###,##0.000000}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">
                                            <apex:param value="{!objQPWrapper.record.List_Price__c}"/>
                                        </apex:outputText>
                                    </td>
                                </apex:outputPanel>
                          
                                <apex:outputPanel layout="none" rendered="{!AND(objColumnPreference.List_Price__c, quote.Multi_Year_Quote__c = true, !objQPWrapper.record.Hardware_or_Third_Party__c, objQPWrapper.record.Bundle__r.Group_Type__c != 'Campaigns')}">
                            -->  
                            <apex:outputPanel layout="none" rendered="{!AND(objColumnPreference.List_Price__c, !objQPWrapper.record.Hardware_or_Third_Party__c, objQPWrapper.record.Bundle__r.Group_Type__c != 'Campaigns')}"> 
                                <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                        <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && (objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2')}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                              Y1 -
                                            <apex:outputText value="{0, number,###,###,##0.00}">
                                                <apex:param value="{!objQPWrapper.record.List_Price_1__c}"/>
                                            </apex:outputText><br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 -
                                                <apex:outputText value="{0, number,###,###,##0.00}">
                                                    <apex:param value="{!objQPWrapper.record.List_Price_2__c}"/>
                                                </apex:outputText>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && (objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4')}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                               Y1 -
                                                <apex:outputText value="{0, number,###,###,##0.0000}">
                                                    <apex:param value="{!objQPWrapper.record.List_Price_1__c}"/>
                                                </apex:outputText><br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 -
                                                <apex:outputText value="{0, number,###,###,##0.0000}">
                                                    <apex:param value="{!objQPWrapper.record.List_Price_2__c}"/>
                                                </apex:outputText>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && (objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6')}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                                Y1 -
                                                <apex:outputText value="{0, number,###,###,##0.000000}">
                                                    <apex:param value="{!objQPWrapper.record.List_Price_1__c}"/>
                                                </apex:outputText><br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 -
                                                <apex:outputText value="{0, number,###,###,##0.000000}">
                                                    <apex:param value="{!objQPWrapper.record.List_Price_2__c}"/>
                                                </apex:outputText>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!AND(objColumnPreference.Partner_Price__c, quote.Multi_Year_Quote__c = true)}">                                    
                                    <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">  
                               
                                        <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && objQPWrapper.record.Hardware_or_Third_Party__c}">
                                            <apex:outputText value="{0, number,###,###,##0.00}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2'}">
                                                <apex:param value="{!objQPWrapper.record.Partner_Price__c}"/>
                                            </apex:outputText>
                                            <apex:outputText value="{0, number,###,###,##0.0000}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">
                                                <apex:param value="{!objQPWrapper.record.Partner_Price__c}"/>
                                            </apex:outputText>
                                            <apex:outputText value="{0, number,###,###,##0.000000}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">
                                                <apex:param value="{!objQPWrapper.record.Partner_Price__c}"/>
                                            </apex:outputText>
                                        </apex:outputPanel>
                                 
                                        <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && !objQPWrapper.record.Hardware_or_Third_Party__c}">                                        
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                                Y1 -
                                                <apex:outputText value="{0, number,###,###,##0.00}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2'}">
                                                    <apex:param value="{!objQPWrapper.record.Partner_Price_1__c}"/>
                                                </apex:outputText>
                                                <apex:outputText value="{0, number,###,###,##0.0000}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">
                                                    <apex:param value="{!objQPWrapper.record.Partner_Price_1__c}"/>
                                                </apex:outputText>
                                                <apex:outputText value="{0, number,###,###,##0.000000}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">
                                                    <apex:param value="{!objQPWrapper.record.Partner_Price_1__c}"/>
                                                </apex:outputText>
                                                <br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 -
                                                <apex:outputText value="{0, number,###,###,##0.00}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2'}">
                                                    <apex:param value="{!objQPWrapper.record.Partner_Price_2__c}"/>
                                                </apex:outputText>
                                                <apex:outputText value="{0, number,###,###,##0.0000}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">
                                                    <apex:param value="{!objQPWrapper.record.Partner_Price_2__c}"/>
                                                </apex:outputText>
                                                <apex:outputText value="{0, number,###,###,##0.000000}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">
                                                    <apex:param value="{!objQPWrapper.record.Partner_Price_2__c}"/>
                                                </apex:outputText>
                                                <br/>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Ext_List_Price__c}">
                                    <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                        <!-- 11/15/19 -->
                                        <apex:outputPanel rendered="{!!quote.Multi_Year_Quote__c || objQPWrapper.record.Hardware_or_Third_Party__c}">
                                    
                                        <!-- apex:outputPanel rendered="{!objQPWrapper.record.Hardware_or_Third_Party__c}" -->
                                            <apex:outputField value="{!objQPWrapper.record.Ext_List__c}"/>                                            
                                        </apex:outputPanel>
                                    
                                        <apex:outputPanel rendered="{!quote.Multi_Year_Quote__c && objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && !objQPWrapper.record.Hardware_or_Third_Party__c}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                               Y1 - <apex:outputField value="{!objQPWrapper.record.Ext_List_Price_1__c}"/> <br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                              Y2 - <apex:outputField value="{!objQPWrapper.record.Ext_List_Price_2__c}" />  
                                            </apex:outputPanel>                                          
                                        </apex:outputPanel>                                        
                                    </td>
                                </apex:outputPanel>
                                <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                    <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && objQPWrapper.record.Bundle__r.Group_Type__c != 'A la Carte'}">
                                        <apex:inputField value="{!objQPWrapper.record.Disc__c}" style="width:55px;" rendered="{!IsQuoteUnLocked && objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && NOT(objQPWrapper.record.PureBridge_Free_GU__c)}"/>
                                        <apex:outputField value="{!objQPWrapper.record.Disc__c}" rendered="{!NOT(IsQuoteUnLocked) || objQPWrapper.record.Bundle__r.Group_Type__c == 'PureSuccess' || objQPWrapper.record.PureBridge_Free_GU__c}"/>    
                                    </apex:outputPanel>                                        
                                    <!-- Discount
                                    <apex:outputPanel rendered="{!quote.Multi_Year_Quote__c && objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && objQPWrapper.record.Bundle__r.Group_Type__c != 'A la Carte'}">
                                        <apex:outputPanel rendered="{!IsQuoteUnLocked && objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess'}">
                                            Y1 - <apex:inputField value="{!objQPWrapper.record.Discount_1__c}" style="width:55px;" /> <br/>
                                            Y2 - <apex:inputField value="{!objQPWrapper.record.Discount_2__c}" style="width:55px;" />
                                        </apex:outputPanel>     
                                        <apex:outputPanel rendered="{!NOT(IsQuoteUnLocked)}">
                                            Y1 - <apex:outputField value="{!objQPWrapper.record.Discount_1__c}"/><br/>
                                            Y2 - <apex:outputField value="{!objQPWrapper.record.Discount_2__c}"/>
                                        </apex:outputPanel>    
                                    </apex:outputPanel>
                                    -->
                                </td>
                                <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                    <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && objQPWrapper.record.Bundle__r.Group_Type__c != 'A la Carte'}">     
                                    <apex:selectList value="{!objQPWrapper.record.or_Amount__c}" size="1" rendered="{!IsQuoteUnLocked}">
                                        <apex:selectOption itemValue="" itemLabel=""/>
                                        <apex:selectOption itemValue="%" itemLabel="%"/>
                                        <apex:selectOption itemValue="Amt" itemLabel="Amt"/>
                                    </apex:selectList>
                                    </apex:outputPanel>
                                    <apex:outputField value="{!objQPWrapper.record.or_Amount__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                                </td>
                                <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                    <apex:outputField value="{!objQPWrapper.record.Total_Discount__c}" rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess'}"/>
                                </td>                                                                
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Net_Unit_Price__c}">
                                    <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                        <!-- 11/15/19
                                        <apex:outputPanel rendered="{!!quote.Multi_Year_Quote__c || objQPWrapper.record.Hardware_or_Third_Party__c}">  
                                        -->  
                                        <apex:outputPanel rendered="{!objQPWrapper.record.Hardware_or_Third_Party__c}">                                     
                                            <apex:outputText value="{0, number,###,###,##0.00}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2'}">
                                                <apex:param value="{!objQPWrapper.record.Net_Unit_Price__c}"/>
                                            </apex:outputText>
                                            <apex:outputText value="{0, number,###,###,##0.0000}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">
                                                <apex:param value="{!objQPWrapper.record.Net_Unit_Price__c}"/>
                                            </apex:outputText>
                                            <apex:outputText value="{0, number,###,###,##0.000000}" rendered="{!objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">
                                                <apex:param value="{!objQPWrapper.record.Net_Unit_Price__c}"/>
                                            </apex:outputText>
                                        </apex:outputPanel>
                                    
                                        <!-- 11/15/19
                                        <apex:outputPanel rendered="{!quote.Multi_Year_Quote__c && objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && !objQPWrapper.record.Hardware_or_Third_Party__c && objQPWrapper.record.Bundle__r.Group_Type__c != 'Campaigns' && (objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2')}">
                                        -->
                                        <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && !objQPWrapper.record.Hardware_or_Third_Party__c && objQPWrapper.record.Bundle__r.Group_Type__c != 'Campaigns' && (objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2')}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                                Y1 - <apex:outputText value="{0, number,###,###,##0.00}"><apex:param value="{!objQPWrapper.record.Net_Unit_Price_1__c}"/></apex:outputText> <br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 - <apex:outputText value="{0, number,###,###,##0.00}" ><apex:param value="{!objQPWrapper.record.Net_Unit_Price_2__c}"/></apex:outputText>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                        <!-- 11/15/19
                                        <apex:outputPanel rendered="{!quote.Multi_Year_Quote__c && objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && !objQPWrapper.record.Hardware_or_Third_Party__c && objQPWrapper.record.Bundle__r.Group_Type__c != 'Campaigns' && objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">                                         
                                        -->
                                        <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && !objQPWrapper.record.Hardware_or_Third_Party__c && objQPWrapper.record.Bundle__r.Group_Type__c != 'Campaigns' && objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                                Y1 - <apex:outputText value="{0, number,###,###,##0.0000}"><apex:param value="{!objQPWrapper.record.Net_Unit_Price_1__c}"/></apex:outputText> <br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 - <apex:outputText value="{0, number,###,###,##0.0000}" ><apex:param value="{!objQPWrapper.record.Net_Unit_Price_2__c}"/></apex:outputText>
                                            </apex:outputPanel>
                                         </apex:outputPanel>
                                        <!-- 11/15/19
                                         <apex:outputPanel rendered="{!quote.Multi_Year_Quote__c && objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && !objQPWrapper.record.Hardware_or_Third_Party__c && objQPWrapper.record.Bundle__r.Group_Type__c != 'Campaigns' && objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">                                           
                                        -->
                                         <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && !objQPWrapper.record.Hardware_or_Third_Party__c && objQPWrapper.record.Bundle__r.Group_Type__c != 'Campaigns' && objQPWrapper.record.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                                Y1 - <apex:outputText value="{0, number,###,###,##0.000000}"><apex:param value="{!objQPWrapper.record.Net_Unit_Price_1__c}"/></apex:outputText> <br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">                                                
                                               Y2 - <apex:outputText value="{0, number,###,###,##0.000000}" ><apex:param value="{!objQPWrapper.record.Net_Unit_Price_2__c}"/></apex:outputText>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </td>
                                </apex:outputPanel>
                                <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                    <!-- 11/15/19
                                    <apex:outputPanel rendered="{!!quote.Multi_Year_Quote__c || objQPWrapper.record.Hardware_or_Third_Party__c}"> 
                                    -->
                                    <apex:outputPanel rendered="{!objQPWrapper.record.Hardware_or_Third_Party__c}">                                           
                                        <apex:outputField value="{!objQPWrapper.record.Ext_Net_Price__c}"/>
                                   </apex:outputPanel>
                                   
                                    <!-- 11/15/19
                                   <apex:outputPanel rendered="{!quote.Multi_Year_Quote__c && objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && !objQPWrapper.record.Hardware_or_Third_Party__c}">
                                    -->                                    
                                   <apex:outputPanel rendered="{!objQPWrapper.record.Bundle__r.Group_Type__c != 'PureSuccess' && !objQPWrapper.record.Hardware_or_Third_Party__c}">
                                        <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                            Y1 - <apex:outputField value="{!objQPWrapper.record.Ext_Net_Price_1__c}"/><br/>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!(!oneyear)}">
                                              Y2 - <apex:outputField value="{!objQPWrapper.record.Ext_Net_Price_2__c}" />
                                        </apex:outputPanel>
                                   </apex:outputPanel>                                    
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                    <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                        <apex:outputText value="{!IF(OR(objQPWrapper.record.Third_Party__c == 'True',objQPWrapper.record.Third_Party__c == 'TRUE',objQPWrapper.record.Third_Party__c == 'true'),'Yes','No')}"/>
                                        <!--{!objQPWrapper.record.Third_Party__c}-->
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!blnHasHWLines}">
                                    <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                        <apex:outputField value="{!objQPWrapper.record.Third_Party_GC__c}" rendered="{!OR(NOT(quote.X3rd_Party_Override__c), objQPWrapper.record.Third_Party_GC__c == NULL) }" />
                                        <apex:inputField value="{!objQPWrapper.record.Third_Party_GC__c}" rendered="{!AND(quote.X3rd_Party_Override__c, objQPWrapper.record.Third_Party_GC__c != NULL)}" style="width:50px;" />                                        
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                    <td class="dataCell" style="background-color:{!objQPWrapper.record.Line_Color__c}">
                                        <apex:outputField value="{!objQPWrapper.record.Pm_Approver__c}"
                                            rendered="{!objQPWrapper.record.BigMachines__Product__r.Shipment_Approval__c = 'Required for all Orders' ||
                                                objQPWrapper.record.BigMachines__Product__r.Shipment_Approval__c = 'Required for New Orders Only'}"/>
                                    </td>
                                </apex:outputPanel>
                                
                                <apex:outputPanel layout="none" rendered="{!quote.Order_Type__c == 'Amend' }">
                                   
                                    <apex:variable value="{!objQPWrapper.record.Id}" var="uniqueKey"/> 
                                    <!-- <apex:variable value="{!objQPWrapper.record.BigMachines__Product__c};{!objQPWrapper.record.Is_Overage__c}" var="uniqueKey"/> -->
                                   
                                    <td class="dataCell" style="background-color: {!map_ProdChangeHistoryColor[uniqueKey]}">
                                        <i><apex:outputText value="{!map_ProdChangeHistory[uniqueKey]}"/></i>
                                    </td>
                                </apex:outputPanel>
                            </tr>
                            <apex:variable value="{!rowNumLevel1 + 1}" var="rowNumLevel1"/>
                        </apex:repeat>
                    </apex:repeat> 

                    <!-- START: Burst seasonal licensing -->
                <apex:outputPanel layout="none" rendered="{!list_QuoteBurstTerms.size > 0}" >
                    <tr style="background-color:#F9F5C0">
                        <td colspan="100">
                            Seasonal Licenses 
                        </td>
                    </tr>
                    <apex:repeat value="{!list_QuoteBurstTerms}" var="quoteBurstTerms" >         
                        <tr  style="background-color:#EBF9C0" >
                            <td style="border:0"></td>
                            <td style="border:0"></td>                     
                            <apex:outputPanel layout="none" rendered="{!(IsQuoteUnLocked && ISBLANK(quoteBurstTerms.term.CCDB_Subscription_Burst_Term__c))}">
                                <td class="dataCell" style="border:0"> 
                                    <apex:commandlink action="{!deleteQuoteBurstTerm}" onclick="deleteQP('{!$Component.strToDelete}');" immediate="true" reRender="QuoteProductsSection,TotalsBlock,msgs" status="status">
                                        <apex:param name="quoteBurstTermIdToBeDeleted" assignTo="{!quoteBurstTermIdToBeDeleted}" value="{!quoteBurstTerms.term.id}" />
                                        <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>   
                                    </apex:commandlink>
                                </td>
                           </apex:outputPanel>               
                            <td colspan="{!14 + IF(IsQuoteUnLocked && ISBLANK(quoteBurstTerms.term.CCDB_Subscription_Burst_Term__c),1,0)}" > 
                                <apex:pageBlockSection >          
                                    <apex:inputField value="{!quoteBurstTerms.term.Term_Length_Months__c}" rendered="{!(IsQuoteUnLocked && ISBLANK(quoteBurstTerms.term.CCDB_Subscription_Burst_Term__c))}" required="true"/>
                                    <apex:outputField value="{!quoteBurstTerms.term.Term_Length_Months__c}" rendered="{!(!IsQuoteUnLocked || NOT(ISBLANK(quoteBurstTerms.term.CCDB_Subscription_Burst_Term__c)))}" /> 
                                </apex:pageBlockSection> 
                           
                            </td>
                             <!-- Amendment-->
                             <apex:outputPanel layout="none" rendered="{!(quote.Order_Type__c == 'Amend' && ISBLANK(quoteBurstTerms.term.CCDB_Subscription_Burst_Term__c))}">
                                 <td class="dataCell" style="background-color: {!strChngeHistColors[1]}">
                                     Added
                                 </td>
                             </apex:outputPanel>
                        </tr>

                    <!-- Individual products for burst -->
                    <apex:repeat value="{!quoteBurstTerms.qtprods}" var="burstProduct" >
                      <apex:outputPanel layout="none" rendered="{!burstProduct.Bundle_Line__c=null}"> 
                            <tr class="dataRow">
                                <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">{!rowNumLevel1}.</td> 
                                
                                <td style="background-color:{!burstProduct.Line_Color__c}"></td>                                                       
                                <td style="background-color:{!burstProduct.Line_Color__c}"></td>

                                <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                                    <td style="background-color:{!burstProduct.Line_Color__c}"></td>                                                       
                                    <td style="background-color:{!burstProduct.Line_Color__c}"></td>
                                </apex:outputPanel>
            
                                <!-- Building block -->
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Building_Block__c}">
                                    <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                        {!burstProduct.BigMachines__Product__r.Building_Block__c}
                                    </td>
                                </apex:outputPanel>
                                <!-- Product -->
                                <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c};">
                                    <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c != 'Base Package' && burstProduct.Bundle__r.Group_Type__c != 'A la Carte'}">
                                        <apex:outputField value="{!burstProduct.Product_Description__c}"/><br/>
                                            (<apex:outputField value="{!burstProduct.BigMachines__Product__r.APN_Number__c}" rendered="{!if(burstProduct.BigMachines__Product__r.Type__c<>'Bundle',true,false)}" />
                                        <apex:outputLink onclick="window.open('../apex/ShowBundleproducts?productid={!burstProduct.BigMachines__Product__r.id}&quoteid={!quote.id}id={!burstProduct.id}','Window1','menubar=no,width=430,height=360,toolbar=no');return false;" rendered="{!if(burstProduct.BigMachines__Product__r.Type__c=='Bundle',true,false)}">{!burstProduct.BigMachines__Product__r.APN_Number__c}</apex:outputLink>
                                        )
                                    </apex:outputPanel>
                                    <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c == 'Base Package' || burstProduct.Bundle__r.Group_Type__c == 'A la Carte'}">
                                        <apex:outputLink onclick="window.open('../apex/ShowBundleproducts?productid={!burstProduct.BigMachines__Product__r.id}&quoteid={!quote.id}id={!burstProduct.id}','Window1','menubar=no,width=430,height=360,toolbar=no');return false;" rendered="{!burstProduct.BigMachines__Product__r.Type__c=='Bundle'}">
                                            <apex:outputField value="{!burstProduct.BigMachines__Product__r.Description__c}" />
                                        </apex:outputLink>
                                        <apex:outputField value="{!burstProduct.BigMachines__Product__r.Description__c}" rendered="{!burstProduct.BigMachines__Product__r.Type__c != 'Bundle'}"/>
                                    </apex:outputPanel>
                                    <apex:outputPanel layout="none" rendered="{!NOT(ISBLANK(burstProduct.BigMachines__Product__r.Flavors_Available__c))}">
                                        <br/>
                                        <apex:outputPanel layout="block" styleClass="requiredInput" rendered="{!IsQuoteUnLocked}">
                                            <apex:outputPanel styleClass="requiredBlock"/>
                                            <apex:selectList value="{!burstProduct.Flavor__c}" size="1" style="color:blue">
                                                <apex:selectOption itemValue="" itemLabel=""/>
                                                <apex:selectOptions value="{!map_FlavorsToSelectOptions[burstProduct.BigMachines__Product__r.Flavors_Available__c]}"/>
                                            </apex:selectList>
                                        </apex:outputPanel>
                                        <apex:outputText value="{!burstProduct.Flavor__c}" rendered="{!NOT(IsQuoteUnLocked)}" style="color:blue"/>
                                    </apex:outputPanel>
                                </td>
                                <!-- Unit of measure -->
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                    <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                        <apex:outputField value="{!burstProduct.Unit_of_Measure__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <!-- Qty -->
                                <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                    <apex:inputField value="{!burstProduct.Quantity__c}" required="false" style="width:45px;" rendered="{!IsQuoteUnLocked && ISBLANK(burstProduct.Build_Type__c) && burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && NOT(burstProduct.PureBridge_Free_GU__c)}"/>
                                    <apex:outputField value="{!burstProduct.Quantity__c}" rendered="{!NOT(IsQuoteUnLocked && ISBLANK(burstProduct.Build_Type__c)) ||burstProduct.Bundle__r.Group_Type__c == 'PureSuccess' || burstProduct.PureBridge_Free_GU__c}"/>
                                </td>
                                <!-- List Price -->
                                <!-- 11/15/19
                                <apex:outputPanel layout="none" rendered="{!AND(objColumnPreference.List_Price__c, OR(quote.Multi_Year_Quote__c = false,burstProduct.Hardware_or_Third_Party__c, burstProduct.Bundle__r.Group_Type__c == 'Campaigns'))}">
                                --> 
                                <apex:outputPanel layout="none" rendered="{!AND(objColumnPreference.List_Price__c, OR(burstProduct.Hardware_or_Third_Party__c, burstProduct.Bundle__r.Group_Type__c == 'Campaigns'))}">
                                    <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                        <apex:outputText value="{0, number,###,###,##0.00}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c ==null || burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2'}">
                                            <apex:param value="{!burstProduct.List_Price__c}"/>
                                        </apex:outputText>
                                        <apex:outputText value="{0, number,###,###,##0.0000}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c== '4'}">
                                            <apex:param value="{!burstProduct.List_Price__c}"/>
                                        </apex:outputText>
                                        <apex:outputText value="{0, number,###,###,##0.000000}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c== '6'}">
                                            <apex:param value="{!burstProduct.List_Price__c}"/>
                                        </apex:outputText>
                                    </td>
                                </apex:outputPanel>

                                <!-- 11/15/19
                                <apex:outputPanel layout="none" rendered="{!AND(objColumnPreference.List_Price__c, quote.Multi_Year_Quote__c = true,!burstProduct.Hardware_or_Third_Party__c, burstProduct.Bundle__r.Group_Type__c != 'Campaigns')}">
                                -->   
                                <apex:outputPanel layout="none" rendered="{!AND(objColumnPreference.List_Price__c, !burstProduct.Hardware_or_Third_Party__c, burstProduct.Bundle__r.Group_Type__c != 'Campaigns')}">
                                    <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                        <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' &&(burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null ||burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2')}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                                 Y1 -
                                                <apex:outputText value="{0, number,###,###,##0.00}">
                                                    <apex:param value="{!burstProduct.List_Price_1__c}"/>
                                                </apex:outputText><br/>
                                           </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 -
                                                <apex:outputText value="{0, number,###,###,##0.00}">
                                                    <apex:param value="{!burstProduct.List_Price_2__c}"/>
                                                </apex:outputText>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' &&(burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4')}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                            Y1 -
                                            <apex:outputText value="{0, number,###,###,##0.0000}">
                                                <apex:param value="{!burstProduct.List_Price_1__c}"/>
                                            </apex:outputText><br/>
                                        </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 -
                                                <apex:outputText value="{0, number,###,###,##0.0000}">
                                                    <apex:param value="{!burstProduct.List_Price_2__c}"/>
                                                </apex:outputText>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' &&(burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6')}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                              Y1 -
                                            <apex:outputText value="{0, number,###,###,##0.000000}">
                                                <apex:param value="{!burstProduct.List_Price_1__c}"/>
                                            </apex:outputText><br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 -
                                                <apex:outputText value="{0, number,###,###,##0.000000}">
                                                    <apex:param value="{!burstProduct.List_Price_2__c}"/>
                                                </apex:outputText>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!AND(objColumnPreference.Partner_Price__c, quote.Multi_Year_Quote__c = true)}">                                    
                                    <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">  
                                        <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && burstProduct.Hardware_or_Third_Party__c}">
                                            <apex:outputText value="{0, number,###,###,##0.00}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2'}">
                                                <apex:param value="{!burstProduct.Partner_Price__c}"/>
                                            </apex:outputText>
                                            <apex:outputText value="{0, number,###,###,##0.0000}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">
                                                <apex:param value="{!burstProduct.Partner_Price__c}"/>
                                            </apex:outputText>
                                            <apex:outputText value="{0, number,###,###,##0.000000}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">
                                                <apex:param value="{!burstProduct.Partner_Price__c}"/>
                                            </apex:outputText>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && !burstProduct.Hardware_or_Third_Party__c}">                                        
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                                Y1 -
                                                <apex:outputText value="{0, number,###,###,##0.00}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2'}">
                                                    <apex:param value="{!burstProduct.Partner_Price_1__c}"/>
                                                </apex:outputText>
                                                <apex:outputText value="{0, number,###,###,##0.0000}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">
                                                    <apex:param value="{!burstProduct.Partner_Price_1__c}"/>
                                                </apex:outputText>
                                                <apex:outputText value="{0, number,###,###,##0.000000}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">
                                                    <apex:param value="{!burstProduct.Partner_Price_1__c}"/>
                                                </apex:outputText>
                                                <br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 -
                                                <apex:outputText value="{0, number,###,###,##0.00}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2'}">
                                                    <apex:param value="{!burstProduct.Partner_Price_2__c}"/>
                                                </apex:outputText>
                                                <apex:outputText value="{0, number,###,###,##0.0000}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">
                                                    <apex:param value="{!burstProduct.Partner_Price_2__c}"/>
                                                </apex:outputText>
                                                <apex:outputText value="{0, number,###,###,##0.000000}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">
                                                    <apex:param value="{!burstProduct.Partner_Price_2__c}"/>
                                                </apex:outputText>
                                                <br/>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </td>
                                </apex:outputPanel>
                                <!-- Ext List Price -->
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Ext_List_Price__c}">
                                    <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                        <!-- 11/15/19
                                            <apex:outputPanel rendered="{!!quote.Multi_Year_Quote__c || burstProduct.Hardware_or_Third_Party__c}">
                                        -->
                                        <apex:outputPanel rendered="{!burstProduct.Hardware_or_Third_Party__c}">
                                            <apex:outputField value="{!burstProduct.Ext_List__c}"/>                                            
                                        </apex:outputPanel>
                                        <!-- 11/15/19
                                         <apex:outputPanel rendered="{!quote.Multi_Year_Quote__c && burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && !burstProduct.Hardware_or_Third_Party__c}">
                                        -->
                                        <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && !burstProduct.Hardware_or_Third_Party__c}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                                Y1 - <apex:outputField value="{!burstProduct.Ext_List_Price_1__c}"/> <br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 - <apex:outputField value="{!burstProduct.Ext_List_Price_2__c}" />  
                                            </apex:outputPanel>                                          
                                        </apex:outputPanel>                                        
                                    </td>
                                </apex:outputPanel>
                                <!-- Discount -->
                                <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                    <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && burstProduct.Bundle__r.Group_Type__c != 'A la Carte'}">
                                        <apex:inputField value="{!burstProduct.Disc__c}" style="width:55px;" rendered="{!IsQuoteUnLocked && burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && NOT(burstProduct.PureBridge_Free_GU__c)}"/>
                                        <apex:outputField value="{!burstProduct.Disc__c}" rendered="{!NOT(IsQuoteUnLocked) || burstProduct.Bundle__r.Group_Type__c == 'PureSuccess' || burstProduct.PureBridge_Free_GU__c}"/>    
                                    </apex:outputPanel>                                        
                             
                                </td>
                                <!-- % / Amt -->
                                <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                    <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && burstProduct.Bundle__r.Group_Type__c != 'A la Carte'}">     
                                    <apex:selectList value="{!burstProduct.or_Amount__c}" size="1" rendered="{!IsQuoteUnLocked}">
                                        <apex:selectOption itemValue="" itemLabel=""/>
                                        <apex:selectOption itemValue="%" itemLabel="%"/>
                                        <apex:selectOption itemValue="Amt" itemLabel="Amt"/>
                                    </apex:selectList>
                                    </apex:outputPanel>
                                    <apex:outputField value="{!burstProduct.or_Amount__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                                </td>
                                <!-- Total Disc % -->
                                <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                    <apex:outputField value="{!burstProduct.Total_Discount__c}" rendered="{!burstProduct.Bundle__r.Group_Type__c != 'PureSuccess'}"/>
                                </td>
                                <!-- Net Unit Price -->
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Net_Unit_Price__c}">
                                    <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                        <!-- 11/15/19
                                            <apex:outputPanel rendered="{!!quote.Multi_Year_Quote__c || burstProduct.Hardware_or_Third_Party__c}"> 
                                        -->
                                        <apex:outputPanel rendered="{!burstProduct.Hardware_or_Third_Party__c}">                                           
                                            <apex:outputText value="{0, number,###,###,##0.00}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2'}">
                                                <apex:param value="{!burstProduct.Net_Unit_Price__c}"/>
                                            </apex:outputText>
                                            <apex:outputText value="{0, number,###,###,##0.0000}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">
                                                <apex:param value="{!burstProduct.Net_Unit_Price__c}"/>
                                            </apex:outputText>
                                            <apex:outputText value="{0, number,###,###,##0.000000}" rendered="{!burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">
                                                <apex:param value="{!burstProduct.Net_Unit_Price__c}"/>
                                            </apex:outputText>
                                        </apex:outputPanel>
                                       <!-- 11/15/19
                                        <apex:outputPanel rendered="{!quote.Multi_Year_Quote__c && burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && !burstProduct.Hardware_or_Third_Party__c && burstProduct.Bundle__r.Group_Type__c != 'Campaigns' && (burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2')}">
                                       --> 
                                        <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && !burstProduct.Hardware_or_Third_Party__c && burstProduct.Bundle__r.Group_Type__c != 'Campaigns' && (burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == null || burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '2')}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                                Y1 - <apex:outputText value="{0, number,###,###,##0.00}"><apex:param value="{!burstProduct.Net_Unit_Price_1__c}"/></apex:outputText> <br/>
                                            </apex:outputPanel>
                                           <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 - <apex:outputText value="{0, number,###,###,##0.00}" ><apex:param value="{!burstProduct.Net_Unit_Price_2__c}"/></apex:outputText>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                        <!-- 11/15/19
                                         <apex:outputPanel rendered="{!quote.Multi_Year_Quote__c && burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && !burstProduct.Hardware_or_Third_Party__c && burstProduct.Bundle__r.Group_Type__c != 'Campaigns' && burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">
                                        -->
                                        <apex:outputPanel rendered="{!quote.Multi_Year_Quote__c && burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && !burstProduct.Hardware_or_Third_Party__c && burstProduct.Bundle__r.Group_Type__c != 'Campaigns' && burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '4'}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                                Y1 - <apex:outputText value="{0, number,###,###,##0.0000}"><apex:param value="{!burstProduct.Net_Unit_Price_1__c}"/></apex:outputText> <br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 - <apex:outputText value="{0, number,###,###,##0.0000}" ><apex:param value="{!burstProduct.Net_Unit_Price_2__c}"/></apex:outputText>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                        <!-- 11/15/19
                                        <apex:outputPanel rendered="{!quote.Multi_Year_Quote__c && burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && !burstProduct.Hardware_or_Third_Party__c && burstProduct.Bundle__r.Group_Type__c != 'Campaigns' && burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">
                                        --> 
                                        <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && !burstProduct.Hardware_or_Third_Party__c && burstProduct.Bundle__r.Group_Type__c != 'Campaigns' && burstProduct.BigMachines__Product__r.Tier_Pricing_Decimal_Precision__c == '6'}">
                                            <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                                Y1 - <apex:outputText value="{0, number,###,###,##0.000000}"><apex:param value="{!burstProduct.Net_Unit_Price_1__c}"/></apex:outputText> <br/>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{!(!oneyear)}">                                                
                                                Y2 - <apex:outputText value="{0, number,###,###,##0.000000}" ><apex:param value="{!burstProduct.Net_Unit_Price_2__c}"/></apex:outputText>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </td>
                                </apex:outputPanel>
                                <!-- Ext Net Price -->
                                <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                <!-- 11/15/19
                                  <apex:outputPanel rendered="{!!quote.Multi_Year_Quote__c || burstProduct.Hardware_or_Third_Party__c}"> 
                                -->
                                    <apex:outputPanel rendered="{!burstProduct.Hardware_or_Third_Party__c}">                                           
                                        <apex:outputField value="{!burstProduct.Ext_Net_Price__c}"/>
                                    </apex:outputPanel>
                                  <!-- 11/15/19
                                    <apex:outputPanel rendered="{!quote.Multi_Year_Quote__c && burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && !burstProduct.Hardware_or_Third_Party__c}">
                                  -->  
                                    <apex:outputPanel rendered="{!burstProduct.Bundle__r.Group_Type__c != 'PureSuccess' && !burstProduct.Hardware_or_Third_Party__c}">
                                        <apex:outputPanel rendered="{!(!secondYrAmend)}">
                                            Y1 - <apex:outputField value="{!burstProduct.Ext_Net_Price_1__c}"/><br/>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!(!oneyear)}">
                                                Y2 - <apex:outputField value="{!burstProduct.Ext_Net_Price_2__c}" />
                                        </apex:outputPanel>
                                    </apex:outputPanel>                                    
                                </td>
                                <!-- 3rd Party GC % -->
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                    <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                        <apex:outputText value="{!IF(OR(burstProduct.Third_Party__c == 'True',burstProduct.Third_Party__c == 'TRUE',burstProduct.Third_Party__c == 'true'),'Yes','No')}"/>
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!blnHasHWLines}">
                                    <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                        <apex:outputField value="{!burstProduct.Third_Party_GC__c}" rendered="{!OR(NOT(quote.X3rd_Party_Override__c), burstProduct.Third_Party_GC__c == NULL) }" />
                                        <apex:inputField value="{!burstProduct.Third_Party_GC__c}" rendered="{!AND(quote.X3rd_Party_Override__c, burstProduct.Third_Party_GC__c != NULL)}" style="width:50px;" />                                        
                                    </td>
                                </apex:outputPanel>
                                <!-- PM Approver -->
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                    <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}">
                                        <apex:outputField value="{!burstProduct.Pm_Approver__c}"
                                            rendered="{!burstProduct.BigMachines__Product__r.Shipment_Approval__c = 'Required for all Orders' ||
                                                burstProduct.BigMachines__Product__r.Shipment_Approval__c = 'Required for New Orders Only'}"/>
                                    </td>
                                </apex:outputPanel>
                                        
                                <!-- Additional cell without column header -->
                                <apex:outputPanel layout="none" rendered="{!(quote.Order_Type__c == 'Amend' && NOT(ISBLANK(quoteBurstTerms.term.CCDB_Subscription_Burst_Term__c)))}">
                                       <apex:variable value="{!burstProduct.Id}" var="uniqueKey"/> 
                                    <td class="dataCell" style="background-color: {!map_ProdChangeHistoryColor[uniqueKey]}">
                                        <i><apex:outputText value="{!map_ProdChangeHistory[uniqueKey]}"/></i>
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!(quote.Order_Type__c == 'Amend' && ISBLANK(quoteBurstTerms.term.CCDB_Subscription_Burst_Term__c))}">
                                    <td class="dataCell" style="background-color:{!burstProduct.Line_Color__c}"/>
                                </apex:outputPanel>
                               <!-- END Additional cell without column header -->
                            </tr>

                            <apex:variable value="{!rowNumLevel1 + 1}" var="rowNumLevel1"/>

                        </apex:outputPanel>
                    </apex:repeat>

                    </apex:repeat>  
                </apex:outputPanel>
    <!-- END: Individual products for Burst -->

     <!--- MS  Credits -->
                <apex:outputPanel layout="none" rendered="{!list_Credits.size > 0}">
                        <tr style="background-color:#F9F5C0">
                            <td colspan="100">
                                 Credits
                            </td>
                        </tr>
                   </apex:outputPanel>
                   <apex:repeat value="{!list_Credits}" var="credit">
                        <apex:outputPanel layout="none" >
                            <tr >
                                <td style="border:0">{!rowNumLevel1}.</td>
                                <td style="border:0"></td>
                                <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                                    <td colspan="2" class="dataCell" style="border:0">
                                        <apex:commandlink action="{!deleteQuoteProduct}" title="Remove Quote Product" onclick="deleteQP('{!$Component.strToDelete}');" rendered="{!credit.Subscription_Product__c == ''}" reRender="QuoteProductsSection,TotalsBlock,msgs" status="status">
                                            <apex:param name="quoteProductIdToBeDeleted" assignTo="{!quoteProductIdToBeDeleted}" value="{!credit.id}" />
                                            <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>   
                                        </apex:commandlink>
                                    </td>
                                </apex:outputPanel>
                         
                                <td colspan="2" style="border:0"></td>
                                <td style="border:0">
                                    <apex:outputField value="{!credit.Product_Description__c}"/><br/>
                                </td>
                                <td style="border:0"></td>
                                <td class="dataCell" style="border:0">                                    
                                    <apex:inputField value="{!credit.Quantity__c}" required="false" style="width:45px;" rendered="{!IsQuoteUnLocked }"/>
                                    <apex:outputField value="{!credit.Quantity__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                                </td>
                                <td style="border:0">
                                    <apex:outputText value="{0, number,###,###,##0.00}"><apex:param value="{!credit.List_Price__c}"/></apex:outputText>
                                </td>

                                <apex:outputPanel layout="none" rendered="{!quote.Multi_Year_Quote__c}">  
                                     <td colspan="1" style="border:0" ></td> 
                                 </apex:outputPanel> 

                                <td colspan="5" style="border:0" ></td>                                 
                           
                                 <td style="border:0">
                                    <apex:outputText value="{0, number,###,###,##0.00}"><apex:param value="{!credit.Ext_Net_Price__c}"/></apex:outputText>
                                 </td>

                                <td class="dataCell"></td> 
                                <!-- History cell -->
                                <apex:outputPanel layout="none" rendered="{!quote.Order_Type__c == 'Amend' }"> 
                                    <td colspan="1" style="border:0" ></td>                               
                                    <apex:variable value="{!credit.Id}" var="uniqueKey"/>                            
                                    <td class="dataCell" style="background-color: {!map_ProdChangeHistoryColor[uniqueKey]}">
                                        <i><apex:outputText value="{!map_ProdChangeHistory[uniqueKey]}"/></i>
                                    </td>
                                </apex:outputPanel>                                       
                            </tr>
                            <apex:variable value="{!rowNumLevel1 + 1}" var="rowNumLevel1"/>
                         </apex:outputPanel>
                </apex:repeat>  
                                  
       <!--  MS END Credits -->
                
                <!-- Migration Credit Header
                    <apex:outputPanel layout="none" rendered="{!objMigrationCreditY1 != null && objMigrationCreditY2 != null}">
                        <tr style="background-color:#F8DE7E">
                            <td colspan="100">
                                Migration Credit
                            </td>
                        </tr>
                    </apex:outputPanel>
                Migration Credit Header -->
                    <!-- Migration Credit Row 1 
                        <apex:outputPanel layout="none" rendered="{!objMigrationCreditY1 != null}">
                            <tr style="background-color:rgba(212, 212, 207, 0.50)">
                                <td colspan="2">&nbsp;</td>
                                <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                                    <td colspan="2" class="dataCell">
                                        <apex:commandlink action="{!deleteQuoteProduct}" title="Remove Quote Product" onclick="deleteQP('{!$Component.strToDelete}');" reRender="QuoteProductsSection,msgs" status="status">
                                            <apex:param name="quoteProductIdToBeDeleted" assignTo="{!quoteProductIdToBeDeleted}" value="{!objMigrationCreditY1.id}" />
                                            <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>   
                                        </apex:commandlink>
                                    </td>
                                </apex:outputPanel>
                                <td></td>
                                <td colspan="{!1 + IF(objColumnPreference.Building_Block__c,1,0)}">
                                    <apex:outputField value="{!objMigrationCreditY1.Product_Description__c}"/><br/>
                                    (<apex:outputField value="{!objMigrationCreditY1.BigMachines__Product__r.Name}" />)
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                    <td>
                                        <apex:outputField value="{!objMigrationCreditY1.Unit_of_Measure__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <td colspan="{!3 + IF(blnHasBundles,1,0) + IF(objColumnPreference.List_Price__c,1,0) + IF(objColumnPreference.Ext_List_Price__c,1,0) +
                                        IF(objColumnPreference.Product_Specific_Discount__c,1,0) + IF(objColumnPreference.Net_Unit_Price__c,1,0)}">&nbsp;</td>
                                <td>
                                    <apex:outputField value="{!objMigrationCreditY1.Ext_Net_Price__c}"/>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                    <td>
                                        <apex:outputText value="{!IF(objMigrationCreditY1.Third_Party__c == 'TRUE','Yes','No')}"/>
                            
                                    </td>
                                </apex:outputPanel>
                                
                                    <td>&nbsp;</td>
                                
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                    
                                </apex:outputPanel>
                            </tr>
                        </apex:outputPanel>
                    Migration Credit Row 1 -->
                    <!-- Migration Credit Row 2 
                        <apex:outputPanel layout="none" rendered="{!objMigrationCreditY2 != null && !oneyear}">
                            <tr style="background-color:rgba(212, 212, 207, 0.50)">
                                <td colspan="2">&nbsp;</td>
                                <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                                    <td colspan="2" class="dataCell">
                                        <apex:commandlink action="{!deleteQuoteProduct}" title="Remove Quote Product" onclick="deleteQP('{!$Component.strToDelete}');" reRender="QuoteProductsSection,TotalsBlock,msgs" status="status">
                                            <apex:param name="quoteProductIdToBeDeleted" assignTo="{!quoteProductIdToBeDeleted}" value="{!objMigrationCreditY2.id}" />
                                            <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>   
                                        </apex:commandlink>
                                    </td>
                                </apex:outputPanel>
                                <td></td>
                                <td colspan="{!1 + IF(objColumnPreference.Building_Block__c,1,0)}">
                                    <apex:outputField value="{!objMigrationCreditY2.Product_Description__c}"/><br/>
                                    (<apex:outputField value="{!objMigrationCreditY2.BigMachines__Product__r.Name}" />)
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                    <td>
                                        <apex:outputField value="{!objMigrationCreditY2.Unit_of_Measure__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <td colspan="{!3 + IF(blnHasBundles,1,0) + IF(objColumnPreference.List_Price__c,1,0) + IF(objColumnPreference.Ext_List_Price__c,1,0) +
                                        IF(objColumnPreference.Product_Specific_Discount__c,1,0) + IF(objColumnPreference.Net_Unit_Price__c,1,0)}">&nbsp;</td>
                                <td>
                                    <apex:outputField value="{!objMigrationCreditY2.Ext_Net_Price__c}"/>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                    <td>
                                        <apex:outputText value="{!IF(objMigrationCreditY2.Third_Party__c == 'TRUE','Yes','No')}"/>
                            
                                    </td>
                                </apex:outputPanel>
                                    <td>&nbsp;</td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                
                                </apex:outputPanel>
                            </tr>
                        </apex:outputPanel>
             Migration Credit Row 2 -->

                    <apex:outputPanel layout="none" rendered="{!quote.Show_Why_Genesys__c || NOT(ISBLANK(objThirdPartyGCLine))}">
                        <tr style="background-color:#F8DE7E">
                            <td colspan="100">
                                Genesys Care
                            </td>
                        </tr>
                    </apex:outputPanel>
                    <!-- Service Level Row -->
                        <apex:outputPanel layout="none" rendered="{!quote.Show_Why_Genesys__c}">
                            <tr style="background-color:rgba(212, 212, 207, 0.50)">
                                <td colspan="2">&nbsp;</td>
                                <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                                        <td colspan="2" class="dataCell">
                                          <!-- MS removed on 11/13/2019
                                            <apex:commandlink action="{!deleteQuoteProduct}" title="Remove Quote Product" onclick="deleteQP('{!$Component.strToDelete}');" reRender="QuoteProductsSection,msgs" status="status">
                                                <apex:param name="quoteProductIdToBeDeleted" assignTo="{!quoteProductIdToBeDeleted}" value="{!objServiceLevel.id}" />
                                                <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>   
                                            </apex:commandlink>
                                        -->
                                        </td>
                                </apex:outputPanel>
                                <td></td>
                                <td colspan="{!3 + IF(objColumnPreference.Building_Block__c,1,0)}">
                                    <apex:outputField value="{!objServiceLevel.Product_Description__c}"/><br/>
                                    (<apex:outputField value="{!objServiceLevel.BigMachines__Product__r.Name}" />)
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                    <td>
                                        <apex:outputField value="{!objServiceLevel.Unit_of_Measure__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <td colspan="{!2 + IF(blnHasBundles,1,0) + IF(objColumnPreference.List_Price__c,1,0) + IF(objColumnPreference.Ext_List_Price__c,1,0) +
                                        IF(objColumnPreference.Product_Specific_Discount__c,1,0) + IF(objColumnPreference.Net_Unit_Price__c,1,0)}">&nbsp;</td>
                                <td>
                                    <apex:outputField value="{!objServiceLevel.Ext_Net_Price__c}"/>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                    <td>
                                        <apex:outputText value="{!IF(objServiceLevel.Third_Party__c == 'TRUE','Yes','No')}"/>
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!blnHasHWLines}">
                                    <td>&nbsp;</td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                    <td>
                                        <apex:outputField value="{!objServiceLevel.Pm_Approver__c}"
                                            rendered="{!objServiceLevel.BigMachines__Product__r.Shipment_Approval__c = 'Required for all Orders' ||
                                                objServiceLevel.BigMachines__Product__r.Shipment_Approval__c = 'Required for New Orders Only'}"/>
                                    </td>
                                </apex:outputPanel>
                            </tr>
                        </apex:outputPanel>

                        <!-- Third Party GC Line Row -->
                        <apex:outputPanel layout="none" rendered="{!NOT(ISBLANK(objThirdPartyGCLine))}">
                            <tr style="background-color:rgba(212, 212, 207, 0.50)">
                                <td colspan="2">&nbsp;</td>
                                <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                                    <td colspan="2" class="dataCell">
                                        <apex:commandlink action="{!deleteQuoteProduct}" title="Remove Quote Product" onclick="deleteQP('{!$Component.strToDelete}');" reRender="QuoteProductsSection,msgs" status="status">
                                            <apex:param name="quoteProductIdToBeDeleted" assignTo="{!quoteProductIdToBeDeleted}" value="{!objThirdPartyGCLine.id}" />
                                            <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>
                                        </apex:commandlink>
                                    </td>
                                </apex:outputPanel>
                                <td></td>
                                <td colspan="{!3 + IF(objColumnPreference.Building_Block__c,1,0)}">
                                    <apex:outputField value="{!objThirdPartyGCLine.Product_Description__c}"/><br/>
                                    (<apex:outputField value="{!objThirdPartyGCLine.BigMachines__Product__r.Name}" />)
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                    <td>
                                        <apex:outputField value="{!objThirdPartyGCLine.Unit_of_Measure__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <td colspan="{!2 + IF(objColumnPreference.List_Price__c,1,0) + IF(objColumnPreference.Ext_List_Price__c,1,0) +
                                        IF(objColumnPreference.Product_Specific_Discount__c,1,0) + IF(objColumnPreference.Net_Unit_Price__c,1,0)}">&nbsp;</td>
                                <td>
                                    <apex:outputField value="{!objThirdPartyGCLine.Ext_Net_Price__c}"/>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                    <td>
                                        <apex:outputText value="{!IF(objThirdPartyGCLine.Third_Party__c == 'TRUE','Yes','No')}"/>
                    
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!blnHasHWLines}">
                                    <td>&nbsp;</td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                    <td>
                                        <apex:outputField value="{!objThirdPartyGCLine.Pm_Approver__c}"
                                                          rendered="{!objThirdPartyGCLine.BigMachines__Product__r.Shipment_Approval__c = 'Required for all Orders' ||
                                                                  objThirdPartyGCLine.BigMachines__Product__r.Shipment_Approval__c = 'Required for New Orders Only'}"/>
                                    </td>
                                </apex:outputPanel>
                            </tr>
                        </apex:outputPanel>
                    </tbody>
                </table>
                <br/>
                <!--Removed Products MS removed until implemented 
                <apex:pageBlockSection id="removedProds" columns="1" title="Removed Products (From Original Subscription)" rendered="{!(quote.Order_Type__c == 'Amend' || quote.Order_Type__c == 'Subscription') }">  
                    <table class="list " border="0" cellpadding="0" cellspacing="0" id="quoteRemovProdGrid">
                        <thead>
                            <tr class="headerRow">
                                <th class="headerRow" style="width: 15px;"></th>
                                <th class="headerRow" style="width: 80px;">Group</th>
                                <th class="headerRow" style="width: 200px;">Product</th> 
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Sub_Category__c}">
                                    <th class="headerRow" style="width: 150px;">Sub Category</th>
                                </apex:outputPanel>                                
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                    <th class="headerRow" style="width: 100px;">Unit of<br/>measure</th>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!quote.Offering_Type__c != 'PureCloud'}">
                                    <th class="headerRow" style="width: 50px;">Concurrent</th>
                                </apex:outputPanel>
                                <th class="headerRow" style="width: 70px;">Qty</th>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.List_Price__c}">
                                    <th class="headerRow" style="width: 100px;">List Price</th>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Ext_List_Price__c}">
                                    <th class="headerRow" style="width: 100px;">Ext List<br/>Price</th>
                                </apex:outputPanel>
                                <th class="headerRow" style="width: 70px;">Discount</th>                            
                                <th class="headerRow" style="width: 80px;">Total<br/>Disc %</th>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Net_Unit_Price__c}">
                                    <th class="headerRow" style="width: 100px;">Net Unit<br/>Price</th>
                                </apex:outputPanel>
                                <th class="headerRow" style="width: 100px;">Ext Net<br/>Price</th>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                    <th class="headerRow" style="width: 50px;">3rd<br/>Party</th>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                    <th class="headerRow" style="width: 50px;">PM<br/>Approver</th>
                                </apex:outputPanel>
                                <th class="headerRow" style="width: 80px;">Change<br/>History</th>
                            </tr>
                        </thead>
                        <tbody>
                            <apex:variable value="{!0}" var="removProdCount"/>
                            <apex:repeat value="{!list_RemovedPrevProds}" var="removProd">
                                <apex:variable value="{!removProdCount + 1}" var="removProdCount"/>
                                <tr class="dataRow">                                
                                    <td class="dataCell">{!removProdCount}.</td>
                                    <td class="dataCell">               
                                        <apex:outputField value="{!removProd.Group_Number__c}"/>
                                    </td>
                                    <td class="dataCell">               
                                        <apex:outputField value="{!removProd.Product__r.Name}"/><br/>
                                        <apex:outputText value="{!' (' + removProd.Product__r.APN_Number__c +')'}"/>
                                    </td>
                                    <apex:outputPanel layout="none" rendered="{!objColumnPreference.Sub_Category__c}">
                                        <td class="dataCell">               
                                            <apex:outputField value="{!removProd.Product__r.Sub_Category__c}"/>
                                        </td>
                                    </apex:outputPanel>
                                    <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                        <td class="dataCell">               
                                            <apex:outputField value="{!removProd.Product__r.Unit_of_Measure__c}"/>
                                        </td>
                                    </apex:outputPanel>
                                    <apex:outputPanel layout="none" rendered="{!quote.Offering_Type__c != 'PureCloud'}">
                                        <td class="dataCell">               
                                            <apex:outputField value="{!removProd.Product__r.Is_Concurrent__c}"/>
                                        </td>
                                    </apex:outputPanel>
                                    <td class="dataCell">               
                                        <apex:outputField value="{!removProd.Quantity__c}"/>
                                    </td>
                                    <apex:outputPanel layout="none" rendered="{!objColumnPreference.List_Price__c}">
                                        <td class="dataCell">               
                                            <apex:outputField value="{!removProd.List_Price__c}"/>
                                        </td>
                                    </apex:outputPanel>
                                    <apex:outputPanel layout="none" rendered="{!objColumnPreference.Ext_List_Price__c}">
                                        <td class="dataCell">               
                                            <apex:outputField value="{!removProd.Ext_List__c}"/>
                                        </td>
                                    </apex:outputPanel>
                                    <td class="dataCell">               
                                        <apex:outputField value="{!removProd.Disc__c}"/>
                                    </td>                                    
                                    <td class="dataCell">               
                                        <apex:outputField value="{!removProd.Total_Discount__c}"/>
                                    </td>
                                    <apex:outputPanel layout="none" rendered="{!objColumnPreference.Net_Unit_Price__c}">
                                        <td class="dataCell">               
                                            <apex:outputField value="{!removProd.Net_Unit_Price__c}"/>
                                        </td>
                                    </apex:outputPanel>
                                    <td class="dataCell">              
                                        <apex:outputField value="{!removProd.Ext_Net_Price__c}"/>
                                    </td>
                                    <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                        <td class="dataCell">               
                                            <apex:outputField value="{!removProd.Product__r.Third_Party__c}"/>
                                        </td>
                                    </apex:outputPanel>
                                    <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                        <td class="dataCell">              
                                            <apex:outputField value="{!removProd.PM_Approver__c}"/>
                                        </td>
                                    </apex:outputPanel>
                                    <apex:outputPanel layout="none">
                                    
                                    </apex:outputPanel>
                                    <td class="dataCell" style="background-color: {!strChngeHistColors[4]}"><i>Removed</i></td>
                                    
                                </tr>
                            </apex:repeat>                            
                        </tbody>
                    </table>
                </apex:outputpanel>
                </apex:pageBlockSection>
                                               -  MS END Removed Products -->

                <!-- Pagination Information -->
                <apex:outputPanel layout="none" rendered="{!intTotalNoOfRecords > intPageSize}">
                    <br/>
                    <center>
                        <b>Total Records : {!intTotalNoOfRecords}&nbsp;&nbsp;</b>
                        <apex:commandLink action="{!first}" status="status" reRender="QuoteProductsSection" rendered="{!HasPrevious}" style="text-decoration:none">
                            First
                        </apex:commandLink>
                        <apex:outputText value="First" rendered="{!NOT(HasPrevious)}" style="color:gray"/>
                        &nbsp;
                        <apex:commandLink action="{!previous}" status="status" reRender="QuoteProductsSection" rendered="{!HasPrevious}" style="text-decoration:none">
                            <apex:image url="/img/search_prevarrow.gif" title="Previous" styleClass="prevArrow"/>
                            &nbsp;
                            Previous
                        </apex:commandLink>
                        <apex:outputPanel rendered="{!NOT(HasPrevious)}" style="color:gray">
                            <apex:image url="/img/search_prevarrow_disabled.gif"/>
                            &nbsp;
                            Previous
                        </apex:outputPanel>
                        &nbsp;
                        ({!PageNumStr})
                        &nbsp;
                        <apex:commandLink action="{!next}" status="status" reRender="QuoteProductsSection" rendered="{!HasNext}" style="text-decoration:none">
                            Next
                            &nbsp;
                            <apex:image url="/img/search_nextarrow.gif" title="Next" styleClass="nextArrow"/>
                        </apex:commandLink>
                        <apex:outputPanel rendered="{!NOT(HasNext)}" style="color:gray">
                            Next
                            &nbsp;
                            <apex:image url="/img/search_nextarrow_disabled.gif"/>
                        </apex:outputPanel>
                        &nbsp;
                        <apex:commandLink action="{!last}" status="status" reRender="QuoteProductsSection" title="Last" rendered="{!HasNext}" style="text-decoration:none">
                            Last
                        </apex:commandLink>
                        <apex:outputText value="Last" rendered="{!NOT(HasNext)}" style="color:gray"/>
                    </center>
                </apex:outputPanel>
            <!--</apex:outputPanel>-->
        </apex:outputPanel>
            
            <table width="100%" >
              <tr><td style="text-align:center;" >
                    <apex:commandButton value="Save" action="{!doCalculations}" rendered="{!IsQuoteUnLocked}" />
               </td></tr>
            </table>
        
            <br/>
            <!--<apex:pageBlockSection showHeader="false" columns="2">-->
            <apex:outputPanel layout="none" id="bottomSection">
            <table width="100%">
            <tr>
                <td valign="top" width="50%">
                <apex:outputPanel style="width:45%">
                    <!-- Proposal Groups Table -->
                    <apex:pageBlock title="Proposal Groups" id="QPBlock">
                        <apex:pageBlockButtons location="top">
                            <apex:commandButton value="Modify" action="{!editofProposalGroup}" rendered="{!NOT(blnEditProposalGroup) && IsQuoteUnLocked}" />
                            <apex:commandButton value="Save" action="{!saveProposalGroup}" rendered="{!blnEditProposalGroup}" status="status" />
                            <apex:commandButton value="Cancel" action="{!cancelEditofProposalGroup}" rendered="{!blnEditProposalGroup}"/>
                        </apex:pageBlockButtons>
                        <apex:outputPanel layout="none" rendered="{!NOT(blnEditProposalGroup)}">
                                <b>Ungrouped Items Sub Total : </b>
                                <apex:outputField value="{!objUngrouped.Sub_Total__c}"/>
                                <br/><br/>
                            <apex:variable var="rowNum" value="{!0}"/>
                            <apex:pageBlockTable value="{!list_ProposalGroups}" var="objPG" rendered="{!list_ProposalGroups.size > 0}">
                                <apex:column >
                                    <apex:facet name="header">
                                        Group<br/>Number
                                    </apex:facet>
                                    <apex:outputText value="{!objPG.Group_Number__c}"/>
                                </apex:column>
                                <apex:column value="{!objPG.Name__c}"/>
                                <apex:column value="{!objPG.Description__c}"/>
                                <apex:column value="{!objPG.Discount__c}"/>
                                <apex:column value="{!objPG.Sub_Total__c}"/>
    
                            </apex:pageBlockTable>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!blnEditProposalGroup}" id="PGEditPanel">
                            <apex:pageMessage severity="error" strength="1" rendered="{!blnHasProposalGroupErrors}">
                                {!strProposalGroupErrorMsg}
                            </apex:pageMessage>
                            <apex:variable var="rowNum" value="{!0}"/>
                            <apex:pageBlockTable value="{!list_ProposalGroupsBeingEdited}" var="objPG">
                                <apex:column headerValue="Action">
                                    <apex:commandlink action="{!removeProposalGroup}" rerender="PGEditPanel" title="Remove Proposal Group" status="status">
                                        <apex:param name="strPGIndex" assignTo="{!strPGIndex}" value="{!rowNum}" />
                                        <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>    
                                    </apex:commandlink>
                                    <apex:variable var="rowNum" value="{!rowNum + 1}"/>
                                </apex:column>
                                <apex:column headerValue="Name">
                                    <apex:inputField value="{!objPG.Name__c}"/>
                                </apex:column>
                                <apex:column headerValue="Description">
                                    <apex:inputField value="{!objPG.Description__c}" style="width:200px;"/>
                                </apex:column>
                                <apex:column headerValue="Discount %">
                                    <apex:inputField value="{!objPG.Discount__c}"/>
                                </apex:column>
                            </apex:pageBlockTable>
                            <br/>
                            <apex:commandLink action="{!addProposalGroup}" reRender="PGEditPanel" title="Add Proposal Group" status="status">
                                <apex:image value="{!$Resource.PlusSign}" width="25px" height="25px"/>
                            </apex:commandLink>
                        </apex:outputPanel>
                    </apex:pageBlock>  
                    <br/>

        <!-- Migration Credit   -->                 
                    <apex:panelGrid columns="{!IF(IsQuoteUnLocked,'3','2')}" rendered="{!quote.Order_Type__c == 'Migration' && (blnIsDealFactoryUser || $Profile.Name == 'Data Administrator' || $Profile.Name == 'System Administrator')}">                                                                                                                                                                                                
                        <apex:outputText value="Migration Credit : " style="font-weight:bold"/>                                      
                        <apex:inputField value="{!quote.Migration_Credit__c}" rendered="{!IsQuoteUnLocked}"/>
                        <apex:outputField value="{!quote.Migration_Credit__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                        <apex:panelGroup rendered="{!IsQuoteUnLocked}">
                            <apex:commandButton value="Apply Migration Credit" action="{!migrationCreditBtnHandler}"/>&nbsp;&nbsp;
                            <apex:commandButton value="Reset Migration Credit" action="{!migrationCreditResetBtnHandler}"/>
                        </apex:panelGroup>
                    </apex:panelGrid>
                    <apex:panelGrid columns="{!IF(IsQuoteUnLocked,'3','2')}" rendered="{!quote.Order_Type__c == 'Migration' && NOT(blnIsDealFactoryUser) && $Profile.Name != 'Data Administrator' && $Profile.Name != 'System Administrator'}">
                        <apex:outputText value="Migration Adjustment : " style="font-weight:bold"/>
                        <apex:outputField value="{!quote.Migration_Credit__c}" />
                    </apex:panelGrid>
      <!--  -->
                </apex:outputPanel>                
                </td>

                <td valign="top" width="50%">
                <!-- Totals Table -->
                <apex:pageBlock title="Totals" id="TotalsBlock">
                    <apex:outputPanel >
                        <table class="list " border="0" cellpadding="0" cellspacing="0">                        
                            <tr class="headerRow">
                              <th class="headerRow">Category</th>
                                <th class="headerRow" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                  Totals
                                  <span style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                    (Change)
                                  </span> 
                                </th>
                                <th class="headerRow" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">Totals <br/>(Running Total)</th>                                   
                            </tr>                        
                            <tr class="dataRow">
                                <th class="dataCell">Discount %</th>
                                <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                    <b>
                                    <apex:outputField value="{!quote.Total_Discount_Genesys_and_Third_Party__c}"/>
                                    </b>
                                </td>
                                <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                    <b>                                        
                                    <apex:outputText value="{!quote.currencyIsoCode} {0,number,0.00}%">
                                        <apex:param value="{!decHighestDiscount}" />
                                    </apex:outputText>
                                    </b>
                                </td>                                
                            </tr>
                            <!-- Burst Discount -->
                            <apex:outputPanel rendered="{!list_QuoteBurstTerms.size > 0}" > 
                                <tr class="dataRow">
                                    <th class="dataCell">Seasonal License Discount % </th>
                                    <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                        <b>
                                        <apex:outputField value="{!quote.Overage_Discount__c}"/>
                                        </b>
                                    </td>
                                    <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}"> <!-- TODO -->
                                        <b>                                        
                                        <apex:outputText value="{!quote.currencyIsoCode} {0,number,0.00}%">
                                            <apex:param value="{!decHighestDiscount}" />
                                        </apex:outputText>
                                        </b>
                                    </td>                                
                                </tr>
                            </apex:outputPanel>
                            <!-- Annual Amounts -->
                            <tr class="dataRow">
                                <th class="dataCell">Year 1 Annual Subscription Amount</th>
                                <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                    <b>
                                    <apex:outputField value="{!quote.Annual_Contract_Value_1__c}"/>
                                    </b>
                                </td>
                                <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                    <b>
                                        <apex:outputText value="{!quote.currencyIsoCode} {0,number,###,##0.00}">
                                            <apex:param value="{!decY1AnnualSubscriptionAmount}" />
                                        </apex:outputText>
                                    </b>
                                </td>                                
                            </tr>
                            <!-- Seasonal Amount Year 1-->
                            <apex:outputPanel rendered="{!list_QuoteBurstTerms.size > 0}" > 
                                <tr class="dataRow">
                                        <th class="dataCell">Year 1 Committed Seasonal License Amount</th>
                                        <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                            <b>
                                            <apex:outputField value="{!quote.Seasonal_License_Net_Value_Y1__c}"/> 
                                            </b>
                                        </td>
                                        <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                            <b>
                                                <apex:outputText value="{!quote.currencyIsoCode} {0,number,###,##0.00}">
                                                    <apex:param value="{!decY1SeasonalLicenseAmount}" /> 
                                                </apex:outputText>
                                            </b>
                                        </td>                           
                                </tr>
                            </apex:outputPanel>
                            <!-- Credits -->
                            <apex:outputPanel rendered="{!AND(quote.Pre_Credit_ACV__c != null && quote.Pre_Credit_ACV__c != 0 && !secondYrAmend)}" id="crd"> 
                                <tr class="dataRow" style="background-color:#E9F9C0">
                                    <th class="dataCell">Pre-Credit Year 1 Subscription Amount</th>                               
                                    <td class="dataCell">
                                        <b>
                                        <apex:outputText value="{!quote.currencyIsoCode} {0,number,###,##0.00}">
                                                <apex:param value="{!quote.Pre_Credit_ACV__c}" />
                                            </apex:outputText>
                                        </b>
                                    </td>                                       
                                </tr>
                            </apex:outputPanel>
                   <!--     -->
                            <apex:outputPanel rendered="{!NOT(isSmallMediumCenter)}">
                            <tr class="dataRow">
                                <th class="dataCell">PureSuccess Offer Subscription Amount</th>
                                <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                    <b>
                                    <apex:outputField value="{!quote.PureSuccess_Offer_Subscription_Amount__c}" rendered="{!NOT(quote.Show_Why_Genesys__c)}"/>
                                    <apex:outputText value="N/A" rendered="{!quote.Show_Why_Genesys__c}"/>
                                    </b>
                                </td>
                                <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                    <b>
                                    <apex:outputText value="{!quote.currencyIsoCode} {0,number,###,##0.00}" rendered="{!NOT(quote.Show_Why_Genesys__c)}">
                                        <apex:param value="{!decPureSuccessOfferSubscriptionAmount}" />
                                    </apex:outputText>
                                    <apex:outputText value="N/A" rendered="{!quote.Show_Why_Genesys__c}"/>
                                    </b>
                                </td>                                
                            </tr>
                            <tr class="dataRow">
                                <th class="dataCell">A La Carte PureSuccess Services Amount</th>
                                <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                    <b>
                                    <apex:outputField value="{!quote.A_La_Carte_PureSuccess_Services_Amount__c}"/>
                                    </b>
                                </td>
                                <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                    <b>
                                        <apex:outputText value="{!quote.currencyIsoCode} {0,number,###,##0.00}">
                                            <apex:param value="{!decALaCartePureSuccessServiceAmount}" />
                                        </apex:outputText>
                                    </b>
                                </td>                                
                            </tr>
                        </apex:outputPanel>
                            <tr class="dataRow">
                                <th class="dataCell">Non-Recurring Fees</th>
                                <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                    <b>
                                    <apex:outputField value="{!quote.One_Time_Charges_1__c}"/>
                                    </b>
                                </td>
                                <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                    <b>
                                        <apex:outputText value="{!quote.currencyIsoCode} {0,number,0.00}">
                                            <apex:param value="{!decNonRecurringFee}" />
                                        </apex:outputText>
                                    </b>
                                </td>                                
                            </tr>                 
                            <tr class="dataRow">
                                <th class="dataCell">3rd party Care</th>
                                <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                    <b>
                                    <apex:outputField value="{!quote.BEP_Third_Party_Genesys_Care__c}"/>
                                    </b>
                                </td>
                                <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                    <b>
                                        <apex:outputText value="{!quote.currencyIsoCode} {0,number,###,##0.00}">
                                            <apex:param value="{!decThirdPartyCare}" />
                                        </apex:outputText>
                                    </b>
                                </td>                                
                            </tr>
                            <tr class="dataRow">
                                <th class="dataCell">Amount Due at Initial Invoice</th>
                                <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                    <b>
                                    <apex:outputField value="{!quote.Total_Contract_Value_1__c}"/>
                                    </b>
                                </td>
                                <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                    <b>
                                        <apex:outputText value="{!quote.currencyIsoCode} {0,number,###,##0.00}">
                                            <apex:param value="{!decAmountDueAtInitialInvoice}" />
                                        </apex:outputText>
                                    </b>
                                </td>                                
                            </tr> 
                            <apex:outputPanel rendered="{!(!oneyear)}">             
                                <tr class="dataRow">
                                    <th class="dataCell">Year 2 Annual Subscription Amount</th>
                                    <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                        <b>
                                        <apex:outputField value="{!quote.Annual_Contract_Value_2__c}"/>
                                        </b>
                                    </td>
                                    <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                        <b>
                                            <apex:outputText value="{!quote.currencyIsoCode} {0,number,###,##0.00}">
                                                <apex:param value="{!decY2AnnualSubscriptionAmount}" />
                                            </apex:outputText>
                                        </b>
                                    </td>                                
                                </tr>  
                                  <!-- Seasonal Amount Year 2 -->
                               <apex:outputPanel rendered="{!list_QuoteBurstTerms.size > 0}" > 
                                    <tr class="dataRow">
                                            <th class="dataCell">Year 2 Committed Seasonal License Amount</th>
                                            <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                                <b>
                                                <apex:outputField value="{!quote.Seasonal_License_Net_Value_Y2__c}"/> 
                                                </b>
                                            </td>
                                            <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                                <b>
                                                    <apex:outputText value="{!quote.currencyIsoCode} {0,number,###,##0.00}">
                                                        <apex:param value="{!decY2SeasonalLicenseAmount}" /> 
                                                    </apex:outputText>
                                                </b>
                                            </td>                           
                                    </tr>
                                </apex:outputPanel> 
                                <apex:outputPanel rendered="{!(!secondYrAmend)}">                       
                                    <tr class="dataRow">
                                        <th class="dataCell">Amount Due at Anniversary</th>
                                        <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                            <b>
                                            <apex:outputField value="{!quote.Amount_Due_At_Anniversary__c}"/>
                                            </b>
                                        </td>
                                        <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                            <b>
                                                <apex:outputText value="{!quote.currencyIsoCode} {0,number,###,##0.00}">
                                                    <apex:param value="{!decAmountDueAtAnniversary}" />
                                                </apex:outputText>
                                            </b>
                                        </td>                                
                                    </tr>
                                 </apex:outputPanel>
                           </apex:outputPanel>   

                            <apex:outputPanel rendered="{!(NOT(quote.Show_Why_Genesys__c) && NOT(isSmallMediumCenter))}">
                                <tr class="dataRow">
                                    <th class="dataCell">Total Available Tokens</th>
                                    <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                        <b>
                                        <apex:outputField value="{!quote.Token_Value__c}"/>
                                        </b>
                                    </td>
                                    <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                        <b>
                                        <apex:outputField value="{!quote.Amendment_For__r.Quote__r.Token_Value__c}"/>
                                        </b>
                                    </td>                                    
                                </tr>
                            </apex:outputPanel>
                            <tr class="dataRow">
                                <th class="dataCell">Total Commitment</th>                                
                                <td class="dataCell" style="background-color:{!IF(quote.Amendment_For__c == null, '', '#aafc8a')};">
                                    <b>
                                    <apex:outputField value="{!quote.Cloud_Total__c}"/>
                                    </b>
                                </td>
                                <td class="dataCell" style="display:{!IF(quote.Amendment_For__c == null, 'none', 'block')}">
                                    <b>
                                        <apex:outputText value="{!quote.currencyIsoCode} {0,number,###,##0.00}">
                                            <apex:param value="{!decTotalCommitment}" />
                                        </apex:outputText>
                                    </b>
                                </td>                            
                            </tr>
            <!-- MS Credits 
                         <apex:outputPanel rendered="{!totalCredit > 0}" >                         
                            <tr class="dataRow" style="background-color:#E9F9C0">
                               <th class="dataCell">Credit Amount</th>                                
                                <td class="dataCell">
                                    <b>
                                    <apex:outputText value="{!totalCredit}"/>
                                    </b>
                                </td>                                       
                            </tr>
                        </apex:outputPanel>
             Credits End -->
                         <apex:outputPanel rendered="{!AND(quote.Pre_Credit_TCV__c != null && quote.Pre_Credit_TCV__c != 0)}" >                         
                            <tr class="dataRow" style="background-color:#E9F9C0">
                               <th class="dataCell">Total Commitment Before Credit</th>                                
                                <td class="dataCell">
                                    <b>
                                    <apex:outputField value="{!quote.Pre_Credit_TCV__c}"/>
                                    </b>
                                </td>                                       
                            </tr>
                        </apex:outputPanel>
           
                        </table>
                       </apex:outputPanel>
                       <!--
                       <apex:outputPanel rendered="{!NOT(quote.Multi_Year_Quote__c)}">
                        <table class="list " border="0" cellpadding="0" cellspacing="0">    
                             <tr class="headerRow">
                              <th class="headerRow"></th>
                              <th class="headerRow">Amount</th>
                            </tr>                       
                            <tr class="dataRow" >
                                <th class="dataCell">Commited Monthly Recurring Revenue (CMRR)</th>
                                <td class="dataCell">
                                    <apex:outputField value="{!quote.CMRR__c}"/>
                                </td>
                            </tr>
                            <tr class="dataRow">
                                <th class="dataCell">Annual Contract Value (ACV)</th>
                                <td class="dataCell">
                                    <apex:outputField value="{!quote.Annual_Contract_Value__c}"/>
                                </td>
                            </tr>
                            <tr class="dataRow" >
                                <th class="dataCell">Total Contract Value (TCV)</th>
                                <td class="dataCell">
                                    <b>
                                    <apex:outputField value="{!quote.Cloud_Total__c}"/>
                                    </b>
                                </td>
                            </tr>                            
                            <tr class="headerRow">
                              <th class="headerRow">Tokens</th>
                              <th class="headerRow"></th>
                            </tr>
                            <tr class="dataRow">
                                <th class="dataCell">Total Available Tokens</th>
                                <td class="dataCell">
                                    <b>
                                    <apex:outputField value="{!quote.Token_Value__c}"/>
                                    </b>
                                </td>
                            </tr>
                           </table>
                       </apex:outputPanel>
                        -->
                </apex:pageBlock>
                </td>
            </tr>
            </table>
            </apex:outputPanel>
            <!--</apex:pageBlockSection>-->
        </apex:pageBlock>
        <apex:outputPanel id="selectColumns">
            <apex:outputPanel styleClass="popupBackground" layout="block" rendered="{!blnShowSelectColumns}"/>
            <apex:outputPanel styleClass="custPopup" layout="block" rendered="{!blnShowSelectColumns}">
                <apex:pageBlock title="Select Columns">
                    <apex:pageBlockButtons location="both">
                        <apex:commandButton value="Save" action="{!saveColumnsHandler}" status="closingStatus" reRender="selectColumns,QuoteProductsSection"/>
                        <apex:commandButton value="Cancel" action="{!cancelColumnsHandler}" status="closingStatus" reRender="selectColumns"/>
                        <apex:actionStatus id="closingStatus">
                            <apex:facet name="start">
                                <apex:image value="/img/loading.gif"/>
                            </apex:facet> 
                        </apex:actionStatus>
                    </apex:pageBlockButtons>
                    <table class="list " border="0" cellpadding="0" cellspacing="0">
                        <tr class="headerRow">
                          <th class="headerRow">Column</th>
                          <th class="headerRow">Show</th>
                        </tr>
                        <tr class="dataRow">
                            <!--<td class="dataCell">Building Block/ Sub Category</td>-->
                            <td class="dataCell">Building Block</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Building_Block__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">Unit of measure</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Unit_of_measure__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">List Price</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.List_Price__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">Partner Price</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Partner_Price__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">Ext List Price</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Ext_List_Price__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">Product Specific Discount</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Product_Specific_Discount__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">Accepted Volume Discount</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Accepted_Volume_Discount__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">Net Unit Price</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Net_Unit_Price__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">3rd Party</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Third_Party__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">PM Approver</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.PM_Approver__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">Gold Tier PPU Price</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.NG1_PPU_Gold_USD__c}"/>
                            </td>
                        </tr>
                    </table>
                </apex:pageBlock>
            </apex:outputPanel>
        </apex:outputPanel>
         <apex:pageBlock title="Genesys Care" rendered="{!strSelectedTab=='Genesys Care'}">
            <apex:pageBlockSection title="Information" columns="2" id="GCSection" collapsible="false">
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="Default Genesys Care Rate"/>
                    <apex:outputField value="{!quote.Genesys_Care_Default_Pricing_Percentage__c}"/>
                </apex:pageBlockSectionItem>

                <apex:inputField value="{!quote.Override_Genesys_Care_Rate__c}" rendered="{!IsQuoteUnLocked}">
                    <apex:actionSupport event="onchange" action="{!assignDefaultGCRate}" rerender="GCSection" status="status"/>
                </apex:inputField>
                <apex:outputField value="{!quote.Override_Genesys_Care_Rate__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>

                <apex:inputField value="{!quote.Genesys_Care_Rate__c}" rendered="{!(quote.Override_Genesys_Care_Rate__c ||
                        ISBLANK(quote.Genesys_Care_Default_Pricing_Percentage__c)) && quote.Service_Level__c != 'Decline' && IsQuoteUnLocked}"/>
                <apex:outputField value="{!quote.Genesys_Care_Rate__c}" rendered="{!NOT((quote.Override_Genesys_Care_Rate__c ||
                        ISBLANK(quote.Genesys_Care_Default_Pricing_Percentage__c)) && quote.Service_Level__c != 'Decline' && IsQuoteUnLocked)}"/>

                <apex:inputField value="{!quote.Genesys_Care_Contractual_Rate__c}" rendered="{!IsQuoteUnLocked}">
                    <apex:actionSupport event="onchange" action="{!initializeCareRate}" rerender="GCSection" status="status"/>
                </apex:inputField>
                <apex:outputField value="{!quote.Genesys_Care_Contractual_Rate__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>

                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked}">
                    <apex:outputLabel value="Unit"/>
                    <apex:selectList value="{!quote.Duration_Unit__c}" size="1">
                        <apex:selectOption itemValue="Months" itemLabel="Months"/>
                        <apex:selectOption itemValue="Days" itemLabel="Days"/>
                        <apex:actionSupport event="onchange" rerender="GCSection" status="status"/>
                    </apex:selectList>
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!quote.Duration_Unit__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>

                <apex:inputField value="{!quote.Order_Numb_of_Maint_Days__c}" rendered="{!quote.Duration_Unit__c == 'Days' && IsQuoteUnLocked}"/>
                <apex:inputField value="{!quote.Order_Numb_of_Maint_Months__c}" rendered="{!quote.Duration_Unit__c != 'Days' && IsQuoteUnLocked}"/>
                <apex:outputField value="{!quote.Order_Numb_of_Maint_Days__c}" rendered="{!quote.Duration_Unit__c == 'Days' && NOT(IsQuoteUnLocked)}"/>
                <apex:outputField value="{!quote.Order_Numb_of_Maint_Months__c}" rendered="{!quote.Duration_Unit__c != 'Days' && NOT(IsQuoteUnLocked)}"/>

                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked}">
                    <apex:outputLabel value="Service Level"/>
                    <apex:selectList value="{!quote.Service_Level__c}" size="1">
                        <apex:selectOption itemValue="Business" itemLabel="Business"/>
                        <apex:selectOption itemValue="Premium" itemLabel="Premium"/>
                        <apex:selectOption itemValue="Decline" itemLabel="Decline"/>
                        <apex:actionSupport event="onchange" action="{!initializeCareRate}" rerender="GCSection" status="status"/>
                    </apex:selectList>
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!quote.Service_Level__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                <apex:inputField value="{!quote.X3rd_Party_Override__c}" rendered="{!IsQuoteUnLocked}" />
                <apex:outputField value="{!quote.X3rd_Party_Override__c}" rendered="{!NOT(IsQuoteUnLocked)}" />
                <apex:inputField value="{!quote.Comment__c}"  rendered="{!IsQuoteUnLocked}"/>
                <apex:outputField value="{!quote.Comment__c}"  rendered="{!NOT(IsQuoteUnLocked)}"/>
                <apex:inputField value="{!quote.Require_Separate_Quote_for_Genesys_Care__c}" rendered="{!IsQuoteUnLocked}" />
                <apex:outputField value="{!quote.Require_Separate_Quote_for_Genesys_Care__c}" rendered="{!NOT(IsQuoteUnLocked)}" />
            </apex:pageBlockSection>
        </apex:pageBlock>
        <apex:pageBlock title="DAP Details" rendered="{!strSelectedTab=='DAP Details'}">
            <apex:pageBlockSection columns="2">
                <apex:inputField value="{!quote.Customer_Info__c}" style="width:425px;"/>
                <apex:inputField value="{!quote.Bid_Summary__c}" style="width:425px;"/>
                <apex:inputField value="{!quote.Competitive_Info__c}" style="width:425px;"/>
                <apex:inputField value="{!quote.Explanation_of_price_Discount_request__c}" style="width:425px;"/>
                <apex:inputField value="{!quote.Partner_info__c}" style="width:425px;"/>
                <apex:inputField value="{!quote.Future_Benefits__c}" style="width:425px;"/>
                <apex:inputField value="{!quote.Internal_Notes__c}" style="width:425px;"/>
            </apex:pageBlockSection>
        </apex:pageBlock>
        
        <apex:pageBlock title="Special Offers" rendered="{!strSelectedTab=='Special Offers'}">
            <apex:pageBlockSection columns="1">
                <apex:inputField value="{!quote.Include_Special_Offer_in_Output__c}" rendered="{!IsQuoteUnLocked}" id="includeSpecialOffer"/>
                <apex:outputField value="{!quote.Include_Special_Offer_in_Output__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked}">
                    <apex:outputLabel value="Special Offers/Business Exceptions"/>
                    <apex:inputField value="{!quote.Special_Offer_Terms__c}"/>
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!quote.Special_Offer_Terms__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
            </apex:pageBlockSection>
        </apex:pageBlock>
        
        <apex:outputPanel layout="none" rendered="{!strSelectedTab=='Order Submission'}">
            <apex:pageMessage severity="info" strength="2" rendered="{!NOT(IsOrderInfoAvailable)}">
                Order Submission becomes available once the quote is approved.
            </apex:pageMessage>
            <apex:pageBlock rendered="{!IsOrderInfoAvailable}">
                <apex:pageBlockButtons >                        
                    <apex:commandButton value="Cancel" action="{!cancelBtnHandler}" rendered="{!blnIsReviseOrder}"/>
                </apex:pageBlockButtons>
                <apex:outputPanel style="color:red;font-size:9pt;">
                    <b>A properly formatted Purchase Order from the customer or partner will be required for this order unless an exception form has been filled out and signed by the customer (Link to the exception form). The P.O. must match the order exactly and be fully itemized, or reference the quote number or the order could be rejected.
                    </b><br/><br/>    
                </apex:outputPanel>
                <!-- Edit Mode -->
                <apex:outputPanel layout="none" rendered="{!quote.BigMachines__Status__c = 'Quote Approved' || 
                            quote.Revise_Minor__c || blnIsReviseOrder}">
                    <apex:pageBlockSection title="PO details" collapsible="false" columns="2">
                        <apex:pageBlockSectionItem > 
                            <apex:outputLabel value="PO#"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput" >
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.Order_PO_Number__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Attach PO (if not already attached)"/>
                            <apex:inputFile value="{!objAttachment.body}" filename="{!objAttachment.name}"/>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="PO Date"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput" >
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.Order_PO_Date__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <!--
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="PO for FYM"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput" >
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.PO_for_FYM__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        -->
                        <apex:inputField value="{!quote.Order_Special_Instructions__c}"/>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Ship Software Via"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput" >
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <!--<apex:inputField value="{!quote.Order_Ship_Software_Via__c}"/> -->
                                <apex:selectList value="{!quote.Order_Ship_Software_Via__c}" size="1" >
                                    <apex:selectOption itemLabel="FTP" itemValue="FTP" />
                                    <apex:selectOption itemLabel="Courier" itemValue="Courier" />
                                    <apex:selectOption itemLabel="Pickup" itemValue="Pickup" />
                                    <apex:selectOption itemLabel="No software shipped" itemValue="No software shipped" />
                                
                                </apex:selectList>     
                                
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
<!--                        <apex:inputField value="{!quote.Generate_Revpro_Order__c}"/> -->
                    </apex:pageBlockSection>
                    
                    <apex:pageBlockSection title="Technical Information" collapsible="false" columns="2" rendered="{!quote.Offering_Type__c == 'PureEngage Subscription'}">
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Server OS"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput">
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.Server_OS__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="PBX"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput">
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.PBX__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Database"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput">
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.Database__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="IVR"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput">
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.IVR__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Add Language"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput">
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.Add_Language__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                    </apex:pageBlockSection>
                    
                    <apex:pageBlockSection title="Shipping Details" collapsible="false" columns="2">
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Ship To Name"/>
                            <apex:inputField value="{!quote.Ship_To_Name__c}" required="true"/>                            
                        </apex:pageBlockSectionItem>
                        <!--
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="SAP"/>
                            <apex:outputField value="{!quote.Ship_To_Name__r.SAP_Account_Code__c}"/>                            
                        </apex:pageBlockSectionItem>
                        -->
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Shipping Contact"/>
                            <apex:inputField value="{!quote.Shipping_Contact__c}" required="true"/>                            
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Shipping Contact Phone Number"/>
                            <apex:inputField value="{!quote.Shipping_Contact_Phone_Number__c}" required="true"/>                            
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Shipping Instructions"/>
                            <apex:inputField value="{!quote.Shipping_Instructions__c}"/>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Order Fulfillment Email Receipt"/>
                            <apex:inputField value="{!quote.Order_Fulfillment_Email_Receipt__c}" required="true"/>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Shipping Contact Email"/>
                            <apex:inputField value="{!quote.Shipping_Contact_Email__c}" required="true"/>
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Delivery Method"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput" >
                                <apex:outputPanel styleClass="requiredBlock"/>
                            <!--<apex:inputField value="{!quote.Delivery_Method__c}" required="true" /> -->
                            <apex:selectList value="{!quote.Delivery_Method__c}" size="1" >
                            
                                    <apex:selectOption itemLabel="Electronic" itemValue="Electronic" />
                                    <apex:selectOption itemLabel="Physical" itemValue="Physical" />
                                    <apex:selectOption itemLabel="No Delivery Required" itemValue="No Delivery Required" />
                                    <apex:selectOption itemLabel="Both" itemValue="Both" />
                                
                             </apex:selectList> 
                            </apex:outputPanel>
                            
                            
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Submitted Date"/>
                            <apex:outputField value="{!quote.Order_Date_Submitted__c}"/>
                        </apex:pageBlockSectionItem>                        
                    </apex:pageBlockSection>
                </apex:outputPanel>
                
                <!-- Read Mode -->
                <apex:outputPanel layout="none" rendered="{!NOT(quote.BigMachines__Status__c = 'Quote Approved' || 
                            quote.Revise_Minor__c || blnIsReviseOrder)}">
                    <apex:pageBlockSection title="PO details" collapsible="false" columns="2">
                        <apex:outputField value="{!quote.Order_PO_Number__c}"/>
                        <apex:outputField value="{!quote.Order_PO_Date__c}"/>
                        <apex:outputField value="{!quote.PO_for_FYM__c}"/>
                        <apex:outputField value="{!quote.Order_Special_Instructions__c}"/>
                        <apex:outputField value="{!quote.Order_Payment_Terms__c}"/>
                        <apex:outputField value="{!quote.Order_Ship_Software_Via__c}"/>
                       <!-- <apex:outputField value="{!quote.Generate_Revpro_Order__c}"/> -->
                    </apex:pageBlockSection>
                    <apex:pageBlockSection title="Technical Information" collapsible="false" columns="2">
                        <apex:outputField value="{!quote.Server_OS__c}"/>
                        <apex:outputField value="{!quote.PBX__c}"/>
                        <apex:outputField value="{!quote.Database__c}"/>
                        <apex:outputField value="{!quote.IVR__c}"/>
                        <apex:outputField value="{!quote.Add_Language__c}"/>
                    </apex:pageBlockSection>
                    <apex:pageBlockSection title="Shipping Details" collapsible="false" columns="2">
                        <apex:outputField value="{!quote.Ship_To_Name__c}"/>                            
                        <apex:outputField value="{!quote.Ship_To_Name__r.SAP_Account_Code__c}"/>                            
                        <apex:outputField value="{!quote.Shipping_Contact__c}"/>                            
                        <apex:outputField value="{!quote.Shipping_Contact_Phone_Number__c}"/>                            
                        <apex:outputField value="{!quote.Shipping_Instructions__c}"/>                            
                        <apex:outputField value="{!quote.Delivery_Method__c}"/>
                        <apex:outputText value="{!quote.Order_Date_Submitted__c}"/>                                                
                    </apex:pageBlockSection>
                </apex:outputPanel>
            </apex:pageBlock>
        </apex:outputPanel>        
    </apex:form>    
    <apex:include pageName="OrderAddressOnPremise" rendered="{!strSelectedTab=='Order Submission'}"/>  
    <apex:include pageName="CreateOrderMultipleShip" rendered="{!AND(quote.Offering_Type__c == 'PureConnect Subscription',strSelectedTab=='Order Submission', quote.Shipping_Required__c)}"/>
    <div style="height:15px;">
        <apex:actionStatus id="status">
            <apex:facet name="start">    
            <apex:outputPanel id="popPanel">
                <apex:outputPanel styleClass="popupBackground" layout="block"/>
                <apex:outputPanel styleClass="custPopup" layout="block">
                    <apex:outputPanel layout="block" style="text-align:center;">
                        Please wait ... &nbsp; <apex:image value="/img/loading.gif"/>
                    </apex:outputPanel>
                </apex:outputPanel>
            </apex:outputPanel>
            </apex:facet>                           
        </apex:actionStatus>
    </div>
    <apex:form >
    <apex:outputPanel id="revisePopup">
        <apex:outputPanel id="revisePopPanel" rendered="{!showReviseDQPopup}">
            <apex:outputPanel styleClass="popupBackground" layout="block"/>
            <apex:outputPanel styleClass="custPopup" layout="block">
                <apex:outputPanel layout="block" style="text-align:center;">
                    <apex:pageBlock title="Revise?">
                        <apex:pageBlockButtons location="bottom">
                            <apex:commandButton value="Revise" onclick="synchAndGoAndReviseDQAF(); return false;" />
                            <apex:commandButton value="Cancel" onclick="hideReviseVisibilityAF(); return false;" />
                        </apex:pageBlockButtons>
                        <apex:pageBlockSection columns="1">
                            <b>
                                Deal qualification will be revised, click Ok to revise and go to deal qualification or Cancel.
                            </b>
                        </apex:pageBlockSection>
                    </apex:pageBlock>
                </apex:outputPanel>
            </apex:outputPanel>
        </apex:outputPanel>
    </apex:outputPanel>
    <apex:actionFunction name="showReviseVisibilityAF" action="{!showReviseVisibility}" reRender="revisePopup" status="status" />
    <apex:actionFunction name="hideReviseVisibilityAF" action="{!hideReviseVisibility}" reRender="revisePopup" status="status" />
    </apex:form>
    <script>
        function saveAndReload()
        {
            saveBeforeReload();
            return false;
        }
        function convertToRealQuoteJS()
        {
            convertToRealQuote();
            return false;
        }
        function deleteQP(decisionInputId)
        {
            var r = confirm("Are you sure you want to delete this record ?");
            if(r == true)
            {
                document.getElementById(decisionInputId).value = 'yes';
            }
            else
            {
                document.getElementById(decisionInputId).value = 'no';
            }
        }
    </script>
    
    <apex:outputPanel id="pnlDQJS">
        <script>            
            
            function openDQ(){
                var url = '/apex/DealQualificationSubscription?oppId={!quote.BigMachines__Opportunity__c}&p={!quote.Quote_Opportunity_Type__c}&ot={!quote.Offering_Type__c}&pt={!quote.Quote_Business_Type__c}';
                window.open(url, '_blank');
            }
            function confirmDQRevise(){               
                //location.href = '/apex/DealQualificationPPU?oppId={!quote.BigMachines__Opportunity__c}&p={!quote.Quote_Opportunity_Type__c}&ot={!quote.Offering_Type__c}&pt={!quote.Quote_Business_Type__c}';
                //return;
                //alert('{!dqStatus}');
                
                if('{!dqStatus}' == '' ||'{!dqStatus}' == 'Not Approved' || '{!dqStatus}' == 'In Progress' || '{!dqStatus}' == 'Revision Pending' ){
                    synchAndGoToDQAF();     
                }
                else{                
                    showReviseVisibilityAF();                                       
                }
            }
            function goToDQ(){            
                var url = '/apex/DealQualificationSubscription?oppId={!quote.BigMachines__Opportunity__c}&p={!quote.Quote_Opportunity_Type__c}&ot={!quote.Offering_Type__c}&pt={!quote.Quote_Business_Type__c}';
                window.open(url, '_blank');  
                hideReviseVisibilityAF();        
                location.href='/apex/CreateQuoteSubscription?id={!quote.id}';
            }
            function goToDQAndRevise(){           
                var url = '/apex/DealQualificationSubscription?oppId={!quote.BigMachines__Opportunity__c}&p={!quote.Quote_Opportunity_Type__c}&ot={!quote.Offering_Type__c}&pt={!quote.Quote_Business_Type__c}';
                window.open(url, '_blank');  
                hideReviseVisibilityAF();              
                location.href='/apex/CreateQuoteSubscription?id={!quote.id}';
            }
            if(location.href.indexOf('refreshParent=true') != -1){
                window.opener.location.reload();
                window.parent.focus();
                window.close();
            }   
        </script>
    </apex:outputPanel>
</apex:page>