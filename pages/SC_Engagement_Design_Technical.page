<apex:page controller="DSRDesignTechnicalController"  sidebar="false" docType="html-5.0">

 <apex:form >
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>       
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>      
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"/>           
  <link rel="stylesheet" href="/resources/demos/style.css"/>  

  <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <head>
        <apex:stylesheet value="{!URLFOR($Resource.SLDS, 'assets/styles/salesforce-lightning-design-system-vf.css')}" />
    </head>
  </html>
        <apex:includeScript value="{!$Resource.SharepointIntegration}"/>
        <script>
            var j$ = jQuery.noConflict();
            var sceid = '{!objSCE.Id}';
            
            j$(document).ready(function(){
               j$(".clsBoxClose").click( function() {           
                    unloadPopupBox();
                });
                /*Open link in new tab*/
                j$('.openInPopup a').click(function(event) {
 
                    event.preventDefault();
                    window.open(j$(this).attr('href'));
                });
                 
            });
            
            function ShowCalendar()
            {
               /*Set z-index for Date picker on POP up window*/
                j$('.datePicker').css('z-index', 99999999);
                 j$('.clsActdate').on('click', function (e) {
                    
                    e.preventDefault();
                    j$(this).datepicker('show');
                    j$(this).datepicker('widget').css('z-index', 99999999);
                });
            }
            function loadPopupBox(fType) 
            {  
              j$('.clsMsg').html('');
              // To Load the Popupbox
              //j$('[id$=hdnFileType]').val(fType);
              j$('#popup_box').fadeIn("slow");
              j$('.parentDisable').css('display','block');
              
              j$("#container").css({ // this is just for style
                 "opacity": "0.3" 
              }); 
              //return false;       
            } 
            function unloadPopupBox() 
            {    
             // TO Unload the Popupbox
             j$('#popup_box').fadeOut("slow");
             j$('.parentDisable').css('display','none');
             j$("#container").css({ // this is just for style       
                "opacity": "1.80" 
             });
             return false;
            }
            
            function GetDesc()
            {
                var VisionType = j$('.clsAttachmentType').val();
                //Added by Ashish Goyal (09/20/2018) to resolve None selection issue
                if(VisionType == ''){
                    document.getElementById('urlLinkId').setAttribute('href', '#');
                    document.getElementById('urlLinkId').className = 'disabled';
                    j$('.attachDesc').val('');
                    j$('.attachNote').val('');
                    return;
                }
                
                j$('.clsSpinner').css('display','block');
                
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.DSRDesignTechnicalController.GetDescription}',
                    VisionType, 
                    function(result, event){
                        if (event.status) 
                        {
                            //alert('a');
                            var des = result;
                            //alert(JSON.stringify(des));
                            
                            /********* description field population commented on 27-April-18 shared by Debora Lane ************/
                            //j$('.clsDesc').val(des.Description__c);
                            
                            //j$('.clsAttachment').val(des.FullDescriptionURL__c);
                           
                            //j$('.clsShowURL').attr('href','http://'+des.FullDescriptionURL__c);
                           
                            //j$('.clsShowURL').text(des.FullDescriptionURL__c);
                            //j$('.clsShowURL').attr('target','_blank');
                            j$('.clsNotesAct').val(des.Notes__c);
                            
                            if(des.URLRequired__c)
                            {
                              j$('.clsAttachment').css('border-left','2px solid red');
                              j$('[id$=hdnUrlReq]').val('YES');
                            }
                            else
                            {
                              j$('[id$=hdnUrlReq]').val('NO');
                              j$('.clsAttachment').css('border-left','none');
                            }
                            var prefix = des.FullDescriptionURL__c;
                            if(prefix != null){
                                if(!prefix.includes('http://') && !prefix.includes('https://')){
                                    prefix = 'http://'+ des.FullDescriptionURL__c;
                                }
                                document.getElementById('urlLinkId').setAttribute('href', prefix);
                                document.getElementById('urlLinkId').className = '';
                            }else{
                                document.getElementById('urlLinkId').setAttribute('href', '#');
                                document.getElementById('urlLinkId').className = 'disabled';
                            }
                            j$('.attachDesc').val(des.Description__c);
                            j$('.attachNote').val(des.Notes__c);
                            
                            j$('.clsSpinner').css('display','none');

                        } else if (event.type === 'exception') {
                            document.getElementById("responseErrors").innerHTML = 
                                event.message + "<br/>\n<pre>" + event.where + "</pre>";
                        } else {
                            document.getElementById("responseErrors").innerHTML = event.message;
                        }
                    }, 
                    {escape: true}
                );
            }
            
            function GetGategoryDetails()
            {
                var ShortCode = j$('.clsShortCode').val();
                var offeringType = '{!objSCE.OfferingPlatformType__c}'; // Added by Priyank as discussed with JJ, to pass the offering type in the remoting.
                //Added by Ashish Goyal (09/20/2018) to resolve None selection issue
                if(ShortCode == ''){
                    document.getElementById('urlLinkId2').setAttribute('href', '#');
                    document.getElementById('urlLinkId2').className = 'disabled';
                    document.getElementById('urlLinkId1').setAttribute('href', '#');
                    document.getElementById('urlLinkId1').className = 'disabled';
                    j$('.attachVersion').val('');
                    j$('.attachRevision').text('');
                    j$('.attachCat').val('');
                    j$('.attachModel').val('');
                    j$('.attachNote').val('');
                    j$('.attachDesc').val('');
                    return;
                }
                j$('.clsSpinner').css('display','block');
                
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.DSRDesignTechnicalController.GetFitCategoryDtl}',
                    ShortCode,offeringType,
                    function(result, event){
                        if (event.status) 
                        {
                            var des = result;
                            
                            /************* Change Request By Debora Lane 16-April-2018 *************/
                            //j$('.clsShortChange').val(des.Description__c);
                            //j$('.clsDetailChange').val(des.PublishedURL__c);
                            
                            j$('.clsVersion').text(des.LatestVersion__c);
                            j$('[id$=hdnVersion]').val(des.LatestVersion__c);
                            
                            j$('.clsDescriptionDiv1').text('');
                            j$('[id$=idDes]').val('');    
                            
                            j$('[id$=idDes]').val(des.Name__c);
                            j$('.clsDescriptionDiv1').text(des.Name__c);
                            
                            if(des.PublishedURL__c != null){
                                document.getElementById('urlLinkId2').setAttribute('href', des.PublishedURL__c );
                                document.getElementById('urlLinkId2').className = '';
                            }
                            else{
                                document.getElementById('urlLinkId2').setAttribute('href', '#');
                                document.getElementById('urlLinkId2').className = 'disabled';
                            }
                            var prefix = des.AdditionalURL__c;
                            if(prefix != null){
                                if(!prefix.includes('http://') && !prefix.includes('https://')){
                                    prefix = 'http://'+ des.AdditionalURL__c;
                                }
                                document.getElementById('urlLinkId1').setAttribute('href', prefix);
                                document.getElementById('urlLinkId1').className = '';
                            }else{
                                document.getElementById('urlLinkId1').setAttribute('href', '#');
                                document.getElementById('urlLinkId1').className = 'disabled';
                            }
                            
                            j$('.clsNotesBluePrint').val(des.Notes__c);
                            
                            j$('.attachVersion').val(des.LatestVersion__c);
                            if(des.Dateoflastrevision__c!= undefined){
                                var date = new Date(des.Dateoflastrevision__c);
                                var a = ((date.getMonth() + 1) + '/' + date.getDate() + '/' +  date.getFullYear())
                                j$('.attachRevision').text(a);
                            }else{
                                j$('.attachRevision').text('');
                            }
                            j$('.attachCat').val(des.Product_Category__c);
                            j$('.attachModel').val(des.Maturity_Model__c);
                            j$('.attachNote').val(des.Notes__c);
                            j$('.attachDesc').val(des.Description__c);
                            
                            j$('.clsSpinner').css('display','none');

                        } else if (event.type === 'exception') {
                            document.getElementById("responseErrors").innerHTML = 
                                event.message + "<br/>\n<pre>" + event.where + "</pre>";
                        } else {
                            document.getElementById("responseErrors").innerHTML = event.message;
                        }
                    }, 
                    {escape: true}
                );
                changeVersionDateColor();
            }
            
            function changeVersionDateColor(){
                setTimeout(function(){
                    var lastestVersion = j$('.attachVersion').val();
                    var checkVersion = j$('.pickVersion').text();
                    if(lastestVersion != checkVersion){
                        j$('.pickVersion').css({'color':'red'});
                        return;
                    }
                }, 1500);
                
            }
            
            
            
            function HideProgressBar()
            {
              j$('.clsSpinner').css('display','none');
            }
            function SaveActivity()
            {
              var retrn = false;
              afPopUp();
              var va = '{!blnShowErrorMsg_Popup}';
              alert(va);
              if(va == 'true')
                retrn = false;
              else
                retrn = false;
              return retrn;    
            }
            
            function CheckPercentage(ctrl)
            {
              //alert(ctrl);
              if(ctrl == 'Fit')
              {
                if(j$('.clsFitPer').val() == '100')
                {
                   j$('.clsFitCategory').val('Perfect Fit') ;
                }
                else
                {
                 
                  j$('.clsFitCategory').val(null) ;
                  
                }  
                   
              }
              if(ctrl == 'Category')
              {
                if(j$('.clsFitCategory').val() == 'Perfect Fit')
                {
                   j$('.clsFitPer').val('100') ;
                }
                
              }
            if(j$('.clsFitPer').val() != '100')
            {
               j$('.clsFitPerReq').css('border-left','2px solid red');
            }else{
                j$('.clsFitPerReq').css('border-left','1px solid #878787');
            }
              /*********  27-April-18 shared by Debora Lane ************/
              if(j$('.clsFitPer').val() != '100')
                 j$('.clsShortChange').css('border-left','2px solid red');
              if(j$('.clsFitPer').val() == '100')
                 j$('.clsShortChange').css('border-left','2px solid #5786e0'); 
            }
            
            // Priyank added below function for Url validation. 
            function validUrlCheck(){
                var a = document.getElementsByClassName("clsAttachment")[0].value;
                if(a != ''){
                    //var regexp = new RegExp(/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/ );
                    //var regexp = /^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/|ftp:\/\/www\.|ftps:\/\/www\.|ftp:\/\/|ftps:\/\/|smtp:\/\/www\.|smtps:\/\/www\.|smtp:\/\/|smtps:\/\/)?([w][w][w])+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/;
                    var regexp = /^((https|smtps|ftps|ftp|smtp)?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/;
                    if (regexp.test(a)) {
                        saveMethod();
                        return true;
                    }else{
                        var div = document.getElementById("errorMesg");
                        div.innerHTML = "URL is Not Valid. Please Enter Valid URL";
                        return false;
                    }
                }else{
                    saveMethod();
                }
            }
            function validUrlCheck1(){
                var a = document.getElementsByClassName("clsDetailChange")[0].value;
                if(a != ''){
                    //var regexp = /^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/|ftp:\/\/www\.|ftps:\/\/www\.|ftp:\/\/|ftps:\/\/|smtp:\/\/www\.|smtps:\/\/www\.|smtp:\/\/|smtps:\/\/)?([w][w][w])+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/;
                    var regexp = /^((https|smtps|ftps|ftp|smtp)?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/;
                    if (regexp.test(a)) {
                        saveMethod1();
                        return true;
                    }else{
                        var div = document.getElementById("errorMesg1");
                        div.innerHTML = "URL is Not Valid. Please Enter Valid URL";
                        return false;
                    }
                }else{
                    saveMethod1();
                }
            }
            //Below function was added by priyank 15 Nov 2018 to check the mandatory URL on click of edit button.
            function requiredCheck(isCheck){
                if(isCheck){
                    j$('.clsAttachment').css('border-left','2px solid red');
                    j$('[id$=hdnUrlReq]').val('YES');
                }else{
                    j$('.clsAttachment').css('border-left','');
                    j$('[id$=hdnUrlReq]').val('NO');
                }
            }
            //Below function was added by priyank 15 Nov 2018 to check the mandatory short code description.
            function checkMandatoryShortChange(){
                if(j$('.clsFitPer').val() != '100'){
                    j$('.clsShortChange').css('border-left','2px solid red');
                    j$('.clsFitPerReq').css('border-left','2px solid red');
                }else{
                    j$('.clsShortChange').css('border-left','2px solid #5786e0');
                    j$('.clsFitPerReq').css('border-left','1px solid #878787');
                }
            }
            //Priyank ended.
            
            function testauto(){        
                var a = '';     
                j$(".autoSearchDSO").autocomplete({     
                    source: function(request, response) {       
                        DSRDesignTechnicalController.autoSearchDSOList(request.term,function(result, event){        
                            if (event.status)       
                            {       
                                //alert(JSON.stringify(result));        
                                response(result);       
                            }       
                            else        
                            {       
                                alert(event.message);       
                            }       
                            });     
                    },      
                    select:function(event,ui){      
                      a = ui.item.label;        
                      j$('.autoSearchDSO').val(ui.item.label);      
                      return false;     
                    }       
                });     
            }
        </script>
        <style>
            .slds .slds-button--brand {
                padding-left: 35px;
                padding-right: 35px;
            }
            .slds .slds-button {
                line-height: 50px;
                font-size: 150%;
            }
            .slds .slds-table th, .slds .slds-table td {
               
                white-space: normal;
            }
        </style>
        <style>       
           /* popup_box DIV-Styles  Start*/
            .popup_box {
                top: 50px;
                left: 200px;
                position:fixed; 
                display:block; /* Hide the DIV */
                border-color: #0070d2;
                border-width: 2px;                
                z-index: 999;
                left: 40%;
                padding:10px;
                border-radius: 15px;
                border-style: outset;
                margin-left: -250px;
                top:4%;   
                
                /*These are the 3 css properties you will need to change so the popup      
                displays in the center of the screen. First set the width. Then set         
                margin-left to negative half of what the width is. You can add      
                the height property for a fixed size pop up if you want.     
                //width: 500px;           
                top:100px;  */         
            }
            a{ 
                cursor: pointer; 
                text-decoration:none; 
            }
            
            /* This is for the positioning of the Close Link */
            .parentDisable{
                position:fixed;
                top:0;
                left:0;
                background:#000;
                opacity:0.20;
                z-index:998;
                height:100%;
                width:100%;}

            #popupBoxClose {
                font-size:20px;  
                line-height:15px;  
                right:5px;  
                top:5px;  
                position:absolute;  
                color:#6fa5e2;  
                font-weight:500;      
            }
            /* popup_box DIV-Styles  Close*/
            /*to hide user type*/
            .clsUser select{
                visibility: hidden !important;
                display: block !important;
                }
                div.tooltip {
                width: 20px;
                float: right;
                display:inline;
            }
            .clsSolutionCon select{
                visibility: hidden !important;
                display: block !important;
                }
                div.tooltip {
                width: 20px;
                float: right;
                display:inline;
            }
            
            div.tooltip span {
                display: none;
                font-weight:normal;
                text-align:left;
                padding: 3px 5px;
                margin-left: 8px;
                width: 250px;
            }
            
            div.tooltip:hover span {
                display: inline;
                position: absolute;
                border: 1px solid #cccccc;
                background: #FFC;
                color: #000000;
                z-index:10000;
            }
            .Mylinks
            {
                color:#000000;            
            }
            a:visited
            {
                color:Blue;           
            }
            .pbTitle {
            white-space: nowrap;
            }
            a.disabled {
               pointer-events: none;
               cursor: default;
            }
       </style>
       
       <style>
         <!-- progress bar -->
         .clsSpinner{
                /* Background color */
                
                filter: alpha(opacity = 20);
            
                /* Dimensions */
                width: 100%;
                height: 100%;
                top: 0;
                left: 0;
                z-index: 1002;
                position: absolute;
                
                /* Mouse */
                cursor:wait;
            }
         
            /* This is for the message DIV */
            .PopupPanel {
                /* Background color */
                border: solid 2px blue;
                background-color: white;
         
                /* Dimensions */
                left: 50%;
                width: 150px;
                margin-left: -100px;
                top: 50%;
                height: 20px;
                margin-top: -25px;
                z-index: 1001;
                position: fixed;
                
                /* Mouse */
                cursor:pointer;
            }
       </style>
       <style>
         .RequirInpt{
           position: relative;
          height: 100%;
         }
         .Requir{
               background-color: #c00;
                position: absolute;
                left: -4px;
                width: 3px;
                top: 1px;
                bottom: 1px;
         }
         .messageTable{
                width: 100%;
                margin-bottom: 10px;
            }
            .message .messageText h4 { 
                display: none;
            } 
            .errorM3 .msgIcon, .errorMedium {
                background-image:
                background-position: 0 0;
                width: 0;
                height: 0;
            }
            .message .messageText {
                color: red;
                text-align: center;
                font-size: 12px;
                font-weight: 600;
            }
            .spinnerBg{
                width: 100%;
                height: 100%;
                position: absolute;
                background-color: #000;
                opacity: 0.2;
                z-index: 999999;
            }
            .spinner{
                width: 100%;
                height: 100%;
                position: absolute;
                background-image: url("/img/loading32.gif");
                background-size: 16px;
                background-repeat: no-repeat;
                background-attachment: fixed;
                background-position: center;
                z-index: 9999999;
                opacity: 1;
            }
            
            .slds hr {
                display: block;
                margin: 32px 0;
                border-top: 2px solid #006fd2;
                height: 1px;
                clear: both;
            }
       </style>
       <style>
       <!-- Tool Tip CSS -->
          <!-- ToolTip Container -->
            .tooltip1 {
                position: relative;
                display: inline-block;
                
            }
            
            <!-- Tooltip text -->
            .tooltip1 .tooltiptext {
                visibility: hidden;
                overflow:auto;
                <!--width: 220px;-->
                background-color: #FFC;
                color: #fff;
                text-align: center;
                padding: 5px 0;
                border-radius: 6px;
             
                <!-- Position the tooltip text - see examples below! -->
                position: absolute;
                z-index: 1;
            }
            <!-- Show the tooltip text when you mouse over the tooltip container -->
            .tooltip1:hover .tooltiptext {
                visibility: visible;
                color:black;
            }
            
            .popupBackground{       
                background-color:black;     
                opacity: 0.20;      
                filter: alpha(opacity = 20);        
                position: absolute;     
                width: 100%;        
                height: 100%;       
                top: 0;     
                left: 0;        
                z-index: 9998;      
            }       
            .custPopup{     
                background-color: white;        
                border-width: 2px;      
                border-style: outset;       
                z-index: 9999;      
                left: 50%;      
                padding:10px;       
                position: absolute;     
                /* These are the 3 css properties you will need to change so the popup      
                displays in the center of the screen. First set the width. Then set         
                margin-left to negative half of what the width is. You can add      
                the height property for a fixed size pop up if you want.*/      
                //width: 500px;     
                margin-left: -250px;        
                top:100px;      
                border-color: #0070d2;      
                border-radius: 15px;        
            }       
            .ui-autocomplete{       
                position:relative;      
                z-index:9999999;        
                width: 161px !important;        
            }
       </style>
    <Script>
    function setFocusOnLoad() {}
    </Script>
        <body>
        <!-- Priyank added below two action function -->
        <apex:actionFunction name="saveMethod" action="{!InsertAndUpdateActivity}" rerender="pnlPopUp_parent,pnlAllDesigns" status="spinnerStatus"/>
        <apex:actionFunction name="saveMethod1" action="{!SaveAndUpdateArchBluePrint}" rerender="pnlPopUp_parent_design,pnlAllActivity" status="spinnerStatus" oncomplete="checkMandatoryShortChange();return false;"/>
        <apex:actionStatus id="spinnerStatus">
            <apex:facet name="start">
                <div class="spinnerBg" />
                <div class="spinner" ></div>
            </apex:facet>
        </apex:actionStatus>
    <!--<apex:actionFunction action="{!GetAccessAndSource}" oncomplete="HideProgressBar()" immediate="false"  name="afAccess" reRender="idSource">
      <apex:param name="firstParam" assignTo="{!strSelectedAccess}" value="" />
    </apex:actionFunction>-->
    <div id="spinner" style="display: none" class="clsSpinner">
      <div class="PopupPanel">
        <apex:image id="theProgress" value="{!$Resource.ProgressBarStatus}" width="20" height="20"/>
      </div>
    </div>
    
    <apex:inputHidden value="{!FileDescType}" id="hdnFileType" />
    <apex:inputHidden value="{!strURLReq}" id="hdnUrlReq"/>
      <div class="slds"> 
          <div class="slds-page-header" role="banner"> 
                    <div class="slds-grid">
                        <div class="slds-col">  
                            <div class="slds-media"> 
                                <div class="slds-media__figure">
                                </div>
                      
                         
                            
                                <div class="slds-media__body">
                                    <table>
                                       <tr>
                                         <td><h1 class="slds-text-heading--small"><a  href="{!IF(objSCE.DSR_SCEngagement__r.Is_partner_DSR__C, '/partner','/apex')}/SC_Engagement_Design_Business?id={!objSCE.id}" target="_self"><apex:image id="theImage" value="{!$Resource.aerrow_left}" width="20" height="20" /></a></h1></td>
                                         <td><h1 class="slds-text-heading--small"><b><div style="float:left;"><apex:outputText value="Design - Technical for "></apex:outputText></div>  <div style="color: #0070d2;float:left;">&nbsp;{!objSCE.Name}</div></b></h1></td>
                                         
                                         <apex:outputPanel rendered="{!NOT(objSCE.DSR_SCEngagement__r.Is_Partner_DSR__c)}">
                                         <td style="text-align: -webkit-right;"><h1 class="slds-text-heading--small"><a href="{!map_DesignLinks['Design How To']}" target="_blank">Design How To</a></h1></td>
                                         <td style="text-align: -webkit-right;"><h1 class="slds-text-heading--small"><a  href="{!map_DesignLinks['Design Assets']}" target="_blank">Design Assets</a></h1></td>
                                         </apex:outputPanel>
                                         
                                         <apex:outputPanel rendered="{!NOT(objSCE.DSR_SCEngagement__r.Is_Partner_DSR__c)}">
                                         <td style="text-align: -webkit-right;"><h1 class="slds-text-heading--small"><b><a  href='apex/SC_Engagement_DSR?id={!objSCE.DSR_SCEngagement__c}' target="_self">Home</a></b></h1></td>
                                         </apex:outputPanel>   
                                         <apex:outputPanel rendered="{!objSCE.DSR_SCEngagement__r.Is_Partner_DSR__c}">
                                         <td style="text-align: -webkit-right;"><h1 class="slds-text-heading--small"><b><a  href='SC_EngagementPartner_DSR?id={!objSCE.DSR_SCEngagement__c}' target="_self">Home</a></b></h1></td>
                                         </apex:outputPanel>
                                         
                                         <td style="text-align: -webkit-right;"><h1 class="slds-text-heading--small"><a  href="{!IF(objSCE.DSR_SCEngagement__r.Is_partner_DSR__C, '/partner','/apex')}/DSR_Deliver?id={!objSCE.DSR_SCEngagement__c}" target="_self"><apex:image id="theImage2" value="{!$Resource.aerrow_right}" width="20" height="20"/></a></h1></td>
                                         
                                       </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
          <div class="myapp">
            <div class="slds-grid slds-m-top--large">
              <div style="width:550%; margin-left:0%;">
                <div class="slds-card"  style="text-align:-webkit-center;">
                     <div class="slds-card__body" style="width:95%;">
                       <apex:outputPanel styleClass="openInPopup"> 
                        <table>
                            <tr class="slds-hint-parent"  style="width: auto;height: 25px;">
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>SC DSR Name :</b></td>
                                <td style="width:1%"></td>
                                <td style="width:10%;text-align:left;"> <apex:outputField value="{!objSCE.DSR_SCEngagement__c}"/></td>
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Primary Design? :</b></td>
                                <td style="width:1%"></td>
                                <td style="width:10%;text-align:left;"> <apex:outputField value="{!objSCE.IsPrimary__c}"/></td>
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Design Created Date :</b></td>
                                <td style="width:1%"></td>
                                <td style="width:10%;text-align:left;"> <apex:outputField value="{!objSCE.createddate}"/></td>
         
                            </tr>
                            <tr class="slds-hint-parent"  style="width: auto;height: 25px;">
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Opportunity : </b></td>
                                <td style="width:1%"></td>
                                <td class="" data-label="Monthlyrent" style="width:10%;text-align:left;"><apex:outputField value="{!objSCE.DSR_SCEngagement__r.Opportunity_ID__c}"/></td>
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Design Source : </b></td>
                                <td style="width:1%"></td>
                                <td class="" data-label="Monthlyrent" style="width:10%;text-align:left;"><apex:outputField value="{!objSCE.Design_Source__c}"/></td>
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Design Last Modified : </b></td>
                                <td style="width:1%"></td>
                                <td class="" data-label="Monthlyrent" style="width:10%;text-align:left;"><apex:outputField value="{!objSCE.lastmodifieddate}"/></td>
                                
                                  
                                
                            </tr>
                            <tr class="slds-hint-parent"  style="width: auto;height: 25px;">
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Account : </b></td>
                                <td style="width:1%"></td>
                                <td style="width:10%;text-align:left;">
                                  <apex:outputField value="{!objSCE.DSR_SCEngagement__r.Opportunity_ID__r.AccountId}"/>
                                </td>
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>HA Type: </b></td>
                                <td style="width:1%"></td>
                                <td style="width:10%;text-align:left;">
                                 <apex:outputField value="{!objSCE.HAType__c}"/>
                                </td>
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Design Created By: </b></td>
                                <td style="width:1%"></td>
                                <td style="width:10%;text-align:left;">
                                  <apex:outputField value="{!objSCE.CreatedById}"/>
                                </td>
                            </tr>
                            <tr class="slds-hint-parent"  style="width: auto;height: 25px;">
                                <!--<td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Opportunity Offering Type : </b></td>
                                <td style="width:1%"></td>
                                <td style="width:10%;text-align:left;">
                                  <apex:outputField value="{!objOpp.Lines_of_Businesses__c}"/>
                                </td>-->
                                
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Opportunity Lead Offer :</b></td>
                                <td style="width:1%"></td>
                                <td style="width:10%;text-align:left;"><apex:outputField value="{!objOpp.Lead_Offer__c}"/></td>
                                
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Data Centers : </b></td>
                                <td style="width:1%"></td>
                                <td style="width:10%;text-align:left;">
                                  <apex:outputField value="{!objSCE.DataCenters__c}"/>
                                </td>
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Design Last Modified By : </b></td>
                                <td style="width:1%"></td>
                                <td style="width:10%;text-align:left;">
                                  <apex:outputField value="{!objSCE.lastmodifiedbyid}"/>
                                </td>
                            </tr>
                            <tr class="slds-hint-parent"  style="width: auto;height: 25px;">
                                <!--<td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Opportunity Platform Type : </b></td>
                                <td style="width:1%"></td>
                                <td style="width:10%;text-align:left;">
                                  <apex:outputField value="{!objOpp.Primary_Line_of_Business__c }"/>
                                </td>-->
                                
                                <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Design Offer/Platform : </b></td>
                                <td style="width:1%"></td>
                                <td style="width:10%;text-align:left;">
                                  <apex:outputField value="{!objSCE.OfferingPlatformType__c}"/>
                                </td>
                            </tr>
                            <!-- Added by Debora Lane 14-May-18 -->
                            <tr class="slds-hint-parent"  style="width: auto;">    
                              <td class="" data-label="RoomNumber" style="width:10%;text-align:right;"><b>Opportunity Current Stage : </b></td>
                              <td style="width:1%"></td>
                              <td class="" data-label="Monthlyrent" style="width:10%;text-align:left;"><apex:outputField value="{!objOpp.Stagename}"/></td>
                            </tr>
                        </table> 
                        </apex:outputPanel> 
                        
                        <hr/>
                        <table>
                          <tr style="height: 45px;">
                            <td style="width:60%:">
                                <table style="width:100%;" >
                                    <tr>
                                        <td style="width:15%">
                                            <b>Architectures/Blueprints</b>
                                        </td>
                                        <td style="width:11%;text-align: -webkit-left;">
                                            <apex:commandButton rendered="{!NOT(blnIsSubmitted)}" action="{!AddAct}"  value="Add" style="font-weight: bolder;line-height:26px;font-size:96%" styleClass="slds-button slds-button--brand slds-button--small"  rerender="pnlPopUp_parent_design" status="spinnerStatus"/>
                                        </td>
                                        <td style="width:15%;text-align: -webkit-left;">
                                            <b>Technical Design Profile :</b>
                                        </td>
                                        <td style="text-align: -webkit-left;">
                                            <apex:outputPanel id="pnlBDP">{!objSCE.TechnicalDesignProfile__c}</apex:outputPanel> 
                                        </td>
                                    </tr>
                                </table>
                            </td>
                          </tr> 
                          <tr>
                            <td>
                             <apex:outputPanel id="pnlAllActivity">   
                              <table class="slds-table slds-table--bordered" style="width:100%;border: 2px solid #0070d2;">
                                <thead>
                                    <tr style="background-color:#0070d2">
                                        <th style="">
                                            <b style="color: white;">Short Code</b>
                                        </th>
                                        <th style="">
                                            <b style="color: white;">Name</b>
                                        </th>
                                        <th  style="">
                                            <b style="color: white;">Fit%</b>
                                        </th>
                                        <th  style="">
                                            <b style="color: white;">Fit Category</b>
                                        </th>
                                        <th  style="">
                                           <b style="color: white;">Short Change Description</b>
                                        </th>
                                        <th  style="">
                                            <b style="color: white;">Detailed Change Description</b>
                                        </th>
                                        <th  style="">
                                            <b style="color: white;">Version Used</b>
                                        </th>
                                        <th  style="">
                                            <b style="color: white;">Notes</b>
                                        </th>
                                        <th style="{!IF((NOT(blnIsSubmitted)),'','display:none;')}">
                                            <b style="color: white;">Action</b>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody style="width:100%;table-layout: fixed;">
                                  <apex:repeat value="{!list_ArchBluePrint}" var="vi">
                                    <tr class="slds-hint-parent" >
                                        <td style="max-width:30px;word-wrap: break-word;text-align: justify;">
                                           <div class="tooltip1">{!vi.ShortCode__c}
                                              <span class="tooltiptext">{!vi.Name__c}</span>
                                           </div>
                                        </td>
                                        <td style="max-width:30px;word-wrap: break-word;text-align: justify;">{!vi.Name__c}</td>
                                        <td style="max-width:30px;word-wrap: break-word;text-align: justify;">{!vi.Fit__c}</td>
                                        <td style="max-width:30px;word-wrap: break-word;text-align: justify;">{!vi.FitCategory__c}</td>
                                        <td style="max-width:30px;word-wrap: break-word;text-align: justify;">
                                          {!vi.ShortChangeDescription__c}
                                        </td>
                                        <td style="max-width:30px;word-wrap: break-word;text-align: justify;"><apex:outputLink value="{!IF(BEGINS(LOWER(vi.DetailedChangeDescription__c), 'http'), vi.DetailedChangeDescription__c, 'https://'+vi.DetailedChangeDescription__c)}" target="_blank">{!vi.DetailedChangeDescription__c}</apex:outputLink></td>
                                        <td style="max-width:30px;word-wrap: break-word;text-align: justify;">{!vi.VersionUsed__c}</td>
                                        <td style="max-width:200px;word-wrap: break-word;text-align: justify;">{!vi.Notes__c}</td>
                                        <td style="{!IF((NOT(blnIsSubmitted)),'word-wrap: break-word;text-align: justify;','display:none;')}">
                                           <apex:commandLink rendered="{!NOT(blnIsSubmitted)}" value="Edit" rerender="pnlPopUp_parent_design"  action="{!EditArchBluePrint}" oncomplete="checkMandatoryShortChange();" status="spinnerStatus">
                                            <apex:param name="vi" assignTo="{!strVisionActId}" value="{!vi.id}"/>
                                          </apex:commandLink>&nbsp;|&nbsp;
                                          <apex:commandLink rendered="{!NOT(blnIsSubmitted)}" value="Remove"  action="{!RemoveBlueprint}" status="spinnerStatus">
                                            <apex:param name="vi" assignTo="{!strBluePrintId}" value="{!vi.id}"/>
                                          </apex:commandLink> 
                                        </td>
                                    </tr>
                                  </apex:repeat>   
                                </tbody>
                              </table>
                              </apex:outputPanel> 
                             </td>
                           </tr>            
                        </table>
                        <!-- List of Design Start -->
                        <br/>
                        <table>
                          <tr style="height: 45px;">
                           
                            <td style="width:60%:">
                                <table style="width:100%;" >
                                    <tr>
                                        <td style="width:15%">
                                            <b>Technical Design Activities</b>
                                        </td>
                                        
                                        <td style="text-align: -webkit-left;">
                                            <apex:commandButton rendered="{!NOT(blnIsSubmitted)}" action="{!AddAct}"  value="Add" style="font-weight: bolder;line-height:26px;font-size:96%" styleClass="slds-button slds-button--brand slds-button--small"  rerender="pnlPopUp_parent" status="spinnerStatus"/>
                                        </td>
                                        
                                    </tr>
                                </table>
                            </td>
                          </tr> 
                          <tr>
                            <td>   
                              <apex:outputPanel id="pnlAllDesigns">
                              <table class="slds-table slds-table--bordered" style="width:100%;border: 2px solid #0070d2;">
                                <thead>
                                    <tr style="background-color:#0070d2">
                                        <th style="">
                                            <b style="color: white;">Attachment Type</b>
                                        </th>
                                        <th  style="">
                                            <b style="color: white;">Description</b>
                                        </th>
                                        <th  style="">
                                            <b style="color: white;">Attachment URL</b>
                                        </th>
                                       <!--<apex:outputpanel rendered="{!!objSCE.DSR_SCENgagement__r.Is_Partner_DSR__c}">-->
                                        <th  style="display:{!if(objSCE.DSR_SCENgagement__r.Is_Partner_DSR__c,'none','')}">
                                           <b style="color: white;">Access</b>
                                        </th>
                                       <!--</apex:outputpanel>-->
                                        <th  style="">
                                            <b style="color: white;">Source</b>
                                        </th>
                                        <th  style="">
                                            <b style="color: white;">Notes</b>
                                        </th>
                                        <th  style="{!IF((NOT(blnIsSubmitted)),'','display:none;')}">
                                            <b style="color: white;">Action</b>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody style="width:100%;table-layout: fixed;">
                                  <apex:repeat value="{!list_Activity}" var="vi">
                                     <tr class="slds-hint-parent"  >
                                        <td style="max-width:30px;word-wrap: break-word;text-align: justify;">{!vi.AttachmentType__c}</td>
                                        <td style="max-width:200px;word-wrap: break-word;text-align: justify;">{!vi.Description__c}</td>
                                        <td style="max-width:30px;word-wrap: break-word;text-align: justify;"><apex:outputLink value="{!IF(BEGINS(LOWER(vi.AttachmentURL__c), 'http'), vi.AttachmentURL__c, 'https://'+vi.AttachmentURL__c)}" target="_blank">{!vi.AttachmentURL__c}</apex:outputLink></td>
                                        
                                        <!--<apex:outputpanel rendered="{!!objSCE.DSR_SCENgagement__r.Is_Partner_DSR__c}">-->
                                        <td style="max-width:20px;word-wrap: break-word;text-align: justify;display:{!if(objSCE.DSR_SCENgagement__r.Is_Partner_DSR__c,'none','')}">{!vi.Access__c}</td>
                                        <!--</apex:outputpanel>-->
                                        
                                        <td style="max-width:20px;word-wrap: break-word;text-align: justify;">{!vi.Source__c}</td>
                                        <td style="max-width:200px;word-wrap: break-word;text-align: justify;">{!vi.Notes__c}</td>
                                        <td style="{!IF((NOT(blnIsSubmitted)),'max-width:100px;word-wrap: break-word;text-align: justify;','display:none;')}">
                                            <!--priyank added oncomplete in below tag to check url is mandatory or not. 15 Nov 2018 -->
                                           <apex:commandLink rendered="{!NOT(blnIsSubmitted)}" value="Edit" rerender="pnlPopUp_parent" oncomplete="requiredCheck({!checkMandatory})" action="{!EditActivity}" status="spinnerStatus">
                                            <apex:param name="vi" assignTo="{!strVisionActId}" value="{!vi.id}"/>
                                          </apex:commandLink>&nbsp;|&nbsp;
                                          <apex:commandLink rendered="{!NOT(blnIsSubmitted)}" value="Remove"  action="{!RemoveVisionActivity}" status="spinnerStatus">
                                            <apex:param name="vi" assignTo="{!strVisionActId}" value="{!vi.id}"/>
                                          </apex:commandLink> 
                                        </td>
                                    </tr>
                                  </apex:repeat>   
                                </tbody>
                              </table>
                              </apex:outputPanel> 
                              
                             </td>
                           </tr>            
                        </table> 
                        <!-- List of Design End -->
                        <!--        
                            @Start: Ashish Goyal (03/18/2019)       
                            @Desc: To Show the list of DSO      
                        -->     
                        <br/>       
                        <!-- Below output Panel added ny priyank on request of Vikram - 31/5/2019 -->       
                        <apex:outputPanel rendered="{!capSection}">     
                            <table>     
                                <tr style="height: 45px;">      
                                    <td style="width:60%:">     
                                        <table style="width:100%;" >        
                                            <tr>        
                                                <td style="width:15%">      
                                                    <b>CAP List</b>     
                                                </td>       
                                                <td style="text-align: -webkit-left;">      
                                                    <apex:commandButton action="{!newDSO}"  value="New CAP" style="font-weight: bolder;line-height:26px;font-size:96%" styleClass="slds-button slds-button--brand slds-button--small" status="spinnerStatus"/>      
                                                    &nbsp;&nbsp;&nbsp;&nbsp;        
                                                    <apex:commandButton action="{!showCopyDSOPopup}"  value="Clone CAP" style="font-weight: bolder;line-height:26px;font-size:96%" styleClass="slds-button slds-button--brand slds-button--small"  rerender="copyDSO" status="spinnerStatus"/>      
                                                </td>       
                                            </tr>       
                                        </table>        
                                    </td>       
                                </tr>       
                                <tr>        
                                    <td>        
                                        <apex:outputPanel id="pnlAllDesigns2">      
                                            <table class="slds-table slds-table--bordered" style="width:100%;border: 2px solid #0070d2;">       
                                                <thead>     
                                                    <tr style="background-color:#0070d2">       
                                                        <th style=""><b style="width:88%; color: white;">CAP Name</b></th>      
                                                        <th style=""><b style="width:88%; color: white;">Status</b></th>        
                                                        <th  style="width:12%; {!IF((NOT(blnIsSubmitted)),'','display:none;')}">        
                                                            <b style="color: white;">Action</b>     
                                                        </th>       
                                                    </tr>       
                                                </thead>        
                                                <tbody style="width:100%;table-layout: fixed;">     
                                                    <apex:repeat value="{!list_SDO}" var="vi">      
                                                        <tr class="slds-hint-parent"  >     
                                                            <td style="max-width:30px;word-wrap: break-word;text-align: justify;">{!vi.Name}</td>       
                                                            <td style="max-width:30px;word-wrap: break-word;text-align: justify;">{!vi.Status__c}</td>      
                                                            <td style="">       
                                                                <a href="/{!vi.id}" target="_blank">View</a>        
                                                            </td>       
                                                        </tr>       
                                                    </apex:repeat>          
                                                </tbody>        
                                            </table>        
                                        </apex:outputPanel>     
                                    </td>       
                                </tr>       
                            </table>        
                        </apex:outputPanel>     
                        <!--        
                            @End: Ashish Goyal (03/18/2019)     
                        -->     
                        
                        <!-- Start : Pop up for Design Activity -->          
                                <apex:outputPanel id="pnlPopUp_parent"> 
                                  
                                <apex:outputPanel styleClass="parentDisable" layout="block" rendered="{!blnParentDisable}"/>
                            
                             <apex:outputPanel id="pnlPopup" styleClass="clsPnlPopUp" layout="block" rendered="{!blnParentDisable}" style="height:auto;margin-top:0px;overflow-y: auto;">
                               
                                <!--<div id="popup_box" class="slds-card clsPop" style="height:400px;margin-top:20px;overflow-y: auto;">-->   <!-- OUR PopupBox DIV-->
                                  <div id="popup_box" class="slds-card clsPop popup_box"  style="height:96%; overflow-y: auto;position: fixed; border: 2px solid #0459a8;border-radius: 4px;width: 768px;">
                                   <apex:outputPanel id="pnlerrorMsg" rendered="{!blnShowErrorMsg_Popup}">
                                       <apex:pagemessages rendered="{!blnShowErrorMsg_Popup}" />
                             </apex:outputPanel>
                                <!--<apex:pageBlock id="pbLive">-->
                                   <div style="float:left;width:10px;color:black;"></div>
                                     
                                    <div  class="slds-tile" > 
                                     <div  class="slds-tile__detail">
                                       <div class="clsMsg" style="color:red"></div>
                                       <apex:actionFunction name="afPopUp" action="{!InsertAndUpdateActivity}" reRender="idMsgPopUp,rptActvities"/>
                                       
                                         <table>
                                            <tr>
                                                <td style="text-align:left;color:#3B76DD;font-size:larger"><b>Attachment Type</b></td>
                                                <td style="text-align:right;color:#3B76DD;font-size:larger"><b>Technical Design</b></td>
                                            </tr>
                                            <tr>
                                                <td colspan="2">&nbsp;</td>
                                            </tr>
                                            <tr class="slds-item_label slds-text-color_weak slds-truncate"  style="width: 90%;height: 50px;margin-top:5%">
                                                <td colspan="2" style="padding-left: 20px;">
                                                    <apex:selectList value="{!strSelectedAttachmentType}" size="1"  styleClass="clsAttachmentType slds-input" id="VisionType" onchange="GetDesc()" style="border-left: 2px solid red;" >
                                                      <apex:selectOptions value="{!optionListAttachmentType}"/>
                                                    </apex:selectList>
                                                </td>
                                            </tr>
                                            </table><br />
                                            <apex:outputPanel id="visionLoad">
                                                <table>
                                                    <tr>
                                                        <td style="text-align:left; color:#3B76DD;font-size:larger"><b>Attachment Type Info</b></td>
                                                        <td style="text-align:right;"><a class="{!if(dataDef.FullDescriptionURL__c != null, '','disabled')}" id="urlLinkId" href="{!if(dataDef.FullDescriptionURL__c != null, dataDef.FullDescriptionURL__c,'#')}" target="_blank" style="text-decoration: underline;">Documentation on Attachment Type</a></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">&nbsp;</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">
                                                            <table style="outline: 2px solid blue;" cellpadding="4">
                                                                <tr>
                                                                    <td colspan="4">&nbsp;</td>
                                                                </tr>
                                                                <tr style="width: 90%;height: 20px;margin-top:5%">
                                                                    <td style="padding-left: 20px;vertical-align: top; color:#808080">Attachment<br/>Type<br/>Description</td>
                                                                    <td style="width:4px;">&nbsp;</td>
                                                                    <td>
                                                                        <div class="">
                                                                            <div class=""></div>
                                                                            <apex:inputTextArea styleClass="attachDesc" readonly="true" rows="3" cols="80" value="{!dataDef.Description__c}" />
                                                                        </div>&nbsp;&nbsp;
                                                                    </td>
                                                                    <td style="width: 10px;">&nbsp;</td>
                                                               </tr>
                                                               <tr style="width: 90%;height: 20px;margin-top:5%">
                                                                    <td style="padding-left: 20px;vertical-align: top; color:#808080">Notes on<br/>Attachment<br/>Type</td>
                                                                    <td style="width:4px;">&nbsp;</td>
                                                                    <td>
                                                                        <div class="">
                                                                            <div class=""></div>
                                                                            <apex:inputTextArea styleClass="attachNote"  readonly="true" rows="3" cols="80" value="{!dataDef.Notes__c}" />
                                                                        </div>&nbsp;&nbsp;
                                                                    </td>
                                                                    <td style="width: 10px;">&nbsp;</td>
                                                               </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </table><br/>
                                                <table>
                                                    <table>
                                                        <tr>
                                                            <td style="text-align:left;color:#3B76DD; font-size:larger"><b>Attachment Details for this DSR</b></td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="2">&nbsp;</td>
                                                        </tr>
                                                        <tr>
                                                            <td colspan="2">
                                                                <table style="width:100%; outline: 2px solid blue;" cellpadding="4">
                                                                    <tr>
                                                                        <td colspan="6" style="padding-bottom: 7px; padding-top: 2px; padding-left: 5px; color:#808080">Enter information about the activity or attachment below:</td>
                                                                    </tr>
                                                                    <tr style="width: 90%;">
                                                                        <td style="padding-left: 20px;vertical-align: top;">Description</td>
                                                                        <td style="width:4px;">&nbsp;</td>
                                                                        <td colspan="3">
                                                                            <div class="">
                                                                                <div class=""></div>
                                                                                <apex:inputTextArea rows="3" cols="80" value="{!objDSRActivity.Description__c}" id="idDesc"/>
                                                                            </div>&nbsp;&nbsp;
                                                                        </td>
                                                                        <td>&nbsp;</td>
                                                                   </tr>
                                                                   <tr style="width: 90%;">
                                                                        <td style="padding-left: 20px;vertical-align: top;">Attachment<br/> URL</td>
                                                                        <td style="width:4px;">&nbsp;</td>
                                                                        <td colspan="3">
                                                                           <div class="">
                                                                              <apex:outputPanel id="atturl">
                                                                                  <apex:inputField value="{!objDSRActivity.AttachmentURL__c}" style="{!IF((strURLReq == 'YES'),'border-left: 2px solid red;wwidth:100%;height:39px;line-height: normal;','width:100%;height:39px;line-height: normal;')}" styleClass="slds-input clsURL clsAttachment" /><br/>
                                                                              </apex:outputpanel>
                                                                              <!-- Priyank added below Div -->
                                                                              <div id="errorMesg" style="width:100%;color:red;"></div>
                                                                            </div>
                                                                            <input type="file" id="attachmentFile" /> 
                                                                            <apex:outputpanel rendered="{!!objSCE.DSR_SCEngagement__r.Is_Partner_DSR__c}">
                                                                                
                                                                                <button type="button" onclick="return uploadFile('TechnicalDesign','{!objSCE.Name}','clsAttachment');" Class="slds-button slds-button--brand slds-button--small" style="line-height:10px;font-size:15px;padding-left: 10px;padding-right: 10px;">Upload File</button>
                                                                                <!--
                                                                                <apex:commandButton onclick="return uploadFile('TechnicalDesign','{!objSCE.Name}','clsAttachment');" styleClass="slds-button slds-button--brand slds-button--small" style="line-height:10px;font-size:15px;padding-left: 10px;padding-right: 10px;">Upload File</apex:commandButton> -->
                                                                            </apex:outputpanel>
                                                                            <apex:outputpanel rendered="{!objSCE.DSR_SCEngagement__r.Is_Partner_DSR__c}">
                                                                                <button onclick="return uploadFileAttached('clsAttachment');" Class="slds-button slds-button--brand slds-button--small" style="line-height:10px;font-size:15px;padding-left: 10px;padding-right: 10px;">Upload File</button>
                                                                            </apex:outputpanel>
                                                                        </td>
                                                                        <td>&nbsp;</td>
                                                                   </tr>
                                                                   <tr  style="width: 90%;">
                                                                        <td style="padding-left: 20px;vertical-align: top;">Date of<br/> Activity:</td>
                                                                        <td style="width:4px;">&nbsp;</td>
                                                                        <td colspan="2">
                                                                            <div class="">
                                                                                <div class=""></div>
                                                                                <apex:inputField value="{!objDSRActivity.DateofAttachment__c}" style="border-left: 2px solid red;" styleClass="clsActdate slds-input" onclick="ShowCalendar();return false"/>
                                                                            </div>&nbsp;&nbsp;
                                                                        </td>
                                                                        <td colspan="2">&nbsp;</td>
                                                                   </tr>
                                                                   <tr  style="width: 90%;">
                                                                        <td style="padding-left: 20px;vertical-align: top;">Source</td>
                                                                        <td style="width:4px;">&nbsp;</td>
                                                                        <td>
                                                                          <div class="">
                                                                            <div class=""></div>
                                                                            <apex:selectList value="{!strSelectedSource}" size="1" id="idSource"  style="border-left: 2px solid red;" styleClass="clsSource slds-input">
                                                                              <apex:selectOptions value="{!optionListSource}"/>
                                                                            </apex:selectList>
                                                                           </div>&nbsp;&nbsp;
                                                                        </td>
                                                                        <apex:outputpanel layout="{!if(objSCE.DSR_SCENgagement__r.Is_Partner_DSR__c,'','none')}"> 
                                                                             <td style="padding-left: 20px; text-align:center; vertical-align: top;">Access</td>
                                                                             <td style="vertical-align: top;">
                                                                                 <div class="">
                                                                                     <div class=""></div>
                                                                                     <apex:selectList value="{!strSelectedAccess}"  style="width:100%;border-left: 2px solid red;vertical-align: top;"  size="1" id="idAccess" styleClass="clsAccess slds-input">
                                                                                         <apex:selectOptions value="{!optionListAccess}"/>
                                                                                     </apex:selectList>
                                                                                </div> 
                                                                             </td>
                                                                        </apex:outputpanel>
                                                                        <apex:outputpanel layout="{!if(!objSCE.DSR_SCENgagement__r.Is_Partner_DSR__c,'','none')}"> 
                                                                            <td colspan="2">&nbsp;</td>
                                                                        </apex:outputpanel>
                                                                        <td>&nbsp;</td>
                                                                   </tr>
                                                                   <tr  style="width: 90%;">
                                                                        <td style="padding-left: 20px;vertical-align: top;">Notes</td>
                                                                        <td style="width:4px;">&nbsp;</td>
                                                                        <td colspan="3"><apex:inputTextArea rows="3" cols="80" value="{!objDSRActivity.Notes__c}" /></td>
                                                                        <td>&nbsp;</td>
                                                                   </tr>
                                                                   
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table><br/>
                                                </table>    
                                            </apex:outputPanel>
                                         <br/>
                                            <div style="text-align: -webkit-center;">
                                            <!--<apex:commandButton value="Save"  action="{!InsertAndUpdateActivity}" reRender="pnlerrorMsg,pnlPopup,pnlPopUp_parent,pnlAllDesigns" style="line-height:10px;font-size:15px;" styleClass="slds-button slds-button--brand slds-button--small" status="spinnerStatus"/>&nbsp;-->
                                            <!-- Priyank commented the above line and added new line below. -->      
                                            <apex:commandButton value="Save" onclick="validUrlCheck();return false;" reRender="pnlerrorMsg,pnlPopup,pnlPopUp_parent,pnlAllDesigns" style="line-height:10px;font-size:15px;" styleClass="slds-button slds-button--brand slds-button--small" status="spinnerStatus"/>&nbsp;
                                            <apex:commandButton value="Cancel" action="{!Cancel}" reRender="pnlerrorMsg,pnlPopup,pnlPopUp_parent,pnlAllDesigns"  style="line-height:10px;font-size:15px;" styleClass="slds-button slds-button--brand slds-button--small clsBoxClose" id="popupBoxClose" status="spinnerStatus" />
                                            </div>
                                           
                                     </div> 
                                   </div>  
                                 
                                 <!--</apex:pageBlock>-->
                               </div><!-- Close PopupBox DIV-->
                              </apex:outputPanel> 
                             </apex:outputPanel>
                           <!-- End : Pop up for Design Activity --> 
                           
                           <!-- Start : Pop up for UseCase Record -->          
                           <apex:outputPanel id="pnlPopUp_parent_design"> 
                             <apex:outputPanel styleClass="parentDisable" layout="block" rendered="{!blnParentDisable}"/>
                             <apex:outputPanel id="pnlPopup_design" styleClass="clsPnlPopUp" layout="block" rendered="{!blnParentDisable}" style="height:auto;margin-top:0px;overflow-y: auto;">
                                <div id="popup_box_design" class="slds-card clsPop popup_box"  style="height:96%; overflow-y: auto;position: fixed; border: 2px solid #0459a8;border-radius: 4px;width: 768px;">
                                   <apex:outputPanel id="pnlerrorMsg_design" rendered="{!blnShowErrorMsg_Popup}">
                                     <apex:pagemessages rendered="{!blnShowErrorMsg_Popup}" />
                                   </apex:outputPanel>
                                   <div style="float:left;width:10px;color:black;"></div>
                                    <div  class="slds-tile" > 
                                     <div  class="slds-tile__detail">
                                       <div class="clsMsg" style="color:red"></div>
                                        <table>
                                            <tr>
                                                <td style="text-align:left;color:#3B76DD;font-size:larger"><b>Blueprint Selected for this Design &nbsp; &nbsp; ({!objSCE.OfferingPlatformType__c})</b></td>
                                            </tr>
                                            <tr>
                                                <td colspan="2">&nbsp;</td>
                                            </tr>
                                            <tr class="slds-item_label slds-text-color_weak slds-truncate"  style="width: 90%;height: 50px;margin-top:5%">
                                                <td colspan="2" style="padding-left: 20px;">
                                                    <div class="">
                                                        <div class=""></div>
                                                        <apex:selectList value="{!strSelectedShortCode}" onchange="GetGategoryDetails()"  size="1" id="VisionType1" style="width:100%;border-left: 2px solid red;" styleClass="slds-input clsShortCode">
                                                            <apex:selectOptions value="{!optionListShortCode}"/>
                                                        </apex:selectList>
                                                    </div>
                                                </td>
                                           </tr>
                                        </table>
                                        <br />
                                        <apex:outputPanel id="visionLoad2">
                                            <table>
                                                <tr>
                                                    <td style="text-align:left; color:#3B76DD;font-size:larger"><b>Blueprint Information</b></td>
                                                    <td style="text-align:center;"><a class="{!if(ArchBluePrintDef.PublishedURL__c != null, '','disabled')}" id="urlLinkId2" href="{!if(ArchBluePrintDef.PublishedURL__c != null, ArchBluePrintDef.PublishedURL__c,'#')}" target="_blank" style="text-decoration: underline;">Blueprint Document</a></td>
                                                    <td style="text-align:right;"><a class="{!if(ArchBluePrintDef.AdditionalURL__c != null, '','disabled')}" id="urlLinkId1" href="{!if(ArchBluePrintDef.AdditionalURL__c != null, ArchBluePrintDef.AdditionalURL__c,'#')}" target="_blank" style="text-decoration: underline;">Blueprint Diagrams</a></td>  
                                                    <td></td><td></td>          
                                                </tr>
                                                <tr>
                                                    <td colspan="2">&nbsp;</td>
                                                </tr>
                                                <tr>
                                                    <td colspan="5">
                                                        <table style="outline: 2px solid blue;" cellpadding="4">
                                                            <tr>
                                                                <td colspan="6">&nbsp;</td>
                                                            </tr>
                                                            <tr style="width: 90%;height: 20px;margin-top:5%">
                                                                <td style="padding-left: 20px;vertical-align: top; color:#808080">Description<br/>of Blueprints</td>
                                                                <td style="width:4px;">&nbsp;</td>
                                                                <td colspan="5">
                                                                    <div class="">
                                                                        <div class=""></div>
                                                                        <apex:inputTextArea styleClass="attachDesc" readonly="true" rows="3" cols="80" value="{!ArchBluePrintDef.Description__c}" />
                                                                    </div>&nbsp;&nbsp;
                                                                </td>
                                                                
                                                           </tr>
                                                           <tr style="width: 90%;height: 20px;margin-top:5%">
                                                                <td style="padding-left: 20px;vertical-align: top;color:#808080">Lastest<br/> Version</td>
                                                                <td style="width:4px;">&nbsp;</td>
                                                                <td colspan="2">
                                                                  <div class="">
                                                                    <div class=""></div>
                                                                    <apex:inputText styleClass="attachVersion"  size="28" disabled="true" value="{!ArchBluePrintDef.LatestVersion__c}" />
                                                                   </div>&nbsp;&nbsp;
                                                                </td>
                                                                <td style="padding-left: 20px; text-align:center; vertical-align: top;color:#808080">Revision Date</td>
                                                                <td style="width:4px;">&nbsp;</td>
                                                                <td style="vertical-align: top;">
                                                                    <div class="" style="background: lightgrey;border: 1px solid;width:85%">
                                                                        <div class=""></div>
                                                                        <apex:outputText styleClass="attachRevision" value="{0,date,MM/dd/yy}"> <apex:param value="{!ArchBluePrintDef.Dateoflastrevision__c}" /> </apex:outputText>
                                                                    </div> 
                                                                </td>
                                                                
                                                           </tr>
                                                           <tr style="width: 90%;height: 20px;margin-top:5%">
                                                                <td style="padding-left: 20px;vertical-align: top; color:#808080">Notes on<br/>Blueprints</td>
                                                                <td style="width:4px;">&nbsp;</td>
                                                                <td colspan="5">
                                                                    <div class="">
                                                                        <div class=""></div>
                                                                        <apex:inputTextArea styleClass="attachNote" readonly="true" rows="3" cols="80" value="{!ArchBluePrintDef.Notes__c}" />
                                                                    </div>&nbsp;&nbsp;
                                                                </td>
                                                                
                                                           </tr>
                                                           <tr style="width: 90%;height: 20px;margin-top:5%">
                                                                <td style="padding-left: 20px;vertical-align: top; color:#808080">Product<br/> Category</td>
                                                                <td style="width:4px;">&nbsp;</td>
                                                                <td colspan="2">
                                                                  <div class="">
                                                                    <div class=""></div>
                                                                    <apex:inputText styleClass="attachCat"  size="28" disabled="true" value="{!ArchBluePrintDef.Product_Category__c}" />
                                                                   </div>&nbsp;&nbsp;
                                                                </td>
                                                                <td style="padding-left: 20px; text-align:center; vertical-align: top; color:#808080">Maturity<br/> Model</td>
                                                                <td style="width:4px;">&nbsp;</td>
                                                                <td style="vertical-align: top;">
                                                                    <div class="">
                                                                        <div class=""></div>
                                                                        <apex:inputText styleClass="attachModel"  size="26" disabled="true" value="{!ArchBluePrintDef.Maturity_Model__c}" />
                                                                    </div> 
                                                                </td>
                                                                <td style="width: 10px;">&nbsp;</td>
                                                           </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </table><br/>
                                            <table>
                                                <table>
                                                    <tr>
                                                        <td style="text-align:left;color:#3B76DD; font-size:larger"><b>Utilization of Blueprint in This Design</b></td>
                                                        <td style="text-align:left;color:#808080;">Version Used: <apex:outputText styleClass="pickVersion" value="{!objArchBluePrint.VersionUsed__c}" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">&nbsp;</td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="2">
                                                            <table style="width:100%; outline: 2px solid blue;" cellpadding="4">
                                                                <tr>
                                                                    <td colspan="6" style="padding-bottom: 7px; padding-top: 2px; padding-left: 5px; color:#808080">Enter information below to document how this blueprint was used in this design</td>
                                                                </tr>
                                                                <tr  style="width: 90%;">
                                                                    <td style="padding-left: 20px;vertical-align: top;">Fit%</td>
                                                                    <td style="width:4px;">&nbsp;</td>
                                                                    <td>
                                                                      <div class="">
                                                                        <div class=""></div>
                                                                        <apex:selectList value="{!strSelectedFit}" size="1" id="idFit"  onChange="CheckPercentage('Fit');" style="border-left: 2px solid red;" styleClass="slds-input clsFitPer">
                                                                          <apex:selectOptions value="{!optionListFit}"/>
                                                                        </apex:selectList>
                                                                       </div>&nbsp;&nbsp;
                                                                    </td>
                                                                     <td style="padding-left: 20px; text-align:center; vertical-align: top;">Fit Category</td>
                                                                     <td style="vertical-align: top;">
                                                                         <div class="">
                                                                             <div class=""></div>
                                                                             <apex:selectList value="{!strSelectedFitCategory}" onChange="CheckPercentage('Category');" style="width:100%;border-left: 2px solid red;vertical-align: top;"  size="1" id="idFitCategory" styleClass="clsFitCategory slds-input">
                                                                                 <apex:selectOptions value="{!optionListFitCategory}"/>
                                                                             </apex:selectList>
                                                                        </div> 
                                                                     </td>
                                                                    <td colspan="2">&nbsp;</td>
                                                                    <td>&nbsp;</td>
                                                                </tr>
                                                                <tr style="width: 90%;">
                                                                    <td style="padding-left: 20px;vertical-align: top;">Change Description</td>
                                                                    <td style="width:4px;">&nbsp;</td>
                                                                    <td colspan="3">
                                                                        <div class="">
                                                                            <div class=""></div>
                                                                            <apex:inputTextArea styleClass="clsFitPerReq"  style="{!if(strSelectedFit='100','border-left: 2px solid red;', ' ')}" rows="3" cols="80" value="{!objArchBluePrint.ShortChangeDescription__c}" id="idDesc2"/>
                                                                        </div>&nbsp;&nbsp;
                                                                    </td>
                                                                    <td>&nbsp;</td>
                                                                </tr>
                                                                <tr style="width: 90%;">
                                                                    <td style="padding-left: 20px;vertical-align: top;">Change<br/>Details<br/>Document</td>
                                                                    <td style="width:4px;">&nbsp;</td>
                                                                    <td colspan="3">
                                                                       <div class="">
                                                                          <apex:outputPanel id="atturl2">
                                                                              <apex:inputField value="{!objArchBluePrint.DetailedChangeDescription__c}" style="width:278px;height:39px;line-height: normal;" styleClass="clsDetailChange slds-input"/><br/>
                                                                          </apex:outputpanel>
                                                                          <!-- Priyank added below Div -->
                                                                          <div id="errorMesg1" style="width:100%;color:red;"></div>
                                                                        </div>
                                                                        <input type="file" id="attachmentFile" /> 
                                                                        <apex:outputpanel rendered="{!!objSCE.DSR_SCEngagement__r.Is_Partner_DSR__c}">
                                                                            <button type="button" onclick="uploadFile('Blueprints','{!objSCE.Name}','clsDetailChange');" Class="slds-button slds-button--brand slds-button--small" style="line-height:10px;font-size:15px;padding-left: 10px;padding-right: 10px;">Upload File</button>
                                                                        </apex:outputpanel>
                                                                        <apex:outputpanel rendered="{!objSCE.DSR_SCEngagement__r.Is_Partner_DSR__c}">
                                                                            <button onclick="return uploadFileAttached('clsDetailChange');" Class="slds-button slds-button--brand slds-button--small" style="line-height:10px;font-size:15px;padding-left: 10px;padding-right: 10px;">Upload File</button>
                                                                        </apex:outputpanel>
                                                                    </td>
                                                                    <td>&nbsp;</td>
                                                               </tr>
                                                              
                                                               <tr  style="width: 90%;">
                                                                    <td style="padding-left: 20px;vertical-align: top;">Additional<br/> Usage Notes</td>
                                                                    <td style="width:4px;">&nbsp;</td>
                                                                    <td colspan="3"><apex:inputTextArea rows="3" cols="80" value="{!objArchBluePrint.Notes__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                               </tr>
                                                               
                                                            </table>
                                                        </td>
                                                    </tr>
                                                </table><br/>
                                                
                                                
                                            </table>    
                                     <br/>
                                        </apex:outputPanel>
                                        <div style="text-align: -webkit-center;">
                                            <!--<apex:commandButton value="Save"  action="{!InsertAndUpdateActivity}" reRender="pnlerrorMsg,pnlPopup,pnlPopUp_parent,pnlAllDesigns" style="line-height:10px;font-size:15px;" styleClass="slds-button slds-button--brand slds-button--small" status="spinnerStatus"/>&nbsp;-->
                                            <!-- Priyank commented the above line and added new line below. -->  
                                            <apex:commandButton value="Save"  onclick="validUrlCheck1();return false;" oncomplete="checkMandatoryShortChange();" reRender="pnlerrorMsg_design,pnlPopup_design,pnlPopUp_parent_design,pnlAllActivity,pnlBDP" style="line-height:10px;font-size:15px;" styleClass="slds-button slds-button--brand slds-button--small" status="spinnerStatus"/>&nbsp;
                                            <apex:commandButton value="Cancel" action="{!Cancel}" reRender="pnlerrorMsg_design,pnlPopup_design,pnlPopUp_parent_design,pnlAllActivity"  style="line-height:10px;font-size:15px;" styleClass="slds-button slds-button--brand slds-button--small clsBoxClose" status="spinnerStatus"/>
                                           
                                        </div>
                                    </div> 
                                 </div>  
                               </div>
                              </apex:outputPanel> 
                           </apex:outputPanel>
                           <!-- End : Pop up for UseCase Record --> 
                           <!-- End : Pop up for Design Record -->          
                        <!-- Start : Copy DSO -->       
                            <apex:outputPanel id="copyDSO">                                     
                                <apex:outputPanel styleClass="popupBackground" layout="block" rendered="{!displayCopyDSOPopUP}"/>       
                                <apex:outputPanel styleClass="custPopup" layout="block" rendered="{!displayCopyDSOPopUP}" style="margin-left:-18%; top: 6%; width: 28% !important;">        
                                    
                                    <div style="text-align: -webkit-center;">       
                                        <div style="width:85%;">        
                                            <b style="font-size: larger;">Select CAP you Want to Clone</b><br/>     
                                        </div>      
                                        <div style="width:100%;">       
                                            <apex:pageMessages id="errorMsgCopy" /><br/>        
                                        </div>      
                                    </div>      
                                    <div style="height: 50px;overflow-y: auto;">        
                                        <table>     
                                            <tr>        
                                                <td style="padding: 2px; color:#414a4c;"><b>Enter CAP Name #:</b>                                                                   
                                                </td>       
                                                <td style="padding: 2px; color:#414a4c;">       
                                                    <apex:inputText value="{!dsoId}" styleClass="autoSearchDSO">        
                                                    </apex:inputText>       
                                                    <script>        
                                                        testauto();     
                                                        j$('.autoSearchDSO').attr('autocomplete', 'on');        
                                                    </script>       
                                                </td>       
                                            </tr>       
                                        </table>        
                                    </div>      
                                    <div style="text-align: -webkit-center;">       
                                        <apex:commandButton value="Clone CAP" style="font-weight: bolder; line-height: 40px; font-size: 90%;" styleClass="slds-button slds-button--brand slds-button--small" action="{!copyDSO}" rerender="copyDSO, linkPanel" status="spinnerStatus"/> &nbsp;&nbsp;        
                                        <apex:commandButton value="Cancel" style="font-weight: bolder; line-height: 40px; font-size: 90%;" styleClass="slds-button slds-button--brand slds-button--small" action="{!cancelDSO}" rerender="copyDSO, linkPanel" status="spinnerStatus"/>      
                                    </div>      
                                </apex:outputPanel>     
                            </apex:outputPanel>     
                        <!-- END : Copy DSO -->
                     </div>
                </div>   
              </div>     
            </div>       
          </div>
      </div>
      <script type="text/javascript">
                var maxStringSize = 6000000;    //Maximum String size is 6,000,000 characters
                var maxFileSize = 4350000;      //After Base64 Encoding, this is the max file size
                var chunkSize = 950000;         //Maximum Javascript Remoting message size is 1,000,000 characters
                var attachment;
                var attachmentName;
                var fileSize;
                var positionIndex;
                var doneUploading;
               
            //Method to prepare a file to be attached to the Account bound to the page by the standardController
                function uploadFileAttached(currObj) {
                debugger;
                var IsPartnerDSR = '{!objSCE.DSR_SCEngagement__r.Is_Partner_DSR__c}';
                
                 
                  var file = document.getElementById('attachmentFile').files[0];
                  console.log(file);
                  if(file != undefined) {
                     
                      attachmentName = file.name;
                      var fileReader = new FileReader();
                      fileReader.onloadend = function(e) {
                        attachment = window.btoa(this.result);  //Base 64 encode the file before sending it
                        positionIndex=0;
                        fileSize = attachment.length;
                        console.log("Total Attachment Length: " + fileSize);
                        doneUploading = false;
                        uploadAttachments(currObj);
                      }
                      fileReader.onerror = function(e) {
                        alert("There was an error reading the file.  Please try again.");
                      }
                      fileReader.onabort = function(e) {
                        alert("There was an error reading the file.  Please try again.");
                      }
                     
                      fileReader.readAsBinaryString(file);  //Read the body of the file
                     
                  } else {
                    alert("You must choose a file before trying to upload it");
                  }
                  //j$('.clsSpinner').css('display','none');
                  return false;
                }
                
                 
            //Method to send a file to be attached to the Account bound to the page by the standardController
            //Sends parameters: Account Id, Attachment (body), Attachment Name, and the Id of the Attachment if it exists to the controller   
                function uploadAttachments(currObj) {
                   debugger;
                   j$('.clsSpinner').css('display','block');
                  Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.DSRDesignTechnicalController.FileURLinsert}',attachment, attachmentName, sceid,
                    function(result, event) {
                        debugger;
                      console.log(result);
                      //alert(result);
                      //j$('.clsAttachment.slds-input').val(result);
                      j$('.'+currObj).val(result);
                      j$('.clsSpinner').css('display','none');
                    },
                    {escape: false, timeout: 120000}
                  );
                }
              </script>
    </body>    
 </apex:form> 
</apex:page>