<apex:page controller="BillingSearchContractController" title="Search Billing Setup" tabStyle="Cloud_Billing_Contracts__tab">
    <script>
    $(document).ready(function(){
        // Add smooth scrolling to all links
        $("a").on('click', function(event) {
            
            // Make sure this.hash has a value before overriding default behavior
            if (this.hash !== "") {
                // Prevent default anchor click behavior
                event.preventDefault();
                
                // Store hash
                var hash = this.hash;
                
                // Using jQuery's animate() method to add smooth page scroll
                // The optional number (800) specifies the number of milliseconds it takes to scroll to the specified area
                $('html, body').animate({
                    scrollTop: $(hash).offset().top
                }, 800, function(){
                    
                    // Add hash (#) to URL when done scrolling (default click behavior)
                    window.location.hash = hash;
                });
            } // End if
        });
    });
    </script>


    <apex:tabPanel switchType="client" id="theTabPanel" contentStyle="font-size:105%" value="{!strActiveTab}">

        <apex:tab label="Home" name="Home" id="homeTab">
            <apex:form id="mainForm">
            <apex:pageMessages />
            <apex:pageMessage escape="false" severity="Warning" strength="1" rendered="{!blnHasRatingExceptions}">


                There are Rating Exceptions pending resolution. Please click the link below to view the report.<br/>
                <!--apex:outputLink value="/00OU00000035ISC" target="_blank">View Exceptions Report</apex:outputLink-->
                <apex:commandLink action="{!handleViewExceptionReports}" value="View Exceptions Report" status="status" reRender="theTabPanel" 
                                  oncomplete="document.getElementsById('idExceptionReportSection').scrollIntoView();"/>
                <!--a href="#idExceptionReportSection">View Exceptions Report</a-->
            </apex:pageMessage>

            <apex:pageBlock title="Search Billing Setups">
                <div style="height:20px;">
                    <apex:actionStatus id="status">
                        <apex:facet name="start">
                            Please wait ... &nbsp; <apex:image value="/img/loading.gif"/>
                        </apex:facet>
                    </apex:actionStatus>
                </div>
                <apex:pageBlockSection collapsible="false" title="Available Regions" columns="2">


                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Available Regions" />
                        <apex:selectList value="{!strRegionContractFilter}" size="1" id="Region">


                            <apex:actionSupport event="onchange" action="{!loadContracts}" status="status"/>


                            <!-- Sending blank string as code uses String.isNotEmpty --> 
                            <apex:selectOption itemValue="" itemLabel="All"/>
                            <apex:selectOption itemValue="North America" itemLabel="North America"/>

                            <apex:selectOption itemValue="APAC" itemLabel="APAC"/>
                            <apex:selectOption itemValue="EMEA" itemLabel="EMEA"/>
                            <apex:selectOption itemValue="LATAM" itemLabel="LATAM"/>
                            <!-- Users have this as a Reion option apex:selectOption itemValue="LATIN AMERICA" itemLabel="LATIN AMERICA"/ -->
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockSection collapsible="false" title="Search Billing Setups" columns="2">


                    <apex:pageBlockSectionItem >
                        <apex:outputPanel />
                        <apex:outputPanel />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Subscriber Id" />
                        <apex:inputText value="{!strSubscriberId}"/>                
                    </apex:pageBlockSectionItem>  
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Billing Setup Name" />
                        <apex:inputText value="{!strContractName}" />               
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Tenant Id" />
                        <apex:inputText value="{!strTenantId}"/>                
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Account Name" />
                        <apex:inputText value="{!strAccountName}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Portico Id" />
                        <apex:inputText value="{!strPorticoId}"/>                
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="GARN Account Code" />
                        <apex:inputText value="{!strGARNCode}"/>                
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="PureConnect Id" />
                        <apex:inputText value="{!strPureConnectId}"/>                
                    </apex:pageBlockSectionItem>
                    <!-- ECD 2018-04-10 -->
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Billing Platform Id" />
                        <apex:inputText value="{!strBillingPlatformId}"/>                
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Product Group/Edition"/>
                        <apex:selectList value="{!objSearchDummyOppty.Lines_of_Businesses__c}" size="1" id="ProductGroup">
                            <apex:selectOption itemValue="" itemLabel="--None--"/>
                            <apex:selectOption itemValue="Outbound Engagement" itemLabel="Outbound Engagement"/>
                            <apex:selectOption itemValue="Premier Edition" itemLabel="Premier Edition"/>
                            <apex:selectOption itemValue="PureConnect" itemLabel="PureConnect"/>
                            <apex:selectOption itemValue="PureConnect Subscription" itemLabel="PureConnect Subscription"/>
                            <apex:selectOption itemValue="PureCloud" itemLabel="PureCloud"/>
                            <apex:selectOption itemValue="PureEngage" itemLabel="PureEngage"/>
                            <apex:selectOption itemValue="PureEngage Subscription" itemLabel="PureEngage Subscription"/>
                            <apex:selectOption itemValue="Rental" itemLabel="Rental"/>
                            <apex:selectOption itemValue="Self Service" itemLabel="Self Service"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="PureCloud Id" />
                        <apex:inputText value="{!strPureCloudId}"/>                
                    </apex:pageBlockSectionItem>
                    <apex:outputLabel />
                    <div style="align:center">    
                        <apex:commandButton value="Search" action="{!searchFromCloudDeployment}" style="align:center"/>
                    </div>
                </apex:pageBlockSection>
                <apex:outputPanel id="SearchPanel">
                    <apex:pageBlockSection title="Search Results" columns="1" rendered="{!blnShowSearchResults}">   
                        <apex:outputLabel value="No records found." rendered="{!list_SearchResults.size == 0}"/>        
                        <apex:pageBlockTable value="{!list_SearchResults}" var="objContract" rendered="{!list_SearchResults.size > 0}">






                            <apex:column headerValue="Name">
                                <apex:outputLink value="/apex/QuoteServiceBilling?id={!objContract.Id}" >
                                    {!objContract.Name}
                                </apex:outputLink>
                            </apex:column>
                            <apex:column headerValue="Account">
                                <apex:outputField value="{!objContract.Account_Name__c}"/>
                            </apex:column>
                            <apex:column headerValue="Status">
                                {!objContract.Status__c}                    
                            </apex:column>
                            <apex:column headerValue="Quote">
                                <apex:outputField value="{!objContract.Quote__c}"/>
                            </apex:column>
                            <apex:column headerValue="Region">
                                <apex:outputField value="{!objContract.Account_Name__r.Country__r.Region__c}"/>
                            </apex:column>
                            <apex:column headerValue="Product Group/Edition">
                                <apex:outputField value="{!objContract.Product_Group__c}"/>
                            </apex:column>              
                            <apex:column headerValue="Billing Effective Start Date">
                                <apex:outputField value="{!objContract.Pricing_Start_Date__c}"/>
                            </apex:column>
                            <apex:column headerValue="Expiration Date">
                               <apex:outputField value="{!objContract.Expiration_Renewal_Date__c}"/>
                            </apex:column>
                            <apex:column headerValue="Friendly Name">
                               <apex:outputField value="{!objContract.Name__c}"/>
                            </apex:column>
                        </apex:pageBlockTable>
                    </apex:pageBlockSection>
                </apex:outputPanel>
                </apex:pageBlock>

            <apex:pageBlock title="Action Items">
                <apex:outputPanel id="setupNewBillingContractPanel">
                    <apex:pageBlockSection collapsible="true" title="Create Billing Setup From Account" columns="1">
                        <apex:outputLink value="/apex/CloudBillingContractNew" target="_blank" style="text-decoration:none" styleClass="btn">Create Billing Setup</apex:outputLink>




                    </apex:pageBlockSection>
                    <apex:pageBlockSection collapsible="true" title="Create New Billing Setups" columns="1">


                        <!--<apex:outputPanel rendered="{!list_NewMasterOrders.size > 0}">-->
                        <apex:outputPanel >
                            <apex:selectList id="chooseBillingField" value="{!billingContractSelectedField}" size="1">


                                <apex:selectOptions value="{!billingContractFieldOption}"/>
                            </apex:selectList>
                            &nbsp;&nbsp;
                            <apex:inputText value="{!billingContractSeachValue}"/>
                            &nbsp;&nbsp;
                            <apex:commandButton value="Search" action="{!fetchBillingContractBySearchValue}"


                                                reRender="setupNewBillingContractPanel"/> | &nbsp;
                            <apex:commandButton value="Clear" action="{!clearBillingContractBySearchValue}"


                                                reRender="setupNewBillingContractPanel"/>
                        </apex:outputPanel>
                        
                        <!--<apex:pageBlockTable value="{!list_NewMasterOrders}" var="objOrder" rendered="{!list_NewMasterOrders.size > 0}">-->
                        <apex:pageBlockTable value="{!list_NewMasterOrdersFiltered}" var="objOrder" rendered="{!list_NewMasterOrdersFiltered.size > 0}">




                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchNewMasterOrders}" reRender="setupNewBillingContractPanel"


                                                      value="Account {!IF(sortExpressionOnMasterOrderList=='Quote__r.End_User_ID__r.Name',
                                                             IF(sortDirectionToBillingContract='ASC','▼','▲'),'')}">
                                        <apex:param value="Quote__r.End_User_ID__r.Name" name="column" assignTo="{!sortExpressionOnMasterOrderList}"></apex:param>


                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.Quote__r.End_User_ID__c}" rendered="{!objOrder.Quote__c != null}"/>

                                <apex:outputField value="{!objOrder.Zuora_Quote__r.zqu__Account__c}" rendered="{!objOrder.Zuora_Quote__c != null}"/>

                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchNewMasterOrders}" reRender="setupNewBillingContractPanel"


                                                      value="Opportunity {!IF(sortExpressionOnMasterOrderList=='Quote__r.BigMachines__Opportunity__r.Name',
                                                             IF(sortDirectionToBillingContract='ASC','▼','▲'),'')}">
                                        <apex:param value="Quote__r.BigMachines__Opportunity__r.Name" name="column" assignTo="{!sortExpressionOnMasterOrderList}"></apex:param>


                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.Quote__r.BigMachines__Opportunity__c}" rendered="{!objOrder.Quote__c != null}"/>

                                <apex:outputField value="{!objOrder.Zuora_Quote__r.zqu__Opportunity__c}" rendered="{!objOrder.Zuora_Quote__c != null}"/>

                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchNewMasterOrders}" reRender="setupNewBillingContractPanel"


                                                      value="Product {!IF(sortExpressionOnMasterOrderList=='Offering_Type__c',
                                                             IF(sortDirectionToBillingContract='ASC','▼','▲'),'')}">
                                        <apex:param value="Offering_Type__c" name="column" assignTo="{!sortExpressionOnMasterOrderList}"></apex:param>


                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.Offering_Type__c}"/>
                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchNewMasterOrders}" reRender="setupNewBillingContractPanel"


                                                      value="Quote {!IF(sortExpressionOnMasterOrderList=='Quote',
                                                             IF(sortDirectionToBillingContract='ASC','▼','▲'),'')}">
                                        <apex:param value="Quote" name="column" assignTo="{!sortExpressionOnMasterOrderList}"></apex:param>


                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.Quote__c}" rendered="{!objOrder.Quote__c != null}"/>

                                <apex:outputField value="{!objOrder.Zuora_Quote__c}" rendered="{!objOrder.Zuora_Quote__c != null}"/>

                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchNewMasterOrders}" reRender="setupNewBillingContractPanel"


                                                      value="Order {!IF(sortExpressionOnMasterOrderList=='Name',
                                                             IF(sortDirectionToBillingContract='ASC','▼','▲'),'')}">
                                        <apex:param value="Name" name="column" assignTo="{!sortExpressionOnMasterOrderList}"></apex:param>


                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputLink value="/{!objOrder.Id}" target="_blank">{!objOrder.Name}</apex:outputLink>
                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchNewMasterOrders}" reRender="setupNewBillingContractPanel"


                                                      value="Region {!IF(sortExpressionOnMasterOrderList=='End_User_Name__r.Country__r.Region__c',
                                                             IF(sortDirectionToBillingContract='ASC','▼','▲'),'')}">
                                        <apex:param value="End_User_Name__r.Country__r.Region__c" name="column" assignTo="{!sortExpressionOnMasterOrderList}"></apex:param>


                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.End_User_Name__r.Country__r.Region__c}"/>
                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchNewMasterOrders}" reRender="setupNewBillingContractPanel"


                                                      value="Order Created Date {!IF(sortExpressionOnMasterOrderList=='CreatedDate',
                                                             IF(sortDirectionToBillingContract='ASC','▼','▲'),'')}">
                                        <apex:param value="CreatedDate" name="column" assignTo="{!sortExpressionOnMasterOrderList}"></apex:param>


                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.CreatedDate}"/>
                            </apex:column>
                            
                            <apex:column headerValue="Action" rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractReadOnly)}">
                                <apex:commandlink action="{!createBillingContract}" status="status" reRender="mainForm" styleClass="btn" style="text-decoration:none;">





                                    <apex:param name="strOrderId" assignTo="{!strOrderId}" value="{!objOrder.Id}"/>

                                    Create Billing Setup
                                </apex:commandlink>
                            </apex:column>
                        </apex:pageBlockTable>
                        <!--<apex:outputText rendered="{!list_NewMasterOrders.size = 0}">No new Orders to be setup as Billing Contracts.</apex:outputText>-->
                        <apex:outputText rendered="{!list_NewMasterOrdersFiltered.size = 0}">No new Orders to be setup as Billing Contracts.</apex:outputText>
                    </apex:pageBlockSection>
                </apex:outputPanel>
                
                <apex:outputPanel id="upgradesDowngradesPanel">
                    <apex:pageBlockSection collapsible="true" title="Amendments" columns="1" id="UpgdDngdSection">
                        
                        <apex:outputPanel >
                            <apex:selectList id="chooseUpgradesDowngradeField" value="{!upgradeDowngradeSelectedField}" size="1">
                                <apex:selectOptions value="{!billingContractFieldOption}"/>
                            </apex:selectList>
                            &nbsp;&nbsp;
                            <apex:inputText value="{!upgradeDowngradeSeachValue}"/>
                            &nbsp;&nbsp;

                            <apex:commandButton value="Search" action="{!fecthUpgradeDowngradeBySearchValue}"/> | &nbsp;
                            <apex:commandButton value="Clear" action="{!clearUpgradeDowngradeBySearchValue}"/>
                        </apex:outputPanel>
                        
                        <apex:pageBlockTable value="{!list_UpgradesDowngrades}" var="objOrder" rendered="{!list_UpgradesDowngrades.size > 0}">
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchUpgradesDowngrades}" reRender="upgradesDowngradesPanel"
                                                      value="Account {!IF(sortExpressionOnUpgradeDowngradeOrderList=='Quote__r.End_User_ID__r.Name',
                                                             IF(sortDirectionToUpgradeDowngrade='ASC','▼','▲'),'')}">
                                        <apex:param value="Quote__r.End_User_ID__r.Name" name="column" assignTo="{!sortExpressionOnUpgradeDowngradeOrderList}"></apex:param>
                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.Quote__r.End_User_ID__c}"/>
                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchUpgradesDowngrades}" reRender="upgradesDowngradesPanel"
                                                      value="Opportunity {!IF(sortExpressionOnUpgradeDowngradeOrderList=='Quote__r.BigMachines__Opportunity__r.Name',
                                                             IF(sortDirectionToUpgradeDowngrade='ASC','▼','▲'),'')}">
                                        <apex:param value="Quote__r.BigMachines__Opportunity__r.Name" name="column" assignTo="{!sortExpressionOnUpgradeDowngradeOrderList}"></apex:param>
                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.Quote__r.BigMachines__Opportunity__c}"/>
                            </apex:column>

                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchUpgradesDowngrades}" reRender="upgradesDowngradesPanel"
                                                      value="Product {!IF(sortExpressionOnUpgradeDowngradeOrderList=='Offering_Type__c',
                                                             IF(sortDirectionToUpgradeDowngrade='ASC','▼','▲'),'')}">
                                        <apex:param value="Offering_Type__c" name="column" assignTo="{!sortExpressionOnUpgradeDowngradeOrderList}"></apex:param>
                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.Offering_Type__c}"/>
                            </apex:column>                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchUpgradesDowngrades}" reRender="upgradesDowngradesPanel"
                                                      value="Quote {!IF(sortExpressionOnUpgradeDowngradeOrderList=='Quote__r.Name',
                                                             IF(sortDirectionToUpgradeDowngrade='ASC','▼','▲'),'')}">
                                        <apex:param value="Quote__r.Name" name="column" assignTo="{!sortExpressionOnUpgradeDowngradeOrderList}"></apex:param>
                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.Quote__c}"/>
                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchUpgradesDowngrades}" reRender="upgradesDowngradesPanel"
                                                      value="Order {!IF(sortExpressionOnUpgradeDowngradeOrderList=='Name',
                                                             IF(sortDirectionToUpgradeDowngrade='ASC','▼','▲'),'')}">
                                        <apex:param value="Name" name="column" assignTo="{!sortExpressionOnUpgradeDowngradeOrderList}"></apex:param>
                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputLink value="/{!objOrder.Id}" target="_blank">{!objOrder.Name}</apex:outputLink>
                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchUpgradesDowngrades}" reRender="upgradesDowngradesPanel"
                                                      value="Order Created Date {!IF(sortExpressionOnUpgradeDowngradeOrderList=='CreatedDate',
                                                             IF(sortDirectionToUpgradeDowngrade='ASC','▼','▲'),'')}">
                                        <apex:param value="CreatedDate" name="column" assignTo="{!sortExpressionOnUpgradeDowngradeOrderList}"></apex:param>
                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.CreatedDate}"/>
                            </apex:column>
                            
                            <apex:column headerValue="Action" rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractReadOnly)}">
                                <apex:commandlink action="{!createBillingContract}" status="status" reRender="mainForm" styleClass="btn" style="text-decoration:none;">
                                    <apex:param name="strOrderId" assignTo="{!strOrderId}" value="{!objOrder.Id}"/>
                                    Create Billing Setup
                                </apex:commandlink>
                            </apex:column>
                        </apex:pageBlockTable>
                        <apex:outputText rendered="{!list_UpgradesDowngrades.size = 0}">No Amendments Pending.</apex:outputText>
                    </apex:pageBlockSection>
                </apex:outputPanel>
                
                <apex:outputPanel id="renewalsPanel">
                    <apex:pageBlockSection collapsible="true" title="Renewals" columns="1" id="RenewalsSection">
                        <apex:outputPanel >
                            <apex:selectList id="chooseRenewalField" value="{!renewalSelectedField}" size="1">
                                <apex:selectOptions value="{!billingContractFieldOption}"/>
                            </apex:selectList>
                            &nbsp;&nbsp;
                            <apex:inputText value="{!renewalSeachValue}"/>
                            &nbsp;&nbsp;

                            <apex:commandButton value="Search" action="{!fetchRenewalBySearchValue}"/> | &nbsp;
                            <apex:commandButton value="Clear" action="{!clearRenewalBySearchValue}"/>
                        </apex:outputPanel>
                        
                        <apex:pageBlockTable value="{!list_Renewals}" var="objOrder" rendered="{!list_Renewals.size > 0}">
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchRenewals}" reRender="renewalsPanel"
                                                      value="Account {!IF(sortExpressionOnRenewalOrderList=='Quote__r.End_User_ID__r.Name',
                                                             IF(sortDirectionToRenewal='ASC','▼','▲'),'')}">
                                        <apex:param value="Quote__r.End_User_ID__r.Name" name="column" assignTo="{!sortExpressionOnRenewalOrderList}"></apex:param>
                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.Quote__r.End_User_ID__c}"/>
                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchRenewals}" reRender="renewalsPanel"
                                                      value="Opportunity {!IF(sortExpressionOnRenewalOrderList=='Quote__r.BigMachines__Opportunity__r.Name',
                                                             IF(sortDirectionToRenewal='ASC','▼','▲'),'')}">
                                        <apex:param value="Quote__r.BigMachines__Opportunity__r.Name" name="column" assignTo="{!sortExpressionOnRenewalOrderList}"></apex:param>
                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.Quote__r.BigMachines__Opportunity__c}"/>
                            </apex:column>
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchRenewals}" reRender="renewalsPanel"
                                                      value="Product {!IF(sortExpressionOnRenewalOrderList=='Offering_Type__c',
                                                             IF(sortDirectionToRenewal='ASC','▼','▲'),'')}">
                                        <apex:param value="Offering_Type__c" name="column" assignTo="{!sortExpressionOnRenewalOrderList}"></apex:param>
                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.Offering_Type__c}"/>
                            </apex:column>                            
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchRenewals}" reRender="renewalsPanel"
                                                      value="Quote {!IF(sortExpressionOnRenewalOrderList=='Quote__r.Name',
                                                             IF(sortDirectionToRenewal='ASC','▼','▲'),'')}">
                                        <apex:param value="Quote__r.Name" name="column" assignTo="{!sortExpressionOnRenewalOrderList}"></apex:param>
                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.Quote__c}"/>
                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchRenewals}" reRender="renewalsPanel"
                                                      value="Order {!IF(sortExpressionOnRenewalOrderList=='Name',
                                                             IF(sortDirectionToRenewal='ASC','▼','▲'),'')}">
                                        <apex:param value="Name" name="column" assignTo="{!sortExpressionOnRenewalOrderList}"></apex:param>
                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputLink value="/{!objOrder.Id}" target="_blank">{!objOrder.Name}</apex:outputLink>
                            </apex:column>
                            
                            <apex:column >
                                <apex:facet name="header">
                                    <apex:commandLink action="{!fetchRenewals}" reRender="renewalsPanel"
                                                      value="Order Created Date {!IF(sortExpressionOnRenewalOrderList=='CreatedDate',
                                                             IF(sortDirectionToRenewal='ASC','▼','▲'),'')}">
                                        <apex:param value="CreatedDate" name="column" assignTo="{!sortExpressionOnRenewalOrderList}"></apex:param>
                                    </apex:commandLink>
                                </apex:facet>
                                <apex:outputField value="{!objOrder.CreatedDate}"/>
                            </apex:column>
                            
                            <apex:column headerValue="Action" rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractReadOnly)}">
                                <apex:commandlink action="{!createBillingContract}" status="status" reRender="mainForm" styleClass="btn" style="text-decoration:none;">
                                    <apex:param name="strOrderId" assignTo="{!strOrderId}" value="{!objOrder.Id}"/>
                                    Create Billing Setup
                                </apex:commandlink>
                            </apex:column>
                        </apex:pageBlockTable>
                        <apex:outputText rendered="{!list_Renewals.size = 0}">No Renewals Pending.</apex:outputText>
                    </apex:pageBlockSection>
                </apex:outputPanel>
                
                
            </apex:pageBlock>
            <apex:pageBlock title="Billing Setups">
                <apex:pageBlockSection collapsible="true" title="New" columns="1" rendered="{!list_NewContracts.size > 0}">


                    <apex:pageBlockTable value="{!list_NewContracts}" var="objContract" >

                        <apex:column headerValue="Name">
                            <apex:outputLink value="/apex/QuoteServiceBilling?id={!objContract.Id}" >
                                {!objContract.Name}
                            </apex:outputLink>
                        </apex:column>
                        <apex:column headerValue="Account">
                            <apex:outputField value="{!objContract.Account_Name__c}"/>
                        </apex:column>
                        <apex:column headerValue="Status">
                            {!objContract.Status__c}                    
                        </apex:column>
                        <apex:column headerValue="Quote">
                            <apex:outputField value="{!objContract.Quote__c}" rendered="{!objContract.Quote__c != null}"/>

                            <apex:outputField value="{!objContract.Zuora_Quote__c}" rendered="{!objContract.Zuora_Quote__c != null}"/>

                        </apex:column>
                        <apex:column headerValue="Region">
                            <apex:outputField value="{!objContract.Account_Name__r.Country__r.Region__c}"/>
                        </apex:column>
                        <apex:column headerValue="Product Group/Edition">
                            <apex:outputField value="{!objContract.Product_Group__c}"/>
                        </apex:column>                  
                        <apex:column headerValue="Billing Effective Start Date">
                           <apex:outputField value="{!objContract.Pricing_Start_Date__c}"/>
                        </apex:column>
                        <apex:column headerValue="Expiration Date">
                           <apex:outputField value="{!objContract.Expiration_Renewal_Date__c}"/>
                        </apex:column>
                        <apex:column headerValue="Friendly Name">
                           <apex:outputField value="{!objContract.Name__c}"/>
                        </apex:column>          
                    </apex:pageBlockTable>
                </apex:pageBlockSection>
                
                <apex:pageBlockSection collapsible="true" title="In Progress" columns="1" rendered="{!list_InProgressContracts.size > 0}">


                    <apex:pageBlockTable value="{!list_InProgressContracts}" var="objContract" >

                        <apex:column headerValue="Name">
                            <apex:outputLink value="/apex/QuoteServiceBilling?id={!objContract.Id}" >
                                {!objContract.Name}
                            </apex:outputLink>
                        </apex:column>
                        <apex:column headerValue="Account">
                            <apex:outputField value="{!objContract.Account_Name__c}"/>
                        </apex:column>
                        <apex:column headerValue="Status">
                            {!objContract.Status__c}                    
                        </apex:column>
                        <apex:column headerValue="Quote">
                            <apex:outputField value="{!objContract.Quote__c}" rendered="{!objContract.Quote__c != null}"/>

                            <apex:outputField value="{!objContract.Zuora_Quote__c}" rendered="{!objContract.Zuora_Quote__c != null}"/>

                        </apex:column>
                        <apex:column headerValue="Region">
                            <apex:outputField value="{!objContract.Account_Name__r.Country__r.Region__c}"/>
                        </apex:column>
                        <apex:column headerValue="Product Group/Edition">
                            <apex:outputField value="{!objContract.Product_Group__c}"/>
                        </apex:column>                  
                        <apex:column headerValue="Billing Effective Start Date">
                           <apex:outputField value="{!objContract.Pricing_Start_Date__c}"/>
                        </apex:column>
                        <apex:column headerValue="Expiration Date">
                           <apex:outputField value="{!objContract.Expiration_Renewal_Date__c}"/>
                        </apex:column>    
                        <apex:column headerValue="Friendly Name">
                           <apex:outputField value="{!objContract.Name__c}"/>
                        </apex:column>       
                    </apex:pageBlockTable>
                </apex:pageBlockSection>
                
                <apex:pageBlockSection collapsible="true" title="Awaiting Approval" columns="1" rendered="{!list_AwaitingApprovalContracts.size > 0}">
                    <apex:pageBlockTable value="{!list_AwaitingApprovalContracts}" var="objContract">




                        <apex:column headerValue="Name">
                            <apex:outputLink value="/apex/QuoteServiceBilling?id={!objContract.Id}" >
                                {!objContract.Name}
                            </apex:outputLink>
                        </apex:column>
                        <apex:column headerValue="Account">
                            <apex:outputField value="{!objContract.Account_Name__c}"/>
                        </apex:column>
                        <apex:column headerValue="Status">
                            {!objContract.Status__c}                    
                        </apex:column>
                        <apex:column headerValue="Quote">
                            <apex:outputField value="{!objContract.Quote__c}" rendered="{!objContract.Quote__c != null}"/>

                            <apex:outputField value="{!objContract.Zuora_Quote__c}" rendered="{!objContract.Zuora_Quote__c != null}"/>

                        </apex:column>
                        <apex:column headerValue="Region">
                            <apex:outputField value="{!objContract.Account_Name__r.Country__r.Region__c}"/>
                        </apex:column>
                        <apex:column headerValue="Product Group/Edition">
                            <apex:outputField value="{!objContract.Product_Group__c}"/>
                        </apex:column>                  
                        <apex:column headerValue="Billing Effective Start Date">
                           <apex:outputField value="{!objContract.Pricing_Start_Date__c}"/>
                        </apex:column>
                        <apex:column headerValue="Expiration Date">
                           <apex:outputField value="{!objContract.Expiration_Renewal_Date__c}"/>
                        </apex:column>   
                        <apex:column headerValue="Friendly Name">
                           <apex:outputField value="{!objContract.Name__c}"/>
                        </apex:column>        
                    </apex:pageBlockTable>
                </apex:pageBlockSection>
                
                <apex:pageBlockSection collapsible="true" title="Hold" columns="1" rendered="{!list_HoldContracts.size > 0}">


                    <apex:pageBlockTable value="{!list_HoldContracts}" var="objContract" >

                        <apex:column headerValue="Name">
                            <apex:outputLink value="/apex/QuoteServiceBilling?id={!objContract.Id}" >
                                {!objContract.Name}
                            </apex:outputLink>
                        </apex:column>
                        <apex:column headerValue="Account">
                            <apex:outputField value="{!objContract.Account_Name__c}"/>
                        </apex:column>
                        <apex:column headerValue="Status">
                            {!objContract.Status__c}                    
                        </apex:column>
                        <apex:column headerValue="Quote">
                            <apex:outputField value="{!objContract.Quote__c}" rendered="{!objContract.Quote__c != null}"/>

                            <apex:outputField value="{!objContract.Zuora_Quote__c}" rendered="{!objContract.Zuora_Quote__c != null}"/>

                        </apex:column>
                        <apex:column headerValue="Region">
                            <apex:outputField value="{!objContract.Account_Name__r.Country__r.Region__c}"/>
                        </apex:column>
                        <apex:column headerValue="Product Group/Edition">
                            <apex:outputField value="{!objContract.Product_Group__c}"/>
                        </apex:column>                  
                        <apex:column headerValue="Billing Effective Start Date">
                           <apex:outputField value="{!objContract.Pricing_Start_Date__c}"/>
                        </apex:column>
                        <apex:column headerValue="Expiration Date">
                           <apex:outputField value="{!objContract.Expiration_Renewal_Date__c}"/>
                        </apex:column>  
                        <apex:column headerValue="Friendly Name">
                           <apex:outputField value="{!objContract.Name__c}"/>
                        </apex:column>         
                    </apex:pageBlockTable>
                </apex:pageBlockSection>
                <!--
                <apex:pageBlockSection collapsible="true" title="Credit Memos" columns="1" id="ABISection">
                    <apex:pageBlockTable value="{!list_AccountBillingInfo}" var="objABI" rendered="{!list_AccountBillingInfo.size > 0}">
                        <apex:column headerValue="Name">
                            <apex:outputLink value="/{!objABI.Id}" target="_blank">{!objABI.Name}</apex:outputLink>
                        </apex:column>
                        <apex:column headerValue="Account">
                            <apex:outputLink value="/{!objABI.Sold_To_NS_Bill_To__c}" target="_blank">{!objABI.Sold_To_NS_Bill_To__r.Name}</apex:outputLink>
                            ****Comment this  line Jun 29, 2017 <!-- apex:outputField value="{!objABI.Sold_To_NS_Bill_To__r.Name}"/
                        </apex:column>
                        <apex:column headerValue="Order">
                            <apex:outputLink value="/{!objABI.Order__c}" target="_blank">{!objABI.Order__r.Name}</apex:outputLink>
                            ****Comment this  line Jun 29, 2017  <!-- apex:outputField value="{!objABI.Order__r.Name}"/
                        </apex:column>
                        <apex:column headerValue="Region">
                            <apex:outputField value="{!objABI.Sold_To_NS_Bill_To__r.Country__r.Region__c}"/>
                        </apex:column>
                        <apex:column headerValue="SF Status">
                            <apex:outputField value="{!objABI.Status__c}"/>
                        </apex:column>
                        <apex:column headerValue="NS Status">
                            <apex:outputField value="{!objABI.NS_Status__c}"/>
                        </apex:column>
                        <apex:column headerValue="Date">
                            <apex:outputField value="{!objABI.Date__c}"/>
                        </apex:column>
                        <apex:column headerValue="Order Date">
                            <apex:outputField value="{!objABI.Order__r.Invoice_Date__c}"/>
                        </apex:column>
                    </apex:pageBlockTable>
                    <apex:outputText rendered="{!list_AccountBillingInfo.size = 0}">None pending.</apex:outputText>
                </apex:pageBlockSection>
                -->
                        
                <apex:pageBlockSection collapsible="true" title="Recent Billing Setups" columns="1">


                    <apex:outputLabel value="No records found." rendered="{!list_RecentContracts.size == 0}"/>
                    <apex:pageBlockTable value="{!list_RecentContracts}" var="objContract" rendered="{!list_RecentContracts.size > 0}">



                        <apex:column headerValue="Name">
                            <apex:outputLink value="/apex/QuoteServiceBilling?id={!objContract.Id}" >
                                {!objContract.Name}
                            </apex:outputLink>
                        </apex:column>
                        <apex:column headerValue="Account">
                            <apex:outputField value="{!objContract.Account_Name__c}"/>
                        </apex:column>
                        <apex:column headerValue="Status">
                            {!objContract.Status__c}                    
                        </apex:column>
                        <apex:column headerValue="Quote">
                            <apex:outputField value="{!objContract.Quote__c}" rendered="{!objContract.Quote__c != null}"/>

                            <apex:outputField value="{!objContract.Zuora_Quote__c}" rendered="{!objContract.Zuora_Quote__c != null}"/>

                        </apex:column>
                        <apex:column headerValue="Region">
                            <apex:outputField value="{!objContract.Account_Name__r.Country__r.Region__c}"/>
                        </apex:column>
                        <apex:column headerValue="Product Group/Edition">
                            <apex:outputField value="{!objContract.Product_Group__c}"/>
                        </apex:column>                  
                        <apex:column headerValue="Billing Effective Start Date">
                           <apex:outputField value="{!objContract.Pricing_Start_Date__c}"/>
                        </apex:column>
                        <apex:column headerValue="Expiration Date">
                           <apex:outputField value="{!objContract.Expiration_Renewal_Date__c}"/>
                        </apex:column>   
                        <apex:column headerValue="Friendly Name">
                           <apex:outputField value="{!objContract.Name__c}"/>
                        </apex:column>        
                    </apex:pageBlockTable>
                </apex:pageBlockSection>        
            </apex:pageBlock>
            </apex:form>
        </apex:tab>
        <apex:tab label="Admin" name="admin">
            <apex:form >
            <apex:pageBlock title="Admin Options">
                <apex:pageMessages id="msgs"/>
                <apex:pageBlockSection collapsible="false" columns="1" title="Rate Rollup Usage Data" rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractManager) && NOT(blnIsContractReadOnly)}">



                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Run Rating Job"/>
                        <apex:commandButton value="Execute" action="{!runRatingJob}" status="status" reRender="msgs"/>

                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Run Reconcile Job"/>
                        <apex:commandButton value="Execute" action="{!runReconcileJob}" status="status" reRender="msgs"/>

                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="View Cloud Billing Logs"/>
                        <apex:outputLink value="/a9n?fcf=00BU0000004GmIi" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockSection collapsible="false" columns="2" title="Exception Reports" id="idExceptionReportSection">
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Services Exception Report"/>
                        <apex:outputLink value="/00O0B000003ifWC" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Premier Exception Report"/>
                        <apex:outputLink value="/00O0B000003iSAh" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="PureEngage Exception Report"/>
                        <apex:outputLink value="/00O0B000003iSAc" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="PureConnect Exception Report"/>
                        <apex:outputLink value="/00O0B000003ihBa" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>


                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>

                <apex:pageBlockSection collapsible="false" columns="2" title="Month/Year/Subsidiary Options for Invoicing and Reporting">
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Day">
                            <apex:image url="{!$Resource.HelpIcon}" width="15px;" height="15px"


                                        title="For Monthly Order Creation Job, selecting the day choses which contract start days orders are created for. If you select 15, only contracts starting on the 15th of the month with have orders created. This dropdown is only relevant for the Monthly Order Creation Job. Monthly Invoice Creation Job, Send Invoices and Run ETL Detail Reports buttons will only pay attention to the Month and Year Downdowns."/>
                        </apex:outputLabel>
                        <apex:selectList value="{!objJobLog.Day__c}" size="1">
                            <apex:selectOption itemValue="" itemLabel="--None--"/>
                            <apex:selectOption itemValue="1" itemLabel="1"/>
                            <apex:selectOption itemValue="2" itemLabel="2"/>
                            <apex:selectOption itemValue="3" itemLabel="3"/>
                            <apex:selectOption itemValue="4" itemLabel="4"/>
                            <apex:selectOption itemValue="5" itemLabel="5"/>
                            <apex:selectOption itemValue="6" itemLabel="6"/>
                            <apex:selectOption itemValue="7" itemLabel="7"/>
                            <apex:selectOption itemValue="8" itemLabel="8"/>
                            <apex:selectOption itemValue="9" itemLabel="9"/>
                            <apex:selectOption itemValue="10" itemLabel="10"/>
                            <apex:selectOption itemValue="11" itemLabel="11"/>
                            <apex:selectOption itemValue="12" itemLabel="12"/>
                            <apex:selectOption itemValue="13" itemLabel="13"/>
                            <apex:selectOption itemValue="14" itemLabel="14"/>
                            <apex:selectOption itemValue="15" itemLabel="15"/>
                            <apex:selectOption itemValue="16" itemLabel="16"/>
                            <apex:selectOption itemValue="17" itemLabel="17"/>
                            <apex:selectOption itemValue="18" itemLabel="18"/>
                            <apex:selectOption itemValue="19" itemLabel="19"/>
                            <apex:selectOption itemValue="20" itemLabel="20"/>
                            <apex:selectOption itemValue="21" itemLabel="21"/>
                            <apex:selectOption itemValue="22" itemLabel="22"/>
                            <apex:selectOption itemValue="23" itemLabel="23"/>
                            <apex:selectOption itemValue="24" itemLabel="24"/>
                            <apex:selectOption itemValue="25" itemLabel="25"/>
                            <apex:selectOption itemValue="26" itemLabel="26"/>
                            <apex:selectOption itemValue="27" itemLabel="27"/>
                            <apex:selectOption itemValue="28" itemLabel="28"/>
                            <apex:selectOption itemValue="29" itemLabel="29"/>
                            <apex:selectOption itemValue="30" itemLabel="30"/>
                            <apex:selectOption itemValue="31" itemLabel="31"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractManager) && NOT(blnIsContractReadOnly)}">
                        <apex:outputLabel value="Subsidiary" for="Subsidiary"/>
                        <apex:outputPanel layout="block" styleClass="requiredInput">
                            <apex:outputPanel styleClass="requiredBlock"/>
                            <apex:selectList value="{!strSubsidiary}" size="1" id="Subsidiary">


                                <apex:selectOption itemValue="" itemLabel="--None--"/>
                                <apex:selectOption itemValue="All" itemLabel="All"/>
                                <apex:selectOption itemValue="8100" itemLabel="8100"/>
                                <apex:selectOption itemValue="8110" itemLabel="8110"/>
                                <apex:selectOption itemValue="8325" itemLabel="8325"/>

                                <apex:selectOption itemValue="8375" itemLabel="8375"/> <!-- This option is added by Vijay - Aug 9th 2017 - Request came from Wendy-->
                                <apex:selectOption itemValue="8400" itemLabel="8400"/>
                                <apex:selectOption itemValue="8420" itemLabel="8420"/>
                            </apex:selectList>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Month">
                            <apex:image url="{!$Resource.HelpIcon}" width="15px;" height="15px"
                                        title="For Monthly Order Creation Job, Monthly Invoice Creation Job, Send Invoices and Run ETL Detail Reports, selecting the month choses which Orders/Invoices/Report to process."/>
                        </apex:outputLabel>
                        <apex:selectList value="{!objJobLog.Month__c}" size="1">
                            <apex:selectOption itemValue="" itemLabel="--None--"/>
                            <apex:selectOption itemValue="1" itemLabel="Jan"/>
                            <apex:selectOption itemValue="2" itemLabel="Feb"/>
                            <apex:selectOption itemValue="3" itemLabel="Mar"/>
                            <apex:selectOption itemValue="4" itemLabel="Apr"/>
                            <apex:selectOption itemValue="5" itemLabel="May"/>
                            <apex:selectOption itemValue="6" itemLabel="Jun"/>
                            <apex:selectOption itemValue="7" itemLabel="Jul"/>
                            <apex:selectOption itemValue="8" itemLabel="Aug"/>
                            <apex:selectOption itemValue="9" itemLabel="Sep"/>
                            <apex:selectOption itemValue="10" itemLabel="Oct"/>
                            <apex:selectOption itemValue="11" itemLabel="Nov"/>
                            <apex:selectOption itemValue="12" itemLabel="Dec"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractManager) && NOT(blnIsContractReadOnly)}">
                        <apex:outputLabel value="Region" for="Region"/>
                        <apex:outputPanel layout="block" styleClass="requiredInput">
                            <apex:outputPanel styleClass="requiredBlock"/>
                            <apex:selectList value="{!strRegion}" size="1" id="Region">
                                <apex:selectOption itemValue="" itemLabel="--None--"/>
                                <apex:selectOption itemValue="All" itemLabel="All"/>
                                <apex:selectOption itemValue="North America" itemLabel="North America"/>

                                <apex:selectOption itemValue="APAC" itemLabel="APAC"/>
                                <apex:selectOption itemValue="EMEA" itemLabel="EMEA"/>
                                <apex:selectOption itemValue="LATAM" itemLabel="LATAM"/>
                            </apex:selectList>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Year" for="Year">
                            <apex:image url="{!$Resource.HelpIcon}" width="15px;" height="15px"


                                        title="For Monthly Order Creation Job, Monthly Invoice Creation Job, Send Invoices and Run ETL Detail Reports, selecting the year choses which Orders/Invoices/Report to process."/>
                        </apex:outputLabel>
                        <apex:inputField value="{!objJobLog.Year__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractManager) && NOT(blnIsContractReadOnly)}">
                        <apex:outputLabel value="Edition" for="Edition"/>
                        <apex:outputPanel layout="block" styleClass="requiredInput">
                            <apex:outputPanel styleClass="requiredBlock"/>
                            <apex:selectList value="{!strEdition}" size="1" id="Edition">
                                <apex:selectOption itemValue="" itemLabel="--None--"/>
                                <apex:selectOption itemValue="All" itemLabel="All"/>
                                <apex:selectOption itemValue="Outbound Engagement" itemLabel="Outbound Engagement"/>

                                <apex:selectOption itemValue="Premier Edition" itemLabel="Premier Edition"/>

                                <apex:selectOption itemValue="PureConnect" itemLabel="PureConnect"/>
                                <apex:selectOption itemValue="PureConnect Subscription" itemLabel="PureConnect Subscription"/>
                                <apex:selectOption itemValue="PureCloud" itemLabel="PureCloud"/>
                                <apex:selectOption itemValue="PureEngage" itemLabel="PureEngage"/>
                                <apex:selectOption itemValue="PureEngage Subscription" itemLabel="PureEngage Subscription"/>
                                <!--<apex:selectOption itemValue="Rental" itemLabel="Rental"/>-->
                                <apex:selectOption itemValue="Self Service" itemLabel="Self Service"/>                                


                            </apex:selectList>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractManager) && NOT(blnIsContractReadOnly)}">
                        <apex:outputLabel value="Pre-Bill" for="PreBill"/>
                        <apex:outputPanel layout="block" styleClass="requiredInput">
                            <apex:inputCheckbox value="{!blnPreBill}" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockSection collapsible="true" columns="2" title="Monthly Billing Orders and Invoices (Execute)">


                    <apex:pageBlockSectionItem rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractManager) && NOT(blnIsContractReadOnly)}">
                        <apex:outputLabel value="Billing Setup Contract (Optional)"/>
                        <apex:inputField value="{!objJobLog.Contract__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractManager) && NOT(blnIsContractReadOnly)}">
                        <apex:outputLabel value="Monthly Order Creation Job"/>
                        <!--apex:actionFunction name="myRunOrderCreationJob" action="{!runOrderCreationJob}" rerender=""/-->
                        <apex:commandButton value="Execute" status="status" reRender="msgs" action="{!runOrderCreationJob}"
                                            onclick="if(!confirm('Order Creation now no longer replaces In Progress Orders but creates a new Order. This includes bulk processes. Do you wish to proceed?')){return false};" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractManager) && NOT(blnIsContractReadOnly)}">
                        <apex:outputLabel value="Apply Tax & Fees"/>
                        <apex:commandButton value="Execute" action="{!runOrderLineItemTaxJob}" status="status" reRender="msgs"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractManager) && NOT(blnIsContractReadOnly)}">
                        <apex:outputLabel value="Monthly Invoice Creation Job"/>

                        <apex:commandButton value="Execute" action="{!runInvoiceCreationJob}" status="status" reRender="msgs"/>

                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!NOT(blnIsContractApprover) && NOT(blnIsContractManager) && NOT(blnIsContractReadOnly)}">
                        <apex:outputLabel value="Send Invoices"/>

                        <apex:commandButton value="Execute" action="{!sendInvoicesHandler}" status="status" reRender="msgs"/>
                    </apex:pageBlockSectionItem>
                    <!--apex:pageBlockSectionItem >
                        <apex:outputLabel value="Run ETL Detail Reports"/>
                        <apex:commandButton value="Execute" action="{!runReportRequests}" status="status" reRender="msgs"/>

                    </apex:pageBlockSectionItem-->
                </apex:pageBlockSection>
                <apex:pageBlockSection collapsible="true" columns="2" title="Reports Requiring Month/Year">


                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Monthly Billing Orders by Month/Year"/>
                        <apex:commandLink value="View" action="{!viewOrdersByMonth}" target="_blank" style="text-decoration:none" styleClass="btn"/>

                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="All Monthly Billing Orders"/>
                        <apex:outputLink value="/00OU00000035ISI" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>


                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Monthly Invoices"/>
                        <apex:commandLink value="View" action="{!viewInvoicesByMonth}" target="_blank" style="text-decoration:none" styleClass="btn"/>

                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Monthly Reconciliation Report"/>
                        <apex:commandLink value="View" action="{!viewReconciliationByMonth}" target="_blank" style="text-decoration:none" styleClass="btn"/>



                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Monthly Cloud Billing Orders Deferred"/>
                        <apex:commandLink value="View" action="{!viewDeferredOrdersByMonth}" target="_blank" style="text-decoration:none" styleClass="btn"/>



                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Monthly Cloud Billing Orders Installment Plan"/>

                        <apex:commandLink value="View" action="{!viewInstallmentOrdersByMonth}" target="_blank" style="text-decoration:none" styleClass="btn"/>

                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockSection collapsible="true" columns="2" title="Reports Not Requiring Month/Year">


                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="All Client Product Mappings"/>
                        <apex:outputLink value="/a9l?fcf=00BU0000004GmId" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>


                    </apex:pageBlockSectionItem>
                    <!--apex:pageBlockSectionItem >
                        <apex:outputLabel value="Unassigned Cloud Deployments"/>
                        <apex:outputLink value="/00O0B000003SJ7C" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>


                    </apex:pageBlockSectionItem-->
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="All Approved Billing Setups"/>
                        <apex:outputLink value="/00OU00000035MbW" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>


                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Expiring Billing Setups(Next 90 days)"/>
                        <apex:outputLink value="/00OU00000035ISG" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>


                    </apex:pageBlockSectionItem>
                    <!--apex:pageBlockSectionItem >
                        <apex:outputLabel value="All Credit Memos"/>
                        <apex:outputLink value="/aBA?fcf=00BU0000004c8ep" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>


                    </apex:pageBlockSectionItem-->
                    <!--apex:pageBlockSectionItem >
                        <apex:outputLabel value="Cloud Currency Conversions"/>
                        <apex:outputLink value="/aDA?fcf=00BU0000004cDJV" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>


                    </apex:pageBlockSectionItem-->
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="CB Setup PO Summary Expiring 90 days"/>
                        <apex:outputLink value="/00OU0000003hHSp" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>


                    </apex:pageBlockSectionItem>
                    <!--apex:pageBlockSectionItem >
                        <apex:outputLabel value="View ETL Detail Reports"/>
                        <apex:outputLink value="/aF1?fcf=00B0B000004kEpq" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>


                    </apex:pageBlockSectionItem-->
                    <!--apex:pageBlockSectionItem >
                        <apex:outputLabel value="View Credit Memo Reports"/>
                        <apex:outputLink value="/00On0000000XFB3" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>


                    </apex:pageBlockSectionItem-->
                </apex:pageBlockSection>
                <apex:pageBlockSection collapsible="true" columns="2" title="Subscription File Delivery Reports">

                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="PureConnect Burst Expected Files CS">
                            <apex:image url="{!$Resource.HelpIcon}" width="15px;" height="15px" title="Based on Billing Year Dropdown"/>
                        </apex:outputLabel>
                        <apex:commandLink value="View" action="{!viewPureConnectBurstExpectedFilesCS}" target="_blank" style="text-decoration:none" styleClass="btn"/>
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="PureEngage Burst Expected Files CS">
                            <apex:image url="{!$Resource.HelpIcon}" width="15px;" height="15px" title="Based on Billing Year Dropdown"/>
                        </apex:outputLabel>
                        <apex:commandLink value="View" action="{!viewPureEngageBurstExpectedFilesCS}" target="_blank" style="text-decoration:none" styleClass="btn"/>
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="PureConnect Burst Files Late OM">
                            <apex:image url="{!$Resource.HelpIcon}" width="15px;" height="15px" title="All, not based on Month and Year Dropdowns"/>
                        </apex:outputLabel>
                        <apex:outputLink value="/00O0B000003td9o" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>
                    </apex:pageBlockSectionItem>

                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="PureEngage Burst Files Late OM">
                            <apex:image url="{!$Resource.HelpIcon}" width="15px;" height="15px" title="All, not based on Month and Year Dropdowns"/>
                        </apex:outputLabel>
                        <apex:outputLink value="/00O0B000003td9q" target="_blank" style="text-decoration:none" styleClass="btn">View</apex:outputLink>
                    </apex:pageBlockSectionItem>

                </apex:pageBlockSection>                
            </apex:pageBlock>
            </apex:form>
        </apex:tab>       
    </apex:tabPanel>
    <div style="height:15px;">
        <apex:actionStatus id="status">
            <apex:facet name="start">    
            <apex:outputPanel id="popPanel">
                <apex:outputPanel styleClass="popupBackground" layout="block"/>
                <apex:outputPanel styleClass="custPopup" layout="block">
                    <apex:outputPanel layout="block" style="text-align:center;">
                        Please wait ... &nbsp; <apex:image value="/img/loading.gif"/>
                    </apex:outputPanel>
                </apex:outputPanel>
            </apex:outputPanel>
            </apex:facet>                           
        </apex:actionStatus>
    </div>
    <style> 
        .custPopup
        {

            background-color: white;
            border-width: 2px;
            border-style: solid;
            z-index: 9999;
            left: 50%;
            padding:10px;
            position: fixed;
            width: 500px;
            margin-left: -250px;
            top: 40%;
        }
        .popupBackground
        {


            background-color:black;
            opacity: 0.20;
            filter: alpha(opacity = 20);
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 9998;
        }
    </style>
</apex:page>