<apex:page id="pg" title="Quote : {!quote.Name}" controller="CreateQuoteOnPremiseController" tabStyle="BigMachines__Quote__c" sidebar="false" action="{!cloneQuoteOnLoad}">
    <apex:stylesheet value="{!$Resource.QuotingToolStyles}"/>
    <apex:form id="form">      
        <apex:actionFunction name="saveBeforeReload" action="{!saveBeforeReload}"/>
        <!--<apex:actionFunction name="deleteQuoteProduct" action="{!deleteQuoteProduct}" reRender="QuoteProductsSection,msgs" status="status">
            <apex:param name="quoteProductIdToBeDeleted" assignTo="{!quoteProductIdToBeDeleted}" value=""/>
        </apex:actionFunction>-->
        <apex:inputText style="position:absolute;top:-1000px;"/>
        <apex:sectionHeader title="Quote Edit" subtitle="{!quote.Name}"/>
        <!--<c:QuoteTabPanel quote.Id="{!quote.id}" selectedTab="Quote Details" showHeader="false" typeOfQuote="On Premise"/>-->
        <apex:pageMessages id="msgs" escape="false"/>
        <apex:pageMessage severity="ERROR" strength="1" rendered="{!blnShowExportScreeningMsg}">
            Please complete Export Screening Check-list for the End User Account.&nbsp;
            <input type="button" class="btn" value="Export Screening Checklist" 
                onclick="alert('Please re-submit the order once the check-list is saved.');window.open('/apex/Compliance_new_edit_redirect?retURL=/{!quote.End_User_ID__c}');"/> 
        </apex:pageMessage>
        
        <apex:outputPanel >
            <apex:commandButton value="Save" action="{!doCalculations}" />&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!quote.BigMachines__Status__c == 'Quote In Progress' || quote.BigMachines__Status__c == 'Revision Pending'}">
            <apex:commandButton value="Submit for Approval" action="{!submitForApprovalBtnHandler}"/>&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!(quote.BigMachines__Status__c == 'Quote In Progress' || quote.BigMachines__Status__c == 'Revision Pending' || quote.BigMachines__Status__c == 'Quote Rejected' || quote.BigMachines__Status__c == 'Quote Approval Pending') && blnShowByPassApprovals}">
            <apex:commandButton value="Bypass Approvals" action="{!bypassApprovalsBtnHandler}"/>&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel >
            <apex:commandButton value="Return to Opportunity" onclick="location.href='/{!quote.BigMachines__Opportunity__c}'; return false;"/>&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!(NOT(IsQuoteUnLocked) || quote.BigMachines__Status__c == 'Quote Rejected') 
            && quote.BigMachines__Status__c != 'Order Accepted' && quote.BigMachines__Status__c != 'Order Submitted'}">
            <apex:commandButton value="Revise" action="{!reviseMajorBtnHandler}" status="status" reRender="quoteInfo"/>&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!quote.BigMachines__Status__c == 'Quote Approved'}">
            <apex:commandButton value="Minor Quote Changes" action="{!reviseMinorBtnHandler}"/>&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!quote.BigMachines__Status__c != 'Order Accepted'}">
            <apex:commandButton value="Clone" action="{!cloneBtnHandler}" status="status" reRender="quoteInfo"/>&nbsp;
        </apex:outputPanel>

        <apex:outputPanel rendered="{!quote.BigMachines__Status__c = 'Quote Approved' || (quote.BigMachines__Status__c = 'Order Rejected' && blnIsReviseOrder)}">
            <apex:commandButton value="Submit Order" action="{!submitOrderBtnHandler}" />&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!quote.BigMachines__Status__c = 'Order Rejected' && NOT(blnIsReviseOrder)}">
            <apex:commandButton value="Revise Order" action="{!reviseOrderBtnHandler}"/>&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!IsQuoteUnLocked}">
            <apex:commandButton value="Product Configuration" onclick="window.open('/apex/Configuration?id={!quote.Id}','Product Configuration', 'width=auto,height=auto,scrollbars=yes');"/>&nbsp;
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!NOT(CONTAINS($Label.On_Premise_Tool_Profiles,$Profile.Name))  || $Profile.Name = 'GEN - Finance' || $Profile.Name = 'Regional Sales Ops'}">
            <apex:outputLink title="Export To Excel" value="/apex/ExportToExcelOnPremise?id={!quote.id}" target="_blank">
                <apex:image url="{!$Resource.ExcelIcon}" width="25px" height="22px"/>    
            </apex:outputLink>
        </apex:outputPanel>
        
        <div id="profileTabSetContainer" class="profileTabSetContainer zen" style="display: block;">
            <div class="zen-box zen-tabs zen-simpleTabs profileTabs" id="TabPanel">
                <div class="zen-inner">
                    <div id="profileTabSetHeader" class="zen-header profileTabSetHeader">
                        <ul id="profileTabSet" class="profileTabSet zen-tabControl" role="tablist">
                            <li class="{!IF(strSelectedTab=='Quote Details','zen-current','')}">
                                <apex:commandLink value="Quote Details" action="{!showQuoteDetails}" title="Quote Details" styleClass="profileTab"/>
                            </li>
                            <!--<li>
                                <apex:commandLink value="Product Configuration" action="{!showProductConfiguration}" title="Product Configuration" styleClass="profileTab"/>
                            </li>-->
                            <li class="{!IF(strSelectedTab=='Genesys Care','zen-current','')}">
                                <apex:commandLink value="Genesys Care" action="{!showGenesysCare}" title="Genesys Care" styleClass="profileTab"/>
                            </li>
                            <li class="{!IF(strSelectedTab=='DAP Details','zen-current','')}">
                                <apex:commandLink value="DAP Details" action="{!showDAPDetails}" title="DAP Details" styleClass="profileTab"/>
                            </li>
                            <li class="{!IF(strSelectedTab=='Special Offers','zen-current','')}">
                                <apex:commandLink value="Special Offers" action="{!showSpecialOffers}" title="Special Offers" styleClass="profileTab"/>
                            </li>
                            <li class="{!IF(strSelectedTab=='Quote Approvals','zen-current','')}">
                                <!--<apex:commandLink value="Quote Approvals" action="{!showQuoteApprovals}" title="Quote Approvals" reRender="form, pnlQuoteApprovals" styleClass="profileTab"/>-->
                                <apex:commandLink value="Quote Approvals" action="{!showQuoteApprovals}" title="Quote Approvals" styleClass="profileTab"/>
                            </li>
                            <li>
                                <apex:commandLink value="Quote Output" action="{!showProposalOptions}" title="Quote Output" styleClass="profileTab"/>
                            </li>
                            <li class="{!IF(strSelectedTab=='Order Submission','zen-current','')}">
                                <apex:commandLink value="Order Submission" action="{!showOrderSubmission}" title="Order Submission" styleClass="profileTab"/>
                            </li>
                            <li>
                                <apex:commandLink value="History and Attachments" action="{!showHistoryAndAttachments}" title="History and Attachments" styleClass="profileTab"/>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <apex:pageBlock title="Quoting Tool" id="pgblk" rendered="{!strSelectedTab=='Quote Details'}">
            
            <apex:pageBlockButtons location="top">
                
            </apex:pageBlockButtons>
            
            <!-- Header Section -->
            <apex:pageBlockSection id="quoteInfo" title="Quote Information">

                <apex:outputField value="{!quote.Name}"/>
                <apex:outputField value="{!quote.End_User_ID__c}"/>
                <apex:outputField value="{!quote.BigMachines__Opportunity__c}" rendered="{!NOT(quote.Quote_Cloned_Revised__c != null && IsQuoteUnLocked)}"/>
                <apex:inputField id="oppty" value="{!quote.BigMachines__Opportunity__c}" rendered="{!quote.Quote_Cloned_Revised__c != null && IsQuoteUnLocked}" required="true">
                    <apex:actionSupport event="onchange" action="{!changeOpportunity}" reRender="quoteInfo,msgs" status="changeStatus"/>
                    <apex:actionStatus id="changeStatus">
                        <apex:facet name="start">
                            <apex:image value="/img/loading.gif"/>
                        </apex:facet> 
                    </apex:actionStatus>
                </apex:inputField>
                <apex:outputField value="{!quote.Sold_To_Name__c}"/>
                <!--<apex:outputField value="{!quote.Sold_To_Name__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                <apex:inputField id="soldTo" value="{!quote.Sold_To_Name__c}" rendered="{!IsQuoteUnLocked}" required="true">
                    <apex:actionSupport event="onchange" action="{!changeSoldTo}" reRender="soldTo,msgs" status="changeStatus"/>
                    <apex:actionStatus id="changeStatus">
                        <apex:facet name="start">
                            <apex:image value="/img/loading.gif"/>
                        </apex:facet> 
                    </apex:actionStatus>
                </apex:inputField>-->
                <apex:outputField value="{!quote.BigMachines__Status__c}"/>
                
                <apex:outputField value="{!quote.CreatedDate}"/>
                
                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked}">
                    <apex:outputLabel value="Pricing Model"/>
                    <apex:outputPanel layout="block" styleClass="requiredInput">
                        <apex:outputPanel styleClass="requiredBlock"/>
                        <apex:selectList id="calculationType" value="{!quote.Pricing_Model__c}" size="1">
                            <apex:selectOption itemValue="Concurrent" itemLabel="Concurrent"/>
                            <apex:selectOption itemValue="Enabled" itemLabel="Enabled"/>
                            <apex:selectOption itemValue="Named User" itemLabel="Named User Pricing"/>
                            <!--<apex:selectOption itemValue="Enabled Plus Concurrent" itemLabel="Enabled Plus Concurrent"/>-->
                            <apex:actionSupport event="onchange" action="{!changePricingModel}" status="status" reRender="pgblk,msgs"/>
                        </apex:selectList>
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!quote.Pricing_Model__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                
                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked || quote.BigMachines__Status__c = 'Quote Approved'}">
                    <apex:outputLabel value="Expiry Date"/>
                    <apex:inputField value="{!quote.Expiration_Date__c}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem rendered="{!NOT(IsQuoteUnLocked || quote.BigMachines__Status__c = 'Quote Approved')}">
                    <apex:outputLabel value="Expiry Date"/>
                    <apex:outputField value="{!quote.Expiration_Date__c}" />
                </apex:pageBlockSectionItem>
                
                <apex:outputField value="{!quote.Sold_To_Region__c}"/>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="Sub Region"/>
                    <apex:outputField value="{!quote.Sub_Sub_Region__c}" />
                </apex:pageBlockSectionItem>
                
                <apex:inputField value="{!quote.ELA__c}" rendered="{!IsQuoteUnLocked}"/>
                <apex:outputField value="{!quote.ELA__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="Quote Submitted Date"/>
                    <apex:outputField value="{!quote.Approval_Submission_Date__c}"/>
                </apex:pageBlockSectionItem>
                
                <apex:outputField value="{!quote.Revision_No__c}"/>
                
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="Quote Approved Date"/>
                    <apex:outputField value="{!quote.Approval_Date__c}"/>
                </apex:pageBlockSectionItem>
                
                <!--<apex:inputField value="{!quote.System_Integrator__c}" rendered="{!IsQuoteUnLocked}"/>
                <apex:outputField value="{!quote.System_Integrator__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>-->
                
                <apex:inputTextarea value="{!quote.BigMachines__Description__c}" cols="70" rows="5" rendered="{!IsQuoteUnLocked}"/>
                <apex:outputField value="{!quote.BigMachines__Description__c}" style="" rendered="{!NOT(IsQuoteUnLocked)}"/>
                
                <apex:outputField value="{!quote.OwnerId}"/>
                
                <apex:outputField value="{!quote.Order_Date_Submitted__c}" rendered="{!NOT(ISBLANK(quote.Order_Date_Submitted__c))}"/>
                <apex:outputText rendered="{!ISBLANK(quote.Order_Date_Submitted__c)}"/>
                
                <apex:outputField value="{!quote.Order_PO_Number__c}" rendered="{!(quote.BigMachines__Status__c = 'Order Submitted' || 
                    quote.BigMachines__Status__c = 'Order Accepted' || quote.BigMachines__Status__c = 'Order Rejected')}"/>
                
                <apex:outputField value="{!quote.Order_PO_Date__c}" rendered="{!(quote.BigMachines__Status__c = 'Order Submitted' || 
                    quote.BigMachines__Status__c = 'Order Accepted' || quote.BigMachines__Status__c = 'Order Rejected')}"/>
                            
                <apex:inputField value="{!quote.Sent_to_Customer__c}" rendered="{!quote.BigMachines__Status__c = 'Quote Approved'}"/>
                <apex:outputField value="{!quote.Sent_to_Customer__c}" rendered="{!quote.BigMachines__Status__c = 'Order Submitted'}"/>
                
                <apex:outputField value="{!quote.CurrencyISOCode}"/>
                
                
                
                <apex:inputField value="{!quote.CAD_Override__c}" rendered="{!IsQuoteUnLocked && quote.Sold_To_Name__r.Country__r.Name = 'Canada'}"/>
                <apex:outputField value="{!quote.CAD_Override__c}" rendered="{!NOT(IsQuoteUnLocked) && quote.Sold_To_Name__r.Country__r.Name = 'Canada'}"/>

            </apex:pageBlockSection>

            <apex:pageBlockSection title="Quote Products" collapsible="false"/>
            <!--<apex:commandButton onclick="window.location.href='/apex/Configuration?id={!quote.Id}&tab=search';return false;" value="Search Products" rendered="{!IsQuoteUnLocked}"/>-->
            <apex:commandButton value="Search Products" rendered="{!IsQuoteUnLocked}" onclick="window.open('/apex/Configuration?id={!quote.Id}&tab=search','Product Configuration', 'width=auto,height=auto,scrollbars=yes');"/>
            &nbsp;&nbsp;
            <apex:commandButton value="Product Configuration" rendered="{!IsQuoteUnLocked}" onclick="window.open('/apex/Configuration?id={!quote.Id}','Product Configuration', 'width=auto,height=auto,scrollbars=yes');"/>
            <table width="100%">
                <tr>
                    <td style="text-align:left;" width="50%">
                        <apex:panelGrid columns="2" rendered="{!list_QuoteProducts.size > 0}">           
                            <apex:panelGroup >
                                <b>Group By :</b>
                            </apex:panelGroup>
                            <apex:panelGroup >
                                <apex:selectList value="{!quote.Grid_Group_By__c}" size="1">
                                    <apex:selectOption itemValue="Categories" itemLabel="Categories"/>
                                    <apex:selectOption itemValue="Bundles/Products" itemLabel="Bundles/Products"/>
                                    <apex:selectOption itemValue="Proposal Groups" itemLabel="Proposal Groups"/>
                                    <apex:selectOption itemValue="3rd Party/Genesys" itemLabel="3rd Party/Genesys"/>
                                    <apex:actionSupport event="onchange" action="{!createCurrentPageList}" status="status" reRender="QuoteProductsSection"/>
                                </apex:selectList>
                            </apex:panelGroup>
                        </apex:panelGrid>
                    </td>
                    <td style="text-align:left;" width="25%">
                        <apex:commandButton value="Save" action="{!doCalculations}" rendered="{!IsQuoteUnLocked}" status="status" reRender="bottomSection,QuoteProductsSection,msgs"/>
                    </td>
                    <td style="text-align:right;" width="25%">
                        <apex:commandLink value="Select Columns" action="{!selectColumnsHandler}" status="status" reRender="selectColumns" 
                            style="font-size:105%" rendered="{!CONTAINS($Label.On_Premise_Tool_Profiles,$Profile.Name) 
                            || $Profile.Name = 'System Administrator' || $Profile.Name = 'General User Access Group SU'
                             || $Profile.Name = 'GEN - Finance'}"/>
                    </td>
                </tr>
            </table>
            
            <br/>
            <apex:inputHidden value="{!strToDelete}" id="strToDelete"/>         
            <apex:outputPanel id="QuoteProductsSection">
            <!--<apex:outputPanel layout="none" id="extraInnerPanel">-->
                <!-- Pagination Information -->
                <apex:outputPanel rendered="{!intTotalNoOfRecords > intPageSize}">
                    <center>
                        <b>Total Records : {!intTotalNoOfRecords}&nbsp;&nbsp;</b>
                        <apex:commandLink action="{!first}" status="status" reRender="QuoteProductsSection" rendered="{!HasPrevious}" style="text-decoration:none">
                            First
                        </apex:commandLink>
                        <apex:outputText value="First" rendered="{!NOT(HasPrevious)}" style="color:gray"/>
                        &nbsp;
                        <apex:commandLink action="{!previous}" status="status" reRender="QuoteProductsSection" rendered="{!HasPrevious}" style="text-decoration:none">
                            <apex:image url="/img/search_prevarrow.gif" title="Previous" styleClass="prevArrow"/>
                            &nbsp;
                            Previous
                        </apex:commandLink>
                        <apex:outputPanel rendered="{!NOT(HasPrevious)}" style="color:gray">
                            <apex:image url="/img/search_prevarrow_disabled.gif"/>
                            &nbsp;
                            Previous
                        </apex:outputPanel>
                        &nbsp;
                        ({!PageNumStr})
                        &nbsp;
                        <apex:commandLink action="{!next}" status="status" reRender="QuoteProductsSection" rendered="{!HasNext}" style="text-decoration:none">
                            Next
                            &nbsp;
                            <apex:image url="/img/search_nextarrow.gif" title="Next" styleClass="nextArrow"/>
                        </apex:commandLink>
                        <apex:outputPanel rendered="{!NOT(HasNext)}" style="color:gray">
                            Next
                            &nbsp;
                            <apex:image url="/img/search_nextarrow_disabled.gif"/>
                        </apex:outputPanel>
                        &nbsp;
                        <apex:commandLink action="{!last}" status="status" reRender="QuoteProductsSection" title="Last" rendered="{!HasNext}" style="text-decoration:none">
                            Last
                        </apex:commandLink>
                        <apex:outputText value="Last" rendered="{!NOT(HasNext)}" style="color:gray"/>
                    </center>
                    <br/>
                </apex:outputPanel>
                
                <table class="list " border="0" cellpadding="0" cellspacing="0" id="quoteProdGrid">
                    <thead>
                        <tr class="headerRow">
                            <th class="headerRow" style="width: 15px;"></th>
                            <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                                <th class="headerRow" style="width: 10px;">
                                    <apex:inputCheckBox id="check" value="{!blnIsHeaderChecked}">
                                        <apex:actionSupport event="onchange" action="{!checkUncheckAll}"/>
                                    </apex:inputCheckBox>
                                </th>
                                <th class="headerRow" style="width: 50px;">Action</th>
                            </apex:outputPanel>
                            <th class="headerRow" style="width: 45px;">Group</th>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.Building_Block__c}">
                                <th class="headerRow" style="width: 150px;">Building Block</th>
                            </apex:outputPanel>
                            <th class="headerRow" style="width: 200px;">Product</th>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                <th class="headerRow" style="width: 100px;">Unit of<br/>measure</th>
                            </apex:outputPanel>
                            <th class="headerRow" style="width: 50px;">Qty</th>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.List_Price__c}">
                                <th class="headerRow" style="width: 100px;">List Price</th>
                            </apex:outputPanel>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.Ext_List_Price__c}">
                                <th class="headerRow" style="width: 100px;">Ext List<br/>Price</th>
                            </apex:outputPanel>
                            <th class="headerRow" style="width: 60px;">Discount</th>
                            <th class="headerRow" style="width: 50px;">% / Amt</th>
                            <th class="headerRow" style="width: 50px;">Adjust-<br/>ment %</th>
                            <apex:outputPanel layout="none" rendered="{!blnHasBundles}">
                                <th class="headerRow" style="width: 50px;">Bundle<br/>Disc %</th>
                            </apex:outputPanel>
                            <th class="headerRow" style="width: 50px;">Total<br/>Disc %</th>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.Product_Specific_Discount__c}">
                                <th class="headerRow" style="width: 50px;">Product<br/>Specific<br/>Discount</th>
                            </apex:outputPanel>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.Net_Unit_Price__c}">
                                <th class="headerRow" style="width: 100px;">Net Unit Price</th>
                            </apex:outputPanel>
                            <th class="headerRow" style="width: 100px;">Ext Net Price</th>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                <th class="headerRow" style="width: 50px;">3rd<br/>Party</th>
                            </apex:outputPanel>
                            <apex:outputPanel layout="none" rendered="{!blnHasHWLines}">
                                <th class="headerRow" style="width: 50px;">3rd<br/>Party<br/>GC %</th>
                            </apex:outputPanel>
                            <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                <th class="headerRow" style="width: 50px;">PM<br/>Approver</th>
                            </apex:outputPanel>
                        </tr>
                    </thead>
                    <tbody>
                        <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                            <!-- Mass Update Row -->
                            <tr style="background-color:#D4D4CF;">
                                <td colspan="{!5 + IF(objColumnPreference.Building_Block__c,1,0) + IF(objColumnPreference.Unit_of_measure__c,1,0)}">&nbsp;</td>
                                <td class="dataCell" colspan="{!1 + IF(objColumnPreference.List_Price__c,1,0) + IF(objColumnPreference.Ext_List_Price__c,1,0)}">
                                    <apex:inputField value="{!objMassUpdateInput.Quantity__c}" required="false" style="width:45px;"/>
                                </td>
                                <td class="dataCell">
                                    <apex:inputField value="{!objMassUpdateInput.Disc__c}" style="width:55px;"/>
                                </td>
                                <td class="dataCell">
                                    <apex:selectList value="{!objMassUpdateInput.or_Amount__c}" size="1">
                                        <apex:selectOption itemValue="" itemLabel=""/>
                                        <apex:selectOption itemValue="%" itemLabel="%"/>
                                        <apex:selectOption itemValue="Amt" itemLabel="Amt"/>
                                    </apex:selectList>
                                </td>
                                <td colspan="{!3 + IF(blnHasBundles,1,0) + IF(objColumnPreference.Product_Specific_Discount__c,1,0) + 
                                                IF(objColumnPreference.Net_Unit_Price__c,1,0) + IF(objColumnPreference.Third_Party__c,1,0) + 
                                                IF(blnHasHWLines,1,0) + IF(objColumnPreference.PM_Approver__c,1,0)}">
                                    <apex:commandButton value="Mass Update Selected" action="{!massUpdateBtnHandler}" status="status" reRender="pgblk,msgs"/>
                                </td>
                            </tr>
                            <!-- Quick Add Row -->
                            <!--<tr style="background-color:#D4D4CF;">
                                <td colspan="{!4 + IF(objColumnPreference.Building_Block__c,1,0)}">&nbsp;</td>
                                <td class="dataCell" colspan="{!1 + IF(objColumnPreference.Unit_of_measure__c,1,0)}">
                                    <apex:inputField value="{!objAddProductInput.Product_Search__c}"/>
                                </td>
                                <td class="dataCell" colspan="{!3 + IF(objColumnPreference.List_Price__c,1,0) + IF(objColumnPreference.Ext_List_Price__c,1,0)}">
                                    <apex:inputField value="{!objAddProductInput.Quantity__c}" required="false" style="width:45px;"/>
                                </td>
                                <td colspan="{!3 + IF(blnHasBundles,1,0) + IF(objColumnPreference.Product_Specific_Discount__c,1,0) + 
                                                IF(objColumnPreference.Net_Unit_Price__c,1,0) + IF(objColumnPreference.Third_Party__c,1,0) + 
                                                IF(blnHasHWLines,1,0) + IF(objColumnPreference.PM_Approver__c,1,0)}">
                                    <apex:commandButton value="Add Product" action="{!addQuoteProduct}"/>
                                </td>
                            </tr>-->
                        </apex:outputPanel>
                        
                        <apex:variable value="{!((intPageNum-1) * intPageSize) + 1}" var="rowNumLevel1"/>
                        <apex:repeat value="{!list_GroupHeaders}" var="strGroupHeader">
                        <apex:variable value="{!0}" var="rowNumLevel2"/>
                        <apex:repeat value="{!map_GroupHeaderToQuoteProdWrapper[strGroupHeader]}" var="objQPWrapper">
                            <apex:outputPanel layout="none" rendered="{!rowNumLevel2 == 0}">
                                <tr style="background-color:rgba(255, 249, 179, 0.75)">
                                    <td colspan="100">
                                        <!-- Group By Information -->
                                        {!IF(strGroupHeader == 'BLANK','',strGroupHeader)}
                                    </td>
                                </tr>
                            </apex:outputPanel>
                            <apex:variable value="{!1}" var="rowNumLevel2"/>
                            <!-- Quote Product Rows -->
                            <tr class="dataRow">
                                <td class="dataCell">{!rowNumLevel1}.</td>
                                <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                                    <td class="dataCell">
                                        <apex:inputCheckBox id="check" value="{!objQPWrapper.selected}"/>
                                    </td>
                                    <td class="dataCell">
                                        <apex:commandlink action="{!deleteQuoteProduct}" title="Remove Quote Product" onclick="deleteQP('{!$Component.strToDelete}');" reRender="QuoteProductsSection,msgs" status="status">
                                            <apex:param name="quoteProductIdToBeDeleted" assignTo="{!quoteProductIdToBeDeleted}" value="{!objQPWrapper.record.id}" />
                                            <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>   
                                        </apex:commandlink>
                                        <!--<apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}" title="Remove Quote Product" onclick="deleteQP('{!$Component.strToDelete}','{!objQPWrapper.record.id}');"/>-->
                                    </td>
                                </apex:outputPanel>
                                <td class="dataCell">
                                    <apex:selectList value="{!objQPWrapper.record.Group_Number__c}" size="1" 
                                            rendered="{!ISBLANK(objQPWrapper.record.Bundle__c) && IsQuoteUnLocked}">
                                        <apex:selectOption itemValue="" itemLabel=""/>
                                        <apex:selectOptions value="{!list_ProposalGroupNumberOptions}"/>
                                    </apex:selectList>
                                    <apex:outputField value="{!objQPWrapper.record.Group_Number__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Building_Block__c}">
                                    <td class="dataCell">
                                        <apex:outputField value="{!objQPWrapper.record.BigMachines__Product__r.Building_Block__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <td class="dataCell">
                                    <apex:outputField value="{!objQPWrapper.record.Product_Description__c}"/><br/>
                                    (<apex:outputField value="{!objQPWrapper.record.BigMachines__Product__r.Name}" />)
                                    <apex:outputPanel layout="none" rendered="{!NOT(ISBLANK(objQPWrapper.record.BigMachines__Product__r.Flavors_Available__c))}">
                                        <br/>
                                        <apex:outputPanel layout="block" styleClass="requiredInput" rendered="{!IsQuoteUnLocked}">
                                            <apex:outputPanel styleClass="requiredBlock"/>
                                            <apex:selectList value="{!objQPWrapper.record.Flavor__c}" size="1" style="color:blue">
                                                <apex:selectOption itemValue="" itemLabel=""/>
                                                <apex:selectOptions value="{!map_FlavorsToSelectOptions[objQPWrapper.record.BigMachines__Product__r.Flavors_Available__c]}"/>
                                            </apex:selectList>
                                        </apex:outputPanel>
                                        <apex:outputText value="{!objQPWrapper.record.Flavor__c}" rendered="{!NOT(IsQuoteUnLocked)}" style="color:blue"/>
                                    </apex:outputPanel>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                    <td class="dataCell">
                                        <apex:outputField value="{!objQPWrapper.record.Unit_of_Measure__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <td class="dataCell">
                                    <apex:inputField value="{!objQPWrapper.record.Quantity__c}" required="false" style="width:45px;" rendered="{!IsQuoteUnLocked && ISBLANK(objQPWrapper.record.Build_Type__c)}"/>
                                    <apex:outputField value="{!objQPWrapper.record.Quantity__c}" rendered="{!NOT(IsQuoteUnLocked && ISBLANK(objQPWrapper.record.Build_Type__c))}"/>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.List_Price__c}">
                                    <td class="dataCell">
                                        <!--<apex:outputField value="{!objQPWrapper.record.List_Price__c}"/>-->
                                        <apex:outputText value="{0, number,###,###,##0.00}">
                                            <apex:param value="{!objQPWrapper.record.List_Price__c}"/>
                                        </apex:outputText>
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Ext_List_Price__c}">
                                    <td class="dataCell">
                                        <apex:outputField value="{!objQPWrapper.record.Ext_List__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <td class="dataCell">
                                    <apex:inputField value="{!objQPWrapper.record.Disc__c}" style="width:55px;" rendered="{!IsQuoteUnLocked}"/>
                                    <apex:outputField value="{!objQPWrapper.record.Disc__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                                </td>
                                <td class="dataCell">
                                    <apex:selectList value="{!objQPWrapper.record.or_Amount__c}" size="1" rendered="{!IsQuoteUnLocked}">
                                        <apex:selectOption itemValue="" itemLabel=""/>
                                        <apex:selectOption itemValue="%" itemLabel="%"/>
                                        <apex:selectOption itemValue="Amt" itemLabel="Amt"/>
                                    </apex:selectList>
                                    <apex:outputField value="{!objQPWrapper.record.or_Amount__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                                </td>
                                <td class="dataCell">
                                    <apex:outputField value="{!objQPWrapper.record.Adjustment__c}"/>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!blnHasBundles}">
                                    <td class="dataCell">
                                        {!objQPWrapper.record.Bundle_Discount__c}
                                    </td>
                                </apex:outputPanel>
                                <td class="dataCell">
                                    <apex:outputField value="{!objQPWrapper.record.Total_Discount__c}"/>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Product_Specific_Discount__c}">
                                    <td class="dataCell">
                                        <apex:outputField value="{!objQPWrapper.record.Product_Specific_Discount__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Net_Unit_Price__c}">
                                    <td class="dataCell">
                                        <apex:outputField value="{!objQPWrapper.record.Net_Unit_Price__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <td class="dataCell">
                                    <apex:outputField value="{!objQPWrapper.record.Ext_Net_Price__c}"/>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                    <td class="dataCell">
                                        <apex:outputText value="{!IF(objQPWrapper.record.Third_Party__c == 'TRUE','Yes','No')}"/>
                                        <!--{!objQPWrapper.record.Third_Party__c}-->
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!blnHasHWLines}">
                                    <td class="dataCell">
                                        <apex:outputField value="{!objQPWrapper.record.Third_Party_GC__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                    <td class="dataCell">
                                        <apex:outputField value="{!objQPWrapper.record.Pm_Approver__c}"
                                            rendered="{!objQPWrapper.record.BigMachines__Product__r.Shipment_Approval__c = 'Required for all Orders' ||
                                                objQPWrapper.record.BigMachines__Product__r.Shipment_Approval__c = 'Required for New Orders Only'}"/>
                                    </td>
                                </apex:outputPanel>
                            </tr>
                            <apex:variable value="{!rowNumLevel1 + 1}" var="rowNumLevel1"/>
                        </apex:repeat>
                    </apex:repeat>
                    <apex:outputPanel layout="none" rendered="{!OR(NOT(ISBLANK(objServiceLevel)),NOT(ISBLANK(objThirdPartyGCLine)))}">
                        <tr style="background-color:#F8DE7E">
                            <td colspan="100">
                                Genesys Care
                            </td>
                        </tr>
                    </apex:outputPanel>
                    <!-- Service Level Row -->
                        <apex:outputPanel layout="none" rendered="{!NOT(ISBLANK(objServiceLevel))}">
                            <tr style="background-color:rgba(212, 212, 207, 0.50)">
                                <td colspan="2">&nbsp;</td>
                                <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                                    <td colspan="2" class="dataCell">
                                        <apex:commandlink action="{!deleteQuoteProduct}" title="Remove Quote Product" onclick="deleteQP('{!$Component.strToDelete}');" reRender="QuoteProductsSection,msgs" status="status">
                                            <apex:param name="quoteProductIdToBeDeleted" assignTo="{!quoteProductIdToBeDeleted}" value="{!objServiceLevel.id}" />
                                            <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>   
                                        </apex:commandlink>
                                    </td>
                                </apex:outputPanel>
                                <td colspan="{!1 + IF(objColumnPreference.Building_Block__c,1,0)}">
                                    <apex:outputField value="{!objServiceLevel.Product_Description__c}"/><br/>
                                    (<apex:outputField value="{!objServiceLevel.BigMachines__Product__r.Name}" />)
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                    <td>
                                        <apex:outputField value="{!objServiceLevel.Unit_of_Measure__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <td colspan="{!5 + IF(blnHasBundles,1,0) + IF(objColumnPreference.List_Price__c,1,0) + IF(objColumnPreference.Ext_List_Price__c,1,0) +
                                        IF(objColumnPreference.Product_Specific_Discount__c,1,0) + IF(objColumnPreference.Net_Unit_Price__c,1,0)}">&nbsp;</td>
                                <td>
                                    <apex:outputField value="{!objServiceLevel.Ext_Net_Price__c}"/>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                    <td>
                                        <apex:outputText value="{!IF(objServiceLevel.Third_Party__c == 'TRUE','Yes','No')}"/>
                                        <!--{!objServiceLevel.Third_Party__c}-->
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!blnHasHWLines}">
                                    <td>&nbsp;</td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                    <td>
                                        <apex:outputField value="{!objServiceLevel.Pm_Approver__c}"
                                            rendered="{!objServiceLevel.BigMachines__Product__r.Shipment_Approval__c = 'Required for all Orders' ||
                                                objServiceLevel.BigMachines__Product__r.Shipment_Approval__c = 'Required for New Orders Only'}"/>
                                    </td>
                                </apex:outputPanel>
                            </tr>
                        </apex:outputPanel>
                        <!-- Third Party GC Line Row -->
                        <apex:outputPanel layout="none" rendered="{!NOT(ISBLANK(objThirdPartyGCLine))}">
                            <tr style="background-color:rgba(212, 212, 207, 0.50)">
                                <td colspan="2">&nbsp;</td>
                                <apex:outputPanel layout="none" rendered="{!IsQuoteUnLocked}">
                                    <td colspan="2" class="dataCell">
                                        <apex:commandlink action="{!deleteQuoteProduct}" title="Remove Quote Product" onclick="deleteQP('{!$Component.strToDelete}');" reRender="QuoteProductsSection,msgs" status="status">
                                            <apex:param name="quoteProductIdToBeDeleted" assignTo="{!quoteProductIdToBeDeleted}" value="{!objThirdPartyGCLine.id}" />
                                            <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>   
                                        </apex:commandlink>
                                    </td>
                                </apex:outputPanel>
                                <td colspan="{!1 + IF(objColumnPreference.Building_Block__c,1,0)}">
                                    <apex:outputField value="{!objThirdPartyGCLine.Product_Description__c}"/><br/>
                                    (<apex:outputField value="{!objThirdPartyGCLine.BigMachines__Product__r.Name}" />)
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Unit_of_measure__c}">
                                    <td>
                                        <apex:outputField value="{!objThirdPartyGCLine.Unit_of_Measure__c}"/>
                                    </td>
                                </apex:outputPanel>
                                <td colspan="{!5 + IF(blnHasBundles,1,0) + IF(objColumnPreference.List_Price__c,1,0) + IF(objColumnPreference.Ext_List_Price__c,1,0) +
                                        IF(objColumnPreference.Product_Specific_Discount__c,1,0) + IF(objColumnPreference.Net_Unit_Price__c,1,0)}">&nbsp;</td>
                                <td>
                                    <apex:outputField value="{!objThirdPartyGCLine.Ext_Net_Price__c}"/>
                                </td>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.Third_Party__c}">
                                    <td>
                                        <apex:outputText value="{!IF(objThirdPartyGCLine.Third_Party__c == 'TRUE','Yes','No')}"/>
                                        <!--{!objThirdPartyGCLine.Third_Party__c}-->
                                    </td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!blnHasHWLines}">
                                    <td>&nbsp;</td>
                                </apex:outputPanel>
                                <apex:outputPanel layout="none" rendered="{!objColumnPreference.PM_Approver__c}">
                                    <td>
                                        <apex:outputField value="{!objThirdPartyGCLine.Pm_Approver__c}" 
                                                rendered="{!objThirdPartyGCLine.BigMachines__Product__r.Shipment_Approval__c = 'Required for all Orders' ||
                                                objThirdPartyGCLine.BigMachines__Product__r.Shipment_Approval__c = 'Required for New Orders Only'}"/>
                                    </td>
                                </apex:outputPanel>
                            </tr>
                        </apex:outputPanel>
                    </tbody>
                </table>
                
                <!-- Pagination Information -->
                <apex:outputPanel layout="none" rendered="{!intTotalNoOfRecords > intPageSize}">
                    <br/>
                    <center>
                        <b>Total Records : {!intTotalNoOfRecords}&nbsp;&nbsp;</b>
                        <apex:commandLink action="{!first}" status="status" reRender="QuoteProductsSection" rendered="{!HasPrevious}" style="text-decoration:none">
                            First
                        </apex:commandLink>
                        <apex:outputText value="First" rendered="{!NOT(HasPrevious)}" style="color:gray"/>
                        &nbsp;
                        <apex:commandLink action="{!previous}" status="status" reRender="QuoteProductsSection" rendered="{!HasPrevious}" style="text-decoration:none">
                            <apex:image url="/img/search_prevarrow.gif" title="Previous" styleClass="prevArrow"/>
                            &nbsp;
                            Previous
                        </apex:commandLink>
                        <apex:outputPanel rendered="{!NOT(HasPrevious)}" style="color:gray">
                            <apex:image url="/img/search_prevarrow_disabled.gif"/>
                            &nbsp;
                            Previous
                        </apex:outputPanel>
                        &nbsp;
                        ({!PageNumStr})
                        &nbsp;
                        <apex:commandLink action="{!next}" status="status" reRender="QuoteProductsSection" rendered="{!HasNext}" style="text-decoration:none">
                            Next
                            &nbsp;
                            <apex:image url="/img/search_nextarrow.gif" title="Next" styleClass="nextArrow"/>
                        </apex:commandLink>
                        <apex:outputPanel rendered="{!NOT(HasNext)}" style="color:gray">
                            Next
                            &nbsp;
                            <apex:image url="/img/search_nextarrow_disabled.gif"/>
                        </apex:outputPanel>
                        &nbsp;
                        <apex:commandLink action="{!last}" status="status" reRender="QuoteProductsSection" title="Last" rendered="{!HasNext}" style="text-decoration:none">
                            Last
                        </apex:commandLink>
                        <apex:outputText value="Last" rendered="{!NOT(HasNext)}" style="color:gray"/>
                    </center>
                </apex:outputPanel>
            <!--</apex:outputPanel>-->
            </apex:outputPanel>
            <br/><br/>
            <!--<apex:pageBlockSection showHeader="false" columns="2">-->
            <apex:outputPanel layout="none" id="bottomSection">
            <table width="100%">
            <tr>
                <td valign="top" width="50%">
                <apex:outputPanel style="width:45%">
                    <!-- Proposal Groups Table -->
                    <apex:pageBlock title="Proposal Groups" id="QPBlock">
                        <apex:pageBlockButtons location="top">
                            <apex:commandButton value="Modify" action="{!editofProposalGroup}" rendered="{!NOT(blnEditProposalGroup) && IsQuoteUnLocked}" rerender="QPBlock" status="status"/>
                            <apex:commandButton value="Save" action="{!saveProposalGroup}" rendered="{!blnEditProposalGroup}" status="status" reRender="bottomSection,QuoteProductsSection,msgs"/>
                            <apex:commandButton value="Cancel" action="{!cancelEditofProposalGroup}" rendered="{!blnEditProposalGroup}" rerender="QPBlock" status="status"/>
                        </apex:pageBlockButtons>
                        <apex:outputPanel layout="none" rendered="{!NOT(blnEditProposalGroup)}">
                                <b>Ungrouped Items Sub Total : </b>
                                <apex:outputField value="{!objUngrouped.Sub_Total__c}"/>
                                <br/><br/>
                            <apex:variable var="rowNum" value="{!0}"/>
                            <apex:pageBlockTable value="{!list_ProposalGroups}" var="objPG" rendered="{!list_ProposalGroups.size > 0}">
                                <apex:column >
                                    <apex:facet name="header">
                                        Group<br/>Number
                                    </apex:facet>
                                    <apex:outputText value="{!objPG.Group_Number__c}"/>
                                </apex:column>
                                <apex:column value="{!objPG.Name__c}"/>
                                <apex:column value="{!objPG.Description__c}"/>
                                <apex:column value="{!objPG.Discount__c}"/>
                                <apex:column value="{!objPG.Sub_Total__c}"/>
                                <apex:column headerValue="Goal Seek" rendered="{!IsQuoteUnLocked}">
                                    <apex:inputField value="{!objPG.Goal_Seek__c}" style="width : 80px"/>&nbsp;
                                    <apex:commandLink value="Goal Seek" action="{!goalSeekForPG}" status="status" reRender="bottomSection,QuoteProductsSection,msgs" styleClass="btn" style="text-decoration : none;">
                                        <apex:param name="strPGIndex" assignTo="{!strPGIndex}" value="{!rowNum}" /> 
                                    </apex:commandlink>&nbsp;
                                    <apex:commandLink value="Goal Seek Reset" action="{!goalSeekResetForPG}" status="status" reRender="bottomSection,QuoteProductsSection,msgs" styleClass="btn" style="text-decoration : none;">
                                        <apex:param name="strPGIndex" assignTo="{!strPGIndex}" value="{!rowNum}" />   
                                    </apex:commandlink>
                                    <apex:variable var="rowNum" value="{!rowNum + 1}"/>
                                </apex:column>
                            </apex:pageBlockTable>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!blnEditProposalGroup}" id="PGEditPanel">
                            <apex:pageMessage severity="error" strength="1" rendered="{!blnHasProposalGroupErrors}">
                                {!strProposalGroupErrorMsg}
                            </apex:pageMessage>
                            <apex:variable var="rowNum" value="{!0}"/>
                            <apex:pageBlockTable value="{!list_ProposalGroupsBeingEdited}" var="objPG">
                                <apex:column headerValue="Action">
                                    <apex:commandlink action="{!removeProposalGroup}" rerender="PGEditPanel" title="Remove Proposal Group" status="status">
                                        <apex:param name="strPGIndex" assignTo="{!strPGIndex}" value="{!rowNum}" />
                                        <apex:image url="{!URLFOR($Resource.NewQuoteScreenIcons,'/Icons/trash.png')}"/>    
                                    </apex:commandlink>
                                    <apex:variable var="rowNum" value="{!rowNum + 1}"/>
                                </apex:column>
                                <apex:column headerValue="Name">
                                    <apex:inputField value="{!objPG.Name__c}"/>
                                </apex:column>
                                <apex:column headerValue="Description">
                                    <apex:inputField value="{!objPG.Description__c}" style="width:200px;"/>
                                </apex:column>
                                <apex:column headerValue="Discount %">
                                    <apex:inputField value="{!objPG.Discount__c}"/>
                                </apex:column>
                            </apex:pageBlockTable>
                            <br/>
                            <apex:commandLink action="{!addProposalGroup}" reRender="PGEditPanel" title="Add Proposal Group" status="status">
                                <apex:image value="{!$Resource.PlusSign}" width="25px" height="25px"/>
                            </apex:commandLink>
                        </apex:outputPanel>
                    </apex:pageBlock>
                    <br/>
                    <apex:panelGrid columns="{!IF(IsQuoteUnLocked,'3','2')}">           
                        <apex:outputText value="Goal Seek : " style="font-weight:bold"/>
                        <apex:inputField value="{!quote.Goal_Seek__c}" rendered="{!IsQuoteUnLocked}"/>
                        <apex:outputField value="{!quote.Goal_Seek__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                        <apex:panelGroup rendered="{!IsQuoteUnLocked}">
                            <apex:commandButton value="Goal Seek" action="{!goalSeekBtnHandler}" status="status" reRender="bottomSection,QuoteProductsSection,msgs"/>&nbsp;
                            <apex:commandButton value="Goal Seek Reset" action="{!goalSeekResetBtnHandler}" status="status" reRender="bottomSection,QuoteProductsSection,msgs"/>
                        </apex:panelGroup>
                        
                        <apex:outputText value="Adjustment % : " style="font-weight:bold"/>
                        <apex:inputField value="{!quote.Adjustment__c}" rendered="{!IsQuoteUnLocked}"/>
                        <apex:outputField value="{!quote.Adjustment__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                        <apex:panelGroup rendered="{!IsQuoteUnLocked}">
                            <apex:commandButton value="Apply Adjustment" action="{!applyAdjustmentBtnHandler}" status="status" reRender="bottomSection,QuoteProductsSection,msgs"/>&nbsp;
                            <apex:commandButton value="Adjustment Reset" action="{!adjustmentResetBtnHandler}" status="status" reRender="bottomSection,QuoteProductsSection,msgs"/>
                        </apex:panelGroup>   
                    </apex:panelGrid>
                </apex:outputPanel>
                </td>
                <td valign="top" width="50%">
                <!-- Totals Table -->
                <apex:pageBlock title="Totals" id="TotalsBlock">
                    <table class="list " border="0" cellpadding="0" cellspacing="0">
                        <tr class="headerRow">
                          <th class="headerRow"></th>
                          <th class="headerRow">Amount or %</th>
                        </tr>
                        <apex:outputPanel layout="none" rendered="{!quote.Total_Software__c != null && quote.Total_Software__c != 0}">
                            <tr class="dataRow">
                                <th class="dataCell">Software</th>
                                <td class="dataCell">
                                    <apex:outputField value="{!quote.Total_Software__c}"/>
                                </td>
                            </tr>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!quote.Total_Hardware__c != null && quote.Total_Hardware__c != 0}">
                            <tr class="dataRow">
                                <th class="dataCell">Hardware</th>
                                <td class="dataCell">
                                    <apex:outputField value="{!quote.Total_Hardware__c}"/>
                                </td>
                            </tr>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!quote.Total_Education__c != null && quote.Total_Education__c != 0}">
                            <tr class="dataRow">
                                <th class="dataCell">Education</th>
                                <td class="dataCell">
                                    <apex:outputField value="{!quote.Total_Education__c}"/>
                                </td>
                            </tr>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!quote.Total_Services__c != null && quote.Total_Services__c != 0}">
                            <tr class="dataRow">
                                <th class="dataCell">Professional Services</th>
                                <td class="dataCell">
                                    <apex:outputField value="{!quote.Total_Services__c}"/>
                                </td>
                            </tr>
                        </apex:outputPanel>
                        <tr class="dataRow">
                            <th class="dataCell">Total Discount (Genesys and Third-Party Products) %</th>
                            <td class="dataCell">
                                <apex:outputField value="{!quote.Total_Discount_Genesys_and_Third_Party__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <th class="dataCell">Total Discount (Genesys Products Only) %</th>
                            <td class="dataCell">
                                <apex:outputField value="{!quote.Total_Discount_Genesys_Products_Only__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <th class="dataCell">Total Discount (Genesys and Third-Party Products) Amount</th>
                            <td class="dataCell">
                                <apex:outputField value="{!quote.Total_Discount__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <th class="dataCell">Net Price (License/Software + Hardware + Services + Education - Discounts)</th>
                            <td class="dataCell">
                                <apex:outputField value="{!quote.Net_Price_Lic_Sw_Srvcs_Edu_Discounts__c}"/>
                            </td>
                        </tr>
                        <apex:outputPanel layout="none" rendered="{!quote.BEP_Third_Party_Genesys_Care__c != null && quote.BEP_Third_Party_Genesys_Care__c != 0}">
                            <tr class="dataRow">
                                <th class="dataCell">BEP Third Party Genesys Care</th>
                                <td class="dataCell">
                                    <apex:outputField value="{!quote.BEP_Third_Party_Genesys_Care__c}"/>
                                </td>
                            </tr>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!quote.Total_Genesys_Care__c != null && quote.Total_Genesys_Care__c != 0}">
                            <tr class="dataRow">
                                <th class="dataCell">Genesys Care</th>
                                <td class="dataCell">
                                    <apex:outputField value="{!quote.Total_Genesys_Care__c}"/>
                                </td>
                            </tr>
                        </apex:outputPanel>
                        <tr class="dataRow">
                            <th class="dataCell">Subtotal (Net Price + Genesys Care)</th>
                            <th class="dataCell" style="background-color: #FFFF66">
                                <apex:outputField value="{!quote.Total_Subtotal_1__c}"/>
                            </th>
                        </tr>
                        <apex:outputPanel layout="none" rendered="{!blnHasRDP}">
                            <tr class="dataRow">
                                <th class="dataCell">Time and Expense on PS RDP %</th>
                                <td class="dataCell">
                                    <apex:outputField value="{!quote.Time_Expense_PS_RDP__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                                    <apex:inputField value="{!quote.Time_Expense_PS_RDP__c}" style="width : 70px;" rendered="{!IsQuoteUnLocked}"/>
                                </td>
                            </tr>
                        </apex:outputPanel>
                        <tr class="dataRow">
                            <th class="dataCell">Prepaid Professional Services</th>
                            <td class="dataCell">
                                <apex:outputField value="{!quote.Total_Prepaid_Prof_Services__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                                <apex:inputField value="{!quote.Total_Prepaid_Prof_Services__c}" style="width : 70px;" rendered="{!IsQuoteUnLocked}"/>
                            </td>
                        </tr>
                        <apex:outputPanel layout="none" rendered="{!quote.End_User_ID__r.Country__r.Name = 'Japan'}">
                            <tr class="dataRow">
                                <th class="dataCell">Consumption Tax Rate</th>
                                <td class="dataCell">
                                    <apex:outputField value="{!quote.Tax_Rate__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                                    <apex:inputField value="{!quote.Tax_Rate__c}" style="width : 70px;" rendered="{!IsQuoteUnLocked}"/>
                                </td>
                            </tr>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!quote.Total_Taxes__c != null && quote.Total_Taxes__c != 0}">
                            <tr class="dataRow">
                                <th class="dataCell">Tax</th>
                                <td class="dataCell">
                                    <apex:outputField value="{!quote.Total_Taxes__c}"/>
                                </td>
                            </tr>
                        </apex:outputPanel>
                        <tr class="dataRow">
                            <th class="dataCell">Total</th>
                            <th class="dataCell" style="background-color: #FFA319">
                                <apex:outputField value="{!quote.BigMachines__Total__c}"/>
                            </th>
                        </tr>
                   </table>
                </apex:pageBlock>
                </td>
            </tr>
            </table>
            </apex:outputPanel>
            <!--</apex:pageBlockSection>-->
        </apex:pageBlock>
        <apex:outputPanel id="selectColumns">
            <apex:outputPanel styleClass="popupBackground" layout="block" rendered="{!blnShowSelectColumns}"/>
            <apex:outputPanel styleClass="custPopup" layout="block" rendered="{!blnShowSelectColumns}">
                <apex:pageBlock title="Select Columns">
                    <apex:pageBlockButtons location="both">
                        <apex:commandButton value="Save" action="{!saveColumnsHandler}" status="closingStatus" reRender="selectColumns,QuoteProductsSection"/>
                        <apex:commandButton value="Cancel" action="{!cancelColumnsHandler}" status="closingStatus" reRender="selectColumns"/>
                        <apex:actionStatus id="closingStatus">
                            <apex:facet name="start">
                                <apex:image value="/img/loading.gif"/>
                            </apex:facet> 
                        </apex:actionStatus>
                    </apex:pageBlockButtons>
                    <table class="list " border="0" cellpadding="0" cellspacing="0">
                        <tr class="headerRow">
                          <th class="headerRow">Column</th>
                          <th class="headerRow">Show</th>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">Building Block</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Building_Block__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">Unit of measure</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Unit_of_measure__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">List Price</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.List_Price__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">Ext List Price</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Ext_List_Price__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">Product Specific Discount</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Product_Specific_Discount__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">Net Unit Price</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Net_Unit_Price__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">3rd Party</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.Third_Party__c}"/>
                            </td>
                        </tr>
                        <tr class="dataRow">
                            <td class="dataCell">PM Approver</td>
                            <td class="dataCell">
                                <apex:inputCheckbox value="{!objColumnPreference.PM_Approver__c}"/>
                            </td>
                        </tr>
                    </table>
                </apex:pageBlock>
            </apex:outputPanel>
        </apex:outputPanel>
        
        <apex:pageBlock title="Genesys Care" rendered="{!strSelectedTab=='Genesys Care'}">
            <apex:pageBlockSection title="Information" columns="2" id="GCSection" collapsible="false">
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="Default Genesys Care Rate"/>
                    <apex:outputField value="{!quote.Genesys_Care_Default_Pricing_Percentage__c}"/>
                </apex:pageBlockSectionItem>
                
                <apex:inputField value="{!quote.Override_Genesys_Care_Rate__c}" rendered="{!IsQuoteUnLocked}">
                    <apex:actionSupport event="onchange" action="{!assignDefaultGCRate}" rerender="GCSection" status="status"/>
                </apex:inputField>
                <apex:outputField value="{!quote.Override_Genesys_Care_Rate__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                
                <apex:inputField value="{!quote.Genesys_Care_Rate__c}" rendered="{!(quote.Override_Genesys_Care_Rate__c || 
                                    ISBLANK(quote.Genesys_Care_Default_Pricing_Percentage__c)) && quote.Service_Level__c != 'Decline' && IsQuoteUnLocked}"/>
                <apex:outputField value="{!quote.Genesys_Care_Rate__c}" rendered="{!NOT((quote.Override_Genesys_Care_Rate__c ||
                                            ISBLANK(quote.Genesys_Care_Default_Pricing_Percentage__c)) && quote.Service_Level__c != 'Decline' && IsQuoteUnLocked)}"/>
                
                <apex:inputField value="{!quote.Genesys_Care_Contractual_Rate__c}" rendered="{!IsQuoteUnLocked}">
                    <apex:actionSupport event="onchange" action="{!initializeCareRate}" rerender="GCSection" status="status"/>
                </apex:inputField>
                <apex:outputField value="{!quote.Genesys_Care_Contractual_Rate__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                
                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked}">
                    <apex:outputLabel value="Unit"/>
                    <apex:selectList value="{!quote.Duration_Unit__c}" size="1">
                        <apex:selectOption itemValue="Months" itemLabel="Months"/>
                        <apex:selectOption itemValue="Days" itemLabel="Days"/>
                        <apex:actionSupport event="onchange" rerender="GCSection" status="status"/>
                    </apex:selectList>
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!quote.Duration_Unit__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                
                <apex:inputField value="{!quote.Order_Numb_of_Maint_Days__c}" rendered="{!quote.Duration_Unit__c == 'Days' && IsQuoteUnLocked}"/>
                <apex:inputField value="{!quote.Order_Numb_of_Maint_Months__c}" rendered="{!quote.Duration_Unit__c != 'Days' && IsQuoteUnLocked}"/>
                <apex:outputField value="{!quote.Order_Numb_of_Maint_Days__c}" rendered="{!quote.Duration_Unit__c == 'Days' && NOT(IsQuoteUnLocked)}"/>
                <apex:outputField value="{!quote.Order_Numb_of_Maint_Months__c}" rendered="{!quote.Duration_Unit__c != 'Days' && NOT(IsQuoteUnLocked)}"/>
                
                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked}">
                    <apex:outputLabel value="Service Level"/>
                    <apex:selectList value="{!quote.Service_Level__c}" size="1">
                        <apex:selectOption itemValue="Business" itemLabel="Business"/>
                        <apex:selectOption itemValue="Premium" itemLabel="Premium"/>
                        <apex:selectOption itemValue="Decline" itemLabel="Decline"/>
                        <apex:actionSupport event="onchange" action="{!initializeCareRate}" rerender="GCSection" status="status"/>
                    </apex:selectList>
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!quote.Service_Level__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
            </apex:pageBlockSection>
        </apex:pageBlock>
        
        <apex:pageBlock title="DAP Details" rendered="{!strSelectedTab=='DAP Details'}">
            <apex:pageBlockSection columns="2">
                <apex:inputField value="{!quote.Customer_Info__c}" style="width:425px;"/>
                <apex:inputField value="{!quote.Bid_Summary__c}" style="width:425px;"/>
                <apex:inputField value="{!quote.Competitive_Info__c}" style="width:425px;"/>
                <apex:inputField value="{!quote.Explanation_of_price_Discount_request__c}" style="width:425px;"/>
                <apex:inputField value="{!quote.Partner_info__c}" style="width:425px;"/>
                <apex:inputField value="{!quote.Future_Benefits__c}" style="width:425px;"/>
                <apex:inputField value="{!quote.Internal_Notes__c}" style="width:425px;"/>
            </apex:pageBlockSection>
        </apex:pageBlock>
        
        <apex:pageBlock title="Special Offers" rendered="{!strSelectedTab=='Special Offers'}">
            <apex:pageBlockSection columns="1">
                <apex:inputField value="{!quote.Include_Special_Offer_in_Output__c}" rendered="{!IsQuoteUnLocked}" id="includeSpecialOffer"/>
                <apex:outputField value="{!quote.Include_Special_Offer_in_Output__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
                <apex:pageBlockSectionItem rendered="{!IsQuoteUnLocked}">
                    <apex:outputLabel value="Special Offers/Business Exceptions"/>
                    <apex:inputField value="{!quote.Special_Offer_Terms__c}"/>
                </apex:pageBlockSectionItem>
                <apex:outputField value="{!quote.Special_Offer_Terms__c}" rendered="{!NOT(IsQuoteUnLocked)}"/>
            </apex:pageBlockSection>
        </apex:pageBlock>
        
        <apex:outputPanel layout="none" rendered="{!strSelectedTab=='Order Submission'}">
            <apex:pageMessage severity="info" strength="2" rendered="{!NOT(IsOrderInfoAvailable)}">
                Order Submission becomes available once the quote is approved.
            </apex:pageMessage>
            <apex:pageBlock rendered="{!IsOrderInfoAvailable}">
                <apex:pageBlockButtons >                        
                    <apex:commandButton value="Cancel" action="{!cancelBtnHandler}" rendered="{!blnIsReviseOrder}"/>
                </apex:pageBlockButtons>
                <!-- Edit Mode -->
                <apex:outputPanel layout="none" rendered="{!quote.BigMachines__Status__c = 'Quote Approved' || 
                            quote.Revise_Minor__c || blnIsReviseOrder}">
                    <apex:pageBlockSection title="PO details" collapsible="false" columns="2">
                        <apex:pageBlockSectionItem > 
                            <apex:outputLabel value="PO#"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput" >
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.Order_PO_Number__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Attach PO (if not already attached)"/>
                            <apex:inputFile value="{!objAttachment.body}" filename="{!objAttachment.name}"/>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="PO Date"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput" >
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.Order_PO_Date__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="PO for FYM"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput" >
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.PO_for_FYM__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:inputField value="{!quote.Order_Special_Instructions__c}"/>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Payment Terms"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput" >
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.Order_Payment_Terms__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Ship Software Via"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput" >
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.Order_Ship_Software_Via__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                    </apex:pageBlockSection>
                    
                    <apex:pageBlockSection title="Technical Information" collapsible="false" columns="2">
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Server OS"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput">
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.Server_OS__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="PBX"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput">
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.PBX__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Database"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput">
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.Database__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="IVR"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput">
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.IVR__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Add Language"/>
                            <apex:outputPanel layout="block" styleClass="requiredInput">
                                <apex:outputPanel styleClass="requiredBlock"/>
                                <apex:inputField value="{!quote.Add_Language__c}"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                    </apex:pageBlockSection>
                </apex:outputPanel>
                
                <!-- Read Mode -->
                <apex:outputPanel layout="none" rendered="{!NOT(quote.BigMachines__Status__c = 'Quote Approved' || 
                            quote.Revise_Minor__c || blnIsReviseOrder)}">
                    <apex:pageBlockSection title="PO details" collapsible="false" columns="2">
                        <apex:outputField value="{!quote.Order_PO_Number__c}"/>
                        <apex:outputField value="{!quote.Order_PO_Date__c}"/>
                        <apex:outputField value="{!quote.PO_for_FYM__c}"/>
                        <apex:outputField value="{!quote.Order_Special_Instructions__c}"/>
                        <apex:outputField value="{!quote.Order_Payment_Terms__c}"/>
                        <apex:outputField value="{!quote.Order_Ship_Software_Via__c}"/>
                    </apex:pageBlockSection>
                    <apex:pageBlockSection title="Technical Information" collapsible="false" columns="2">
                        <apex:outputField value="{!quote.Server_OS__c}"/>
                        <apex:outputField value="{!quote.PBX__c}"/>
                        <apex:outputField value="{!quote.Database__c}"/>
                        <apex:outputField value="{!quote.IVR__c}"/>
                        <apex:outputField value="{!quote.Add_Language__c}"/>
                    </apex:pageBlockSection>
                </apex:outputPanel>
            </apex:pageBlock>
        </apex:outputPanel>
        
    </apex:form>
    
    <apex:include pageName="OrderAddressOnPremise" rendered="{!strSelectedTab=='Order Submission'}"/>
    <apex:outputPanel id="pnlQuoteApprovals">
        <apex:outputPanel layout="none" rendered="{!strSelectedTab=='Quote Approvals'}">
            <apex:pageBlock title="Upfront Approvals">
                <apex:outputLabel value="No record(s) found." rendered="{!upfrontApprovals.size == 0}"/>
                <apex:pageBlockSection columns="1" rendered="{!upfrontApprovals.size > 0}"> 
                    <apex:pageBlockTable value="{!upfrontApprovals}" var="eachRecord" cellpadding="5">
                        <apex:column headerValue="Step/Level" width="5%">
                            <b>{!eachRecord.stepName}</b>       
                        </apex:column>
                        <apex:column headerValue="Approval Reason" width="65%">
                            <apex:outputText escape="false" value="{!eachRecord.approvalReason}" />        
                        </apex:column>
                        <apex:column headerValue="Function Name" width="10%">
                            {!eachRecord.functionName}                    
                        </apex:column>
                        <apex:column headerValue="Actual Approver" width="10%">
                            <a href="mailto:{!eachRecord.actualApproverEmailId}?Subject=Quote : {!quote.Name}">
                                {!eachRecord.actualApprover}
                            </a>
                        </apex:column>
                        <apex:column headerValue="Approver" width="10%">
                            {!eachRecord.approverName}
                        </apex:column>                
                    </apex:pageBlockTable>
                </apex:pageBlockSection>
            </apex:pageBlock>
            <!--<c:QuoteApprovalHistory idQuote="{!quote.Id}" retURL="/apex/CreateQuoteOnPremise?id={!quote.Id}&tab=QuoteApprovals"/>-->
            <apex:pageBlock title="Approval History">
                <apex:outputLabel value="No records to display" rendered="{!NOT(showApprovalHistory)}"/>
                <apex:outputPanel layout="none" rendered="{!showApprovalHistory}">
                    <apex:outputPanel >
                    <apex:pageBlockTable value="{!approvals}" var="eachRecord">
                        <apex:column headerValue="Action" styleClass="{!eachRecord.styleClass}" style="{!eachRecord.style}">
                            <apex:outputLabel value="{!eachRecord.actionTitle}" rendered="{!NOT(eachRecord.actionTitle == '')}" />
                            <apex:outputLink value="/apex/ApproveRejectQuote?id={!quote.Id}&approvalRecord={!eachRecord.approvalRecord.id}&mode=noAction&retURL=/apex/CreateQuoteOnPremise?id={!quote.Id}&tab=QuoteApprovals" rendered="{!AND(eachRecord.actionTitle == '', eachRecord.approvalRecord.Status__c == 'Pending',NOT(mode == 'noAction'))}" target="_parent">
                                Approve / Reject
                            </apex:outputLink>
                        </apex:column>
                        <apex:column headerValue="Submitted Date" styleClass="{!eachRecord.styleClass}" style="{!eachRecord.style}">
                            <apex:outputText value="{!eachRecord.submittedDate}" />                     
                        </apex:column>
                        <apex:column headerValue="Status" styleClass="{!eachRecord.styleClass}" style="{!eachRecord.style}">
                            <span class="{!eachRecord.statusClass}">
                                {!eachRecord.approvalRecord.Status__c}
                            </span>
                        </apex:column>
                        <apex:column headerValue="Approved/Reject Date" styleClass="{!eachRecord.styleClass}" style="{!eachRecord.style}">
                            <apex:outputText value="{!eachRecord.approvalRejectDate}" />
                        </apex:column>
                        <apex:column headerValue="Function Name" styleClass="{!eachRecord.styleClass}" style="{!eachRecord.style}">
                            <apex:outputPanel rendered="{!NOT(eachRecord.rowType == 'submissionDetail')}">
                                {!eachRecord.approvalRecord.Quote_Approval_Step_Details__r.Quote_Approver_Step_Approver_Detail__r.Name}
                            </apex:outputPanel>
                        </apex:column>
                        <apex:column headerValue="Assigned To" styleClass="{!eachRecord.styleClass}"  style="{!eachRecord.style}">
                            <apex:outputLink value="/{!eachRecord.approvalRecord.OwnerId}" target="_blank" rendered="{!NOT(eachRecord.rowType == 'submissionDetail')}">
                                {!eachRecord.approvalRecord.Owner.Name}
                            </apex:outputLink>
                        </apex:column>
                        <apex:column headerValue="Actual Approver" styleClass="{!eachRecord.styleClass}"  style="{!eachRecord.style}">
                            <apex:outputLink value="/{!eachRecord.approvalRecord.Actual_Approver__c}" target="_blank" rendered="{!NOT(eachRecord.rowType == 'submissionDetail')}">
                                {!eachRecord.approvalRecord.Actual_Approver__r.Name}
                            </apex:outputLink>
                        </apex:column>
                        <apex:column headerValue="Comments" styleClass="{!eachRecord.styleClass}" rendered="{!NOT(eachRecord.rowType == 'submissionDetail')}"  style="{!eachRecord.style}">
                            {!eachRecord.approvalRecord.Comments__c}
                        </apex:column>
                        <apex:column headerValue="Approval Method" styleClass="{!eachRecord.styleClass}" rendered="{!NOT(eachRecord.rowType == 'submissionDetail')}"  style="{!eachRecord.style}">
                            {!eachRecord.approvalRecord.Approval_Method__c}
                        </apex:column>
                        
                        <apex:column headerValue="Overall Status" styleClass="{!eachRecord.styleClass}"  style="{!eachRecord.style}">
                            <apex:outputPanel rendered="{!AND(eachRecord.showOverallStatus, overAllStatus == 'Pending')}" >
                                <span class="pendingStatus">
                                    <img src="/img/icon/pending12.gif" alt="" class="extraStatus" title=""/>
                                    Pending &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                </span>                     
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!AND(eachRecord.showOverallStatus, overAllStatus == 'Approved')}" >
                                <span class="approvedStatus">
                                    <img src="/img/icon/approve12.gif" alt="" class="extraStatus" title=""/>
                                    Approved &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>                      
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!AND(eachRecord.showOverallStatus, overAllStatus == 'Rejected')}" >
                                <span class="rejectedStatus">
                                    <img src="/img/icon/reject12.gif" alt="" class="extraStatus" title="" />
                                    Rejected &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>                      
                            </apex:outputPanel>                 
                            <apex:outputPanel rendered="{!AND(eachRecord.showOverallStatus, overAllStatus == 'Cancelled')}" >
                                <span class="rejectedStatus">
                                    <img src="/img/icon/reject12.gif" alt="" class="extraStatus" title="" />
                                    Cancelled &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>                     
                            </apex:outputPanel>                 
                        </apex:column>                          
                    </apex:pageBlockTable>
                    </apex:outputPanel>
                </apex:outputPanel>
            </apex:pageBlock>
        </apex:outputPanel>
    </apex:outputPanel>
    <div style="height:15px;">
        <apex:actionStatus id="status">
            <apex:facet name="start">    
            <apex:outputPanel id="popPanel">
                <apex:outputPanel styleClass="popupBackground" layout="block"/>
                <apex:outputPanel styleClass="custPopup" layout="block">
                    <apex:outputPanel layout="block" style="text-align:center;">
                        Please wait ... &nbsp; <apex:image value="/img/loading.gif"/>
                    </apex:outputPanel>
                </apex:outputPanel>
            </apex:outputPanel>
            </apex:facet>                           
        </apex:actionStatus>
    </div>
    <script>
        function saveAndReload()
        {
            saveBeforeReload();
            return false;
        }
        function deleteQP(decisionInputId)
        {
            var r = confirm("Are you sure you want to delete this record ?");
            if(r == true)
            {
                document.getElementById(decisionInputId).value = 'yes';
            }
            else
            {
                document.getElementById(decisionInputId).value = 'no';
            }
        }
    </script>
</apex:page>